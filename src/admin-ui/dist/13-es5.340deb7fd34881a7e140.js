!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,c){if(!t)return;if("string"==typeof t)return e(t,c);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,c)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var c=0,n=new Array(e);c<e;c++)n[c]=t[c];return n}function c(t,e){for(var c=0;c<e.length;c++){var n=e[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var c,n=u(t);if(e){var r=u(this).constructor;c=Reflect.construct(n,arguments,r)}else c=n.apply(this,arguments);return i(this,c)}}function i(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return a(t)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e,c){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,c){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=u(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(c):r.value}})(t,e,c||t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{tB2i:function(e,c,i){"use strict";i.r(c),i.d(c,"HealthCheckComponent",function(){return _}),i.d(c,"JobListComponent",function(){return W}),i.d(c,"JobStateLabelComponent",function(){return L}),i.d(c,"SystemModule",function(){return G}),i.d(c,"systemRoutes",function(){return $}),i.d(c,"\u02750",function(){return J}),i.d(c,"\u02751",function(){return U});var d=i("EM62"),b=i("ixhn"),f=i("nIj0"),p=i("sEIs"),m=i("8lHc"),h=i("kuMc"),g=i("xVbo"),v=i("YtkY"),y=i("OxKu"),j=i("2kYt"),S=i("Kej3"),w=i("s2Ay"),k=i("jY47");function I(t,e){1&t&&(d.hc(0),d.Vc(1),d.tc(2,"translate"),d.gc()),2&t&&(d.Sb(1),d.Xc(" ",d.uc(2,1,"system.health-all-systems-up")," "))}function C(t,e){1&t&&(d.Vc(0),d.tc(1,"translate")),2&t&&d.Xc(" ",d.uc(1,1,"system.health-error")," ")}var P=function(t,e){return{"is-success":t,"is-danger":e}};function O(t,e){if(1&t&&(d.jc(0,"div",7),d.jc(1,"div",8),d.ec(2,"clr-icon",9),d.ic(),d.jc(3,"div",10),d.Tc(4,I,3,3,"ng-container",11),d.Tc(5,C,2,3,"ng-template",null,12,d.Uc),d.jc(7,"div",13),d.Vc(8),d.tc(9,"translate"),d.tc(10,"localeDate"),d.tc(11,"async"),d.ic(),d.ic(),d.ic()),2&t){var c=e.ngIf,n=d.Jc(6),r=d.sc();d.Sb(2),d.zc("ngClass",d.Ec(13,P,"ok"===c,"ok"!==c)),d.Tb("shape","ok"===c?"check-circle":"exclamation-circle"),d.Sb(2),d.zc("ngIf","ok"===c)("ngIfElse",n),d.Sb(4),d.Yc(" ",d.uc(9,6,"system.health-last-checked"),": ",d.vc(10,8,d.uc(11,11,r.healthCheckService.lastCheck$),"mediumTime")," ")}}function T(t,e){1&t&&(d.hc(0),d.ec(1,"clr-icon",17),d.Vc(2),d.tc(3,"translate"),d.gc()),2&t&&(d.Sb(2),d.Xc(" ",d.uc(3,1,"system.health-status-up")," "))}function E(t,e){1&t&&(d.ec(0,"clr-icon",18),d.Vc(1),d.tc(2,"translate")),2&t&&(d.Sb(1),d.Xc(" ",d.uc(2,1,"system.health-status-down")," "))}function V(t,e){if(1&t&&(d.jc(0,"tr"),d.jc(1,"td",14),d.Vc(2),d.ic(),d.jc(3,"td",14),d.jc(4,"vdr-chip",15),d.Tc(5,T,4,3,"ng-container",11),d.Tc(6,E,3,3,"ng-template",null,16,d.Uc),d.ic(),d.ic(),d.jc(8,"td",14),d.Vc(9),d.ic(),d.ic()),2&t){var c=e.$implicit,n=d.Jc(7);d.Sb(2),d.Wc(c.key),d.Sb(2),d.zc("colorType","up"===c.result.status?"success":"error"),d.Sb(1),d.zc("ngIf","up"===c.result.status)("ngIfElse",n),d.Sb(4),d.Wc(c.result.message)}}function D(t,e){1&t&&(d.hc(0),d.Vc(1),d.tc(2,"translate"),d.gc()),2&t&&(d.Sb(1),d.Xc(" ",d.uc(2,1,"system.all-job-queues")," "))}function z(t,e){if(1&t&&(d.jc(0,"vdr-chip",8),d.Vc(1),d.ic()),2&t){var c=d.sc().item;d.zc("colorFrom",c.name),d.Sb(1),d.Wc(c.name)}}function N(t,e){if(1&t&&(d.Tc(0,D,3,3,"ng-container",6),d.Tc(1,z,2,2,"ng-template",null,7,d.Uc)),2&t){var c=e.item,n=d.Jc(2);d.zc("ngIf","all"===c.name)("ngIfElse",n)}}function x(t,e){if(1&t&&(d.jc(0,"vdr-dropdown"),d.jc(1,"button",14),d.tc(2,"translate"),d.ec(3,"clr-icon",15),d.ic(),d.jc(4,"vdr-dropdown-menu"),d.jc(5,"div",16),d.ec(6,"vdr-object-tree",17),d.ic(),d.ic(),d.ic()),2&t){var c=d.sc().item;d.Sb(1),d.zc("title",d.uc(2,2,"system.job-data")),d.Sb(5),d.zc("value",c.data)}}function q(t,e){if(1&t&&(d.jc(0,"vdr-dropdown"),d.jc(1,"button",18),d.ec(2,"clr-icon",15),d.Vc(3),d.tc(4,"translate"),d.ic(),d.jc(5,"vdr-dropdown-menu"),d.jc(6,"div",16),d.ec(7,"vdr-object-tree",17),d.ic(),d.ic(),d.ic()),2&t){var c=d.sc().item;d.Sb(3),d.Xc(" ",d.uc(4,2,"system.job-result")," "),d.Sb(4),d.zc("value",c.result)}}function R(t,e){if(1&t&&(d.jc(0,"vdr-dropdown"),d.jc(1,"button",18),d.ec(2,"clr-icon",19),d.Vc(3),d.tc(4,"translate"),d.ic(),d.jc(5,"vdr-dropdown-menu"),d.jc(6,"div",16),d.Vc(7),d.ic(),d.ic(),d.ic()),2&t){var c=d.sc().item;d.Sb(3),d.Xc(" ",d.uc(4,2,"system.job-error")," "),d.Sb(4),d.Xc(" ",c.error," ")}}var X=function(){return["DeleteSettings","DeleteSystem"]};function A(t,e){if(1&t){var c=d.kc();d.jc(0,"vdr-dropdown"),d.jc(1,"button",20),d.ec(2,"clr-icon",21),d.ic(),d.jc(3,"vdr-dropdown-menu",22),d.jc(4,"button",23),d.qc("click",function(){d.Mc(c);var t=d.sc().item;return d.sc().cancelJob(t.id)}),d.tc(5,"hasPermission"),d.ec(6,"clr-icon",24),d.Vc(7),d.tc(8,"translate"),d.ic(),d.ic(),d.ic()}2&t&&(d.Sb(4),d.zc("disabled",!d.uc(5,2,d.Cc(6,X))),d.Sb(3),d.Xc(" ",d.uc(8,4,"common.cancel")," "))}function F(t,e){if(1&t&&(d.jc(0,"td",9),d.ec(1,"vdr-entity-info",10),d.ic(),d.jc(2,"td",9),d.Tc(3,x,7,4,"vdr-dropdown",11),d.jc(4,"vdr-chip",8),d.Vc(5),d.ic(),d.ic(),d.jc(6,"td",9),d.Vc(7),d.tc(8,"timeAgo"),d.ic(),d.jc(9,"td",9),d.ec(10,"vdr-job-state-label",12),d.ic(),d.jc(11,"td",9),d.Vc(12),d.tc(13,"duration"),d.ic(),d.jc(14,"td",9),d.Tc(15,q,8,4,"vdr-dropdown",11),d.Tc(16,R,8,4,"vdr-dropdown",11),d.ic(),d.jc(17,"td",13),d.Tc(18,A,9,7,"vdr-dropdown",11),d.ic()),2&t){var c=e.item,n=d.sc();d.Sb(1),d.zc("entity",c),d.Sb(2),d.zc("ngIf",c.data),d.Sb(1),d.zc("colorFrom",c.queueName),d.Sb(1),d.Wc(c.queueName),d.Sb(2),d.Wc(d.uc(8,10,c.createdAt)),d.Sb(3),d.zc("job",c),d.Sb(2),d.Wc(d.uc(13,12,c.duration)),d.Sb(3),d.zc("ngIf",n.hasResult(c)),d.Sb(1),d.zc("ngIf",c.error),d.Sb(2),d.zc("ngIf",!c.isSettled&&"FAILED"!==c.state)}}function M(t,e){if(1&t&&(d.jc(0,"span",2),d.Vc(1),d.tc(2,"percent"),d.ic()),2&t){var c=d.sc();d.Sb(1),d.Xc(" ",d.uc(2,1,c.job.progress/100)," ")}}var _=function t(e){l(this,t),this.healthCheckService=e};_.\u0275fac=function(t){return new(t||_)(d.dc(b.jb))},_.\u0275cmp=d.Xb({type:_,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(t,e){1&t&&(d.jc(0,"vdr-action-bar"),d.jc(1,"vdr-ab-left"),d.Tc(2,O,12,16,"div",0),d.tc(3,"async"),d.ic(),d.jc(4,"vdr-ab-right"),d.ec(5,"vdr-action-bar-items",1),d.jc(6,"button",2),d.qc("click",function(){return e.healthCheckService.refresh()}),d.ec(7,"clr-icon",3),d.Vc(8),d.tc(9,"translate"),d.ic(),d.ic(),d.ic(),d.jc(10,"table",4),d.jc(11,"thead"),d.jc(12,"tr"),d.jc(13,"th",5),d.Vc(14),d.tc(15,"translate"),d.ic(),d.jc(16,"th",5),d.Vc(17),d.tc(18,"translate"),d.ic(),d.jc(19,"th",5),d.Vc(20),d.tc(21,"translate"),d.ic(),d.ic(),d.ic(),d.jc(22,"tbody"),d.Tc(23,V,10,5,"tr",6),d.tc(24,"async"),d.ic(),d.ic()),2&t&&(d.Sb(2),d.zc("ngIf",d.uc(3,6,e.healthCheckService.status$)),d.Sb(6),d.Xc(" ",d.uc(9,8,"system.health-refresh")," "),d.Sb(6),d.Xc(" ",d.uc(15,10,"common.name")," "),d.Sb(3),d.Xc(" ",d.uc(18,12,"system.health-status")," "),d.Sb(3),d.Xc(" ",d.uc(21,14,"system.health-message")," "),d.Sb(3),d.zc("ngForOf",d.uc(24,16,e.healthCheckService.details$)))},directives:[b.c,b.e,j.o,b.f,b.d,S.o,j.n,j.m,b.D],pipes:[j.b,w.d,b.Ab],styles:[".system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:var(--color-grey-500)}"],changeDetection:0}),_.ctorParameters=function(){return[{type:b.jb}]};var W=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(i,e);var c=o(i);function i(t,e,n,r,o){var d,p;return l(this,i),(p=c.call(this,r,o)).dataService=t,p.modalService=e,p.notificationService=n,p.liveUpdate=new f.f(!0),p.hideSettled=new f.f(!0),p.queueFilter=new f.f("all"),s((d=a(p),u(i.prototype)),"setQueryFn",d).call(d,function(){var t;return(t=p.dataService.settings).getAllJobs.apply(t,arguments)},function(t){return t.jobs},function(t,e){var c="all"===p.queueFilter.value?null:{queueName:{eq:p.queueFilter.value}},n=p.hideSettled.value;return{options:{skip:t,take:e,filter:Object.assign(Object.assign({},c),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:b.Pb.DESC}}}}),p}return n(i,[{key:"ngOnInit",value:function(){var e=this;s(u(i.prototype),"ngOnInit",this).call(this),Object(m.a)(5e3,2e3).pipe(Object(h.a)(this.destroy$),Object(g.a)(function(){return e.liveUpdate.value})).subscribe(function(){e.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(function(t){return t.jobQueues}).pipe(Object(v.a)(function(e){return[{name:"all",running:!0}].concat(t(e))}))}},{key:"hasResult",value:function(t){var e=t.result;return null!=e&&("object"!=typeof e||Object.keys(e).length>0)}},{key:"cancelJob",value:function(t){var e=this;this.dataService.settings.cancelJob(t).subscribe(function(){return e.refresh()})}}]),i}(b.y);W.\u0275fac=function(t){return new(t||W)(d.dc(b.L),d.dc(b.Db),d.dc(b.Eb),d.dc(p.e),d.dc(p.a))},W.\u0275cmp=d.Xb({type:W,selectors:[["vdr-job-list"]],features:[d.Pb],decls:41,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],[1,"right","align-middle"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","ban",1,"is-danger"]],template:function(t,e){1&t&&(d.jc(0,"vdr-action-bar"),d.jc(1,"vdr-ab-left"),d.jc(2,"clr-checkbox-container"),d.jc(3,"clr-checkbox-wrapper"),d.ec(4,"input",0),d.jc(5,"label"),d.Vc(6),d.tc(7,"translate"),d.ic(),d.ic(),d.jc(8,"clr-checkbox-wrapper"),d.jc(9,"input",1),d.qc("change",function(){return e.refresh()}),d.ic(),d.jc(10,"label"),d.Vc(11),d.tc(12,"translate"),d.ic(),d.ic(),d.ic(),d.ic(),d.jc(13,"vdr-ab-right"),d.jc(14,"ng-select",2),d.qc("change",function(){return e.refresh()}),d.tc(15,"async"),d.Tc(16,N,3,2,"ng-template",3),d.ic(),d.ec(17,"vdr-action-bar-items",4),d.ic(),d.ic(),d.jc(18,"vdr-data-table",5),d.qc("pageChange",function(t){return e.setPageNumber(t)})("itemsPerPageChange",function(t){return e.setItemsPerPage(t)}),d.tc(19,"async"),d.tc(20,"async"),d.tc(21,"async"),d.tc(22,"async"),d.ec(23,"vdr-dt-column"),d.jc(24,"vdr-dt-column"),d.Vc(25),d.tc(26,"translate"),d.ic(),d.jc(27,"vdr-dt-column"),d.Vc(28),d.tc(29,"translate"),d.ic(),d.jc(30,"vdr-dt-column"),d.Vc(31),d.tc(32,"translate"),d.ic(),d.jc(33,"vdr-dt-column"),d.Vc(34),d.tc(35,"translate"),d.ic(),d.jc(36,"vdr-dt-column"),d.Vc(37),d.tc(38,"translate"),d.ic(),d.ec(39,"vdr-dt-column"),d.Tc(40,F,19,14,"ng-template"),d.ic()),2&t&&(d.Sb(4),d.zc("formControl",e.liveUpdate),d.Sb(2),d.Wc(d.uc(7,21,"common.live-update")),d.Sb(3),d.zc("formControl",e.hideSettled),d.Sb(2),d.Wc(d.uc(12,23,"system.hide-settled-jobs")),d.Sb(3),d.zc("addTag",!1)("items",d.uc(15,25,e.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",e.queueFilter),d.Sb(4),d.zc("items",d.uc(19,27,e.items$))("itemsPerPage",d.uc(20,29,e.itemsPerPage$))("totalItems",d.uc(21,31,e.totalItems$))("currentPage",d.uc(22,33,e.currentPage$)),d.Sb(7),d.Wc(d.uc(26,35,"system.job-queue-name")),d.Sb(3),d.Wc(d.uc(29,37,"common.created-at")),d.Sb(3),d.Wc(d.uc(32,39,"system.job-state")),d.Sb(3),d.Wc(d.uc(35,41,"system.job-duration")),d.Sb(3),d.Wc(d.uc(38,43,"system.job-result")))},directives:function(){return[b.c,b.e,S.j,S.k,b.eb,f.a,S.i,f.p,f.g,S.u,b.f,k.a,k.e,k.d,b.d,b.N,b.M,j.o,b.D,b.ab,L,b.T,b.W,S.o,b.V,b.Fb,b.U]},pipes:function(){return[w.d,j.b,b.Ub,b.X,b.ib]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),W.ctorParameters=function(){return[{type:b.L},{type:b.Db},{type:b.Eb},{type:p.e},{type:p.a}]};var L=function(){function t(){l(this,t)}return n(t,[{key:"iconShape",get:function(){switch(this.job.state){case b.tb.COMPLETED:return"check-circle";case b.tb.FAILED:return"exclamation-circle";case b.tb.CANCELLED:return"ban";case b.tb.PENDING:case b.tb.RETRYING:return"hourglass";case b.tb.RUNNING:return"sync"}}},{key:"colorType",get:function(){switch(this.job.state){case b.tb.COMPLETED:return"success";case b.tb.FAILED:case b.tb.CANCELLED:return"error";case b.tb.PENDING:case b.tb.RETRYING:return"";case b.tb.RUNNING:return"warning"}}}]),t}();L.\u0275fac=function(t){return new(t||L)},L.\u0275cmp=d.Xb({type:L,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(t,e){1&t&&(d.jc(0,"vdr-chip",0),d.ec(1,"clr-icon"),d.Vc(2),d.tc(3,"titlecase"),d.Tc(4,M,3,3,"span",1),d.ic()),2&t&&(d.zc("colorType",e.colorType),d.Sb(1),d.Tb("shape",e.iconShape),d.Sb(1),d.Xc(" ",d.uc(3,4,e.job.state)," "),d.Sb(2),d.zc("ngIf","RUNNING"===e.job.state))},directives:[b.D,S.o,j.o],pipes:[j.y,j.v],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),L.propDecorators={job:[{type:d.E}]};var J={breadcrumb:Object(y.a)("breadcrumb.job-queue")},U={breadcrumb:Object(y.a)("breadcrumb.system-status")},$=[{path:"jobs",component:W,data:J},{path:"system-status",component:_,data:U}],G=function t(){l(this,t)};G.\u0275fac=function(t){return new(t||G)},G.\u0275mod=d.bc({type:G}),G.\u0275inj=d.ac({imports:[[b.Nb,p.i.forChild($)]]})}}])}();
//# sourceMappingURL=13-es5.340deb7fd34881a7e140.js.map