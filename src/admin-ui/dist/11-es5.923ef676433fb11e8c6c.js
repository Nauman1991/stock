!function(){function e(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var c,r,i=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(c=n.next()).done)&&(i.push(c.value),!t||i.length!==t);o=!0);}catch(l){a=!0,r=l}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return i}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,c=new Array(t);n<t;n++)c[n]=e[n];return c}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var c=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(c){var r=Object.getOwnPropertyDescriptor(c,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,c=f(e);if(t){var r=f(this).constructor;n=Reflect.construct(c,arguments,r)}else n=c.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function p(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"2VDt":function(c,r,l){"use strict";l.r(r),l.d(r,"AddManualPaymentDialogComponent",function(){return Tc}),l.d(r,"CancelOrderDialogComponent",function(){return Cc}),l.d(r,"FulfillOrderDialogComponent",function(){return Oc}),l.d(r,"FulfillmentCardComponent",function(){return xc}),l.d(r,"FulfillmentDetailComponent",function(){return Ic}),l.d(r,"FulfillmentStateLabelComponent",function(){return Sc}),l.d(r,"LineFulfillmentComponent",function(){return Ec}),l.d(r,"LineRefundsComponent",function(){return Pc}),l.d(r,"ModificationDetailComponent",function(){return Mc}),l.d(r,"NODE_HEIGHT",function(){return Vc}),l.d(r,"OrderCustomFieldsCardComponent",function(){return Fc}),l.d(r,"OrderDetailComponent",function(){return Dc}),l.d(r,"OrderEditResultType",function(){return Zc}),l.d(r,"OrderEditorComponent",function(){return Rc}),l.d(r,"OrderEditsPreviewDialogComponent",function(){return Lc}),l.d(r,"OrderHistoryComponent",function(){return Nc}),l.d(r,"OrderListComponent",function(){return $c}),l.d(r,"OrderModule",function(){return ir}),l.d(r,"OrderPaymentCardComponent",function(){return qc}),l.d(r,"OrderProcessEdgeComponent",function(){return Qc}),l.d(r,"OrderProcessGraphComponent",function(){return Hc}),l.d(r,"OrderProcessGraphDialogComponent",function(){return _c}),l.d(r,"OrderProcessNodeComponent",function(){return Wc}),l.d(r,"OrderResolver",function(){return Yc}),l.d(r,"OrderStateSelectDialogComponent",function(){return wc}),l.d(r,"OrderTableComponent",function(){return Uc}),l.d(r,"OrderTransitionService",function(){return Ac}),l.d(r,"PaymentDetailComponent",function(){return Gc}),l.d(r,"PaymentStateLabelComponent",function(){return Bc}),l.d(r,"RefundOrderDialogComponent",function(){return zc}),l.d(r,"RefundStateLabelComponent",function(){return Jc}),l.d(r,"SettleRefundDialogComponent",function(){return jc}),l.d(r,"SimpleItemListComponent",function(){return Xc}),l.d(r,"modifyingOrderBreadcrumb",function(){return rr}),l.d(r,"orderBreadcrumb",function(){return cr}),l.d(r,"orderRoutes",function(){return nr}),l.d(r,"\u02750",function(){return Kc}),l.d(r,"\u02751",function(){return er}),l.d(r,"\u02752",function(){return tr});var s=l("EM62"),b=l("nIj0"),g=l("ixhn"),y=l("OxKu"),v=l("hG4v"),h=l("sEIs"),k=l("6Oco"),T=l("ZTXN"),C=l("ROBh"),O=l("g6G6"),x=l("C05f"),I=l("TLy2"),S=l("4e/d"),E=l("uCWR"),P=function(){function e(t,n){m(this,e),this.notifier=t,this.source=n}return p(e,[{key:"call",value:function(e,t){return t.subscribe(new M(e,this.notifier,this.source))}}]),e}(),M=function(e){a(n,e);var t=d(n);function n(e,c,r){var i;return m(this,n),(i=t.call(this,e)).notifier=c,i.source=r,i}return p(n,[{key:"error",value:function(e){if(!this.isStopped){var t=this.errors,c=this.retries,r=this.retriesSubscription;if(c)this.errors=void 0,this.retriesSubscription=void 0;else{t=new T.a;try{c=(0,this.notifier)(t)}catch(i){return o(f(n.prototype),"error",this).call(this,i)}r=Object(E.c)(c,new E.a(this))}this._unsubscribeAndRecycle(),this.errors=t,this.retries=c,this.retriesSubscription=r,t.next(e)}}},{key:"_unsubscribe",value:function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=void 0),t&&(t.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0}},{key:"notifyNext",value:function(){var e=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=e,this.source.subscribe(this)}}]),n}(E.b),F=l("BwBJ"),w=l("J+dc"),A=l("YtkY"),_=l("jIqt"),z=l("7SLS"),j=l("kuMc"),Z=l("wqq/"),D=l("Ohay"),L=l("xVbo"),R=l("mWib"),N=l("8j5Y"),$=l("jY47"),q=l("s2Ay"),V=l("2kYt"),W=l("Kej3"),Q=l("E5oP");function H(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.add-payment-to-order"))}function U(e,t){if(1&e){var n=s.mc();s.lc(0,"button",7),s.vc("click",function(){return s.Sc(n),s.xc().cancel()}),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"button",8),s.vc("click",function(){return s.Sc(n),s.xc().submit()}),s.bd(4),s.yc(5,"translate"),s.yc(6,"localeCurrency"),s.kc()}if(2&e){var c=s.xc();s.Tb(1),s.cd(s.zc(2,4,"common.cancel")),s.Tb(2),s.Ec("disabled",c.form.invalid||c.form.pristine),s.Tb(1),s.ed(" ",s.zc(5,6,"order.add-payment")," (",s.Ac(6,8,c.outstandingAmount,c.currencyCode),") ")}}function G(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.cancel-order"))}function B(e,t){if(1&e){var n=s.mc();s.lc(0,"input",18),s.vc("ngModelChange",function(e){s.Sc(n);var t=s.xc().$implicit;return s.xc().lineQuantities[t.id]=e}),s.kc()}if(2&e){var c=s.xc().$implicit,r=s.xc();s.Ec("ngModel",r.lineQuantities[c.id])("max",c.quantity)}}function J(e,t){if(1&e&&s.bd(0),2&e){var n=s.xc().$implicit;s.cd(n.quantity)}}function X(e,t){if(1&e&&(s.lc(0,"tr",9),s.lc(1,"td",10),s.gc(2,"img",11),s.yc(3,"assetPreview"),s.kc(),s.lc(4,"td",12),s.bd(5),s.kc(),s.lc(6,"td",13),s.bd(7),s.kc(),s.lc(8,"td",14),s.bd(9),s.kc(),s.lc(10,"td",14),s.bd(11),s.yc(12,"localeCurrency"),s.kc(),s.lc(13,"td",15),s.Zc(14,B,1,2,"input",16),s.Zc(15,J,1,1,"ng-template",null,17,s.ad),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.Oc(16),r=s.xc();s.Xb("is-cancelled",0===n.quantity),s.Tb(2),s.Ec("src",s.Ac(3,9,n.featuredAsset,"tiny"),s.Uc),s.Tb(3),s.cd(n.productVariant.name),s.Tb(2),s.cd(n.productVariant.sku),s.Tb(2),s.cd(n.quantity),s.Tb(2),s.dd(" ",s.Ac(12,12,n.unitPriceWithTax,r.order.currencyCode)," "),s.Tb(3),s.Ec("ngIf",n.quantity>0&&!r.order.active)("ngIfElse",c)}}function Y(e,t){1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.ic()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.cancel-selected-items")," "))}function K(e,t){1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.ic()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.cancel-order")," "))}function ee(e,t){if(1&e){var n=s.mc();s.lc(0,"button",19),s.vc("click",function(){return s.Sc(n),s.xc().cancel()}),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"button",20),s.vc("click",function(){return s.Sc(n),s.xc().select()}),s.Zc(4,Y,3,3,"ng-container",21),s.Zc(5,K,3,3,"ng-container",21),s.kc()}if(2&e){var c=s.xc();s.Tb(1),s.cd(s.zc(2,4,"common.cancel")),s.Tb(2),s.Ec("disabled",!c.reason||!c.order.active&&0===c.selectionCount),s.Tb(1),s.Ec("ngIf",!c.order.active),s.Tb(1),s.Ec("ngIf",c.order.active)}}function te(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.fulfill-order"))}function ne(e,t){if(1&e&&(s.gc(0,"img",17),s.yc(1,"assetPreview")),2&e){var n=s.xc().$implicit;s.Ec("src",s.Ac(1,1,n.featuredAsset,"tiny"),s.Uc)}}function ce(e,t){if(1&e){var n=s.mc();s.lc(0,"input",18),s.vc("ngModelChange",function(e){s.Sc(n);var t=s.xc().$implicit;return s.xc().fulfillmentQuantities[t.id].fulfillCount=e}),s.kc()}if(2&e){var c=s.xc().$implicit,r=s.xc();s.Ec("disabled",0===r.getUnfulfilledCount(c))("ngModel",r.fulfillmentQuantities[c.id].fulfillCount)("max",r.fulfillmentQuantities[c.id].max)}}function re(e,t){if(1&e&&(s.lc(0,"tr",9),s.lc(1,"td",10),s.Zc(2,ne,2,4,"img",11),s.kc(),s.lc(3,"td",12),s.bd(4),s.kc(),s.lc(5,"td",13),s.bd(6),s.kc(),s.lc(7,"td",14),s.bd(8),s.kc(),s.lc(9,"td",14),s.bd(10),s.kc(),s.lc(11,"td",15),s.Zc(12,ce,1,3,"input",16),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc();s.Xb("ignore",0===c.getUnfulfilledCount(n)),s.Tb(2),s.Ec("ngIf",n.featuredAsset),s.Tb(2),s.cd(n.productVariant.name),s.Tb(2),s.cd(n.productVariant.sku),s.Tb(2),s.cd(c.getUnfulfilledCount(n)),s.Tb(2),s.cd(n.productVariant.stockOnHand),s.Tb(2),s.Ec("ngIf",c.fulfillmentQuantities[n.id])}}function ie(e,t){if(1&e){var n=s.mc();s.lc(0,"button",19),s.vc("click",function(){return s.Sc(n),s.xc().cancel()}),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"button",20),s.vc("click",function(){return s.Sc(n),s.xc().select()}),s.bd(4),s.yc(5,"translate"),s.kc()}if(2&e){var c=s.xc();s.Tb(1),s.cd(s.zc(2,3,"common.cancel")),s.Tb(2),s.Ec("disabled",!c.canSubmit()),s.Tb(1),s.dd(" ",s.zc(5,5,"order.create-fulfillment")," ")}}function oe(e,t){if(1&e&&s.gc(0,"vdr-fulfillment-detail",7),2&e){var n=s.xc();s.Ec("fulfillmentId",null==n.fulfillment?null:n.fulfillment.id)("order",n.order)}}var ae=function(e){return{state:e}};function le(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"button",14),s.vc("click",function(){s.Sc(n);var e=t.ngIf;return s.xc(2).transitionState.emit(e)}),s.bd(2),s.yc(3,"translate"),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.kc(),s.ic()}if(2&e){var c=t.ngIf;s.Tb(2),s.dd(" ",s.Ac(3,1,"order.set-fulfillment-state",s.Ic(8,ae,s.zc(4,4,s.zc(5,6,c))))," ")}}function de(e,t){if(1&e&&(s.jc(0),s.gc(1,"clr-icon",18),s.bd(2),s.yc(3,"translate"),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.ic()),2&e){var n=s.xc().$implicit;s.Tb(2),s.dd(" ",s.Ac(3,1,"order.transition-to-state",s.Ic(8,ae,s.zc(4,4,s.zc(5,6,n))))," ")}}function se(e,t){1&e&&(s.gc(0,"clr-icon",19),s.bd(1),s.yc(2,"translate")),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.cancel-fulfillment")," "))}function ue(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"button",15),s.vc("click",function(){s.Sc(n);var e=t.$implicit;return s.xc(2).transitionState.emit(e)}),s.Zc(2,de,6,10,"ng-container",16),s.Zc(3,se,3,3,"ng-template",null,17,s.ad),s.kc(),s.ic()}if(2&e){var c=t.$implicit,r=s.Oc(4);s.Tb(2),s.Ec("ngIf","Cancelled"!==c)("ngIfElse",r)}}function fe(e,t){if(1&e&&(s.lc(0,"div",8),s.Zc(1,le,6,10,"ng-container",9),s.lc(2,"vdr-dropdown"),s.lc(3,"button",10),s.gc(4,"clr-icon",11),s.kc(),s.lc(5,"vdr-dropdown-menu",12),s.Zc(6,ue,5,2,"ng-container",13),s.kc(),s.kc(),s.kc()),2&e){var n=s.xc();s.Tb(1),s.Ec("ngIf",n.nextSuggestedState()),s.Tb(5),s.Ec("ngForOf",n.nextOtherStates())}}function me(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc();s.Ec("label",s.zc(1,2,"order.tracking-code")),s.Tb(2),s.dd(" ",null==n.fulfillment?null:n.fulfillment.trackingCode,"\n")}}function be(e,t){if(1&e&&s.gc(0,"vdr-custom-field-control",5),2&e){var n=s.xc().$implicit,c=s.xc();s.Ec("readonly",!0)("compact",!0)("customField",n)("customFieldsFormGroup",c.customFieldFormGroup)}}function pe(e,t){if(1&e&&(s.jc(0),s.Zc(1,be,1,4,"vdr-custom-field-control",4),s.ic()),2&e){var n=t.$implicit,c=s.xc();s.Tb(1),s.Ec("ngIf",c.customFieldFormGroup.get(n.name))}}function ge(e,t){1&e&&s.gc(0,"clr-icon",2)}function ye(e,t){1&e&&s.gc(0,"clr-icon",9)}function ve(e,t){1&e&&s.gc(0,"clr-icon",10)}function he(e,t){1&e&&s.gc(0,"clr-icon",11)}function ke(e,t){1&e&&(s.lc(0,"label",12),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.line-fulfillment-all")," "))}var Te=function(e,t){return{total:e,count:t}};function Ce(e,t){if(1&e&&(s.lc(0,"label",12),s.bd(1),s.yc(2,"translate"),s.kc()),2&e){var n=s.xc(2);s.Tb(1),s.dd(" ",s.Ac(2,1,"order.line-fulfillment-partial",s.Jc(4,Te,n.line.quantity,n.fulfilledCount))," ")}}function Oe(e,t){1&e&&(s.lc(0,"label",12),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.line-fulfillment-none")," "))}function xe(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",15),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc().$implicit;s.Ec("label",s.zc(1,2,"order.tracking-code")),s.Tb(2),s.dd(" ",n.fulfillment.trackingCode," ")}}var Ie=function(e){return{count:e}};function Se(e,t){if(1&e&&(s.lc(0,"div",13),s.lc(1,"div",14),s.bd(2),s.yc(3,"translate"),s.yc(4,"translate"),s.kc(),s.lc(5,"vdr-labeled-data",15),s.yc(6,"translate"),s.bd(7),s.yc(8,"localeDate"),s.kc(),s.lc(9,"vdr-labeled-data",15),s.yc(10,"translate"),s.bd(11),s.kc(),s.Zc(12,xe,3,4,"vdr-labeled-data",16),s.kc()),2&e){var n=t.$implicit;s.Tb(2),s.fd(" ",s.zc(3,8,"order.fulfillment")," #",n.fulfillment.id," (",s.Ac(4,10,"order.item-count",s.Ic(20,Ie,n.count)),") "),s.Tb(3),s.Ec("label",s.zc(6,13,"common.created-at")),s.Tb(2),s.dd(" ",s.Ac(8,15,n.fulfillment.createdAt,"medium")," "),s.Tb(2),s.Ec("label",s.zc(10,18,"order.fulfillment-method")),s.Tb(2),s.dd(" ",n.fulfillment.method," "),s.Tb(1),s.Ec("ngIf",n.fulfillment.trackingCode)}}function Ee(e,t){if(1&e&&(s.lc(0,"vdr-dropdown",1),s.lc(1,"button",2),s.Zc(2,ye,1,0,"clr-icon",3),s.Zc(3,ve,1,0,"clr-icon",4),s.Zc(4,he,1,0,"clr-icon",5),s.kc(),s.lc(5,"vdr-dropdown-menu",6),s.Zc(6,ke,3,3,"label",7),s.Zc(7,Ce,3,7,"label",7),s.Zc(8,Oe,3,3,"label",7),s.Zc(9,Se,13,22,"div",8),s.kc(),s.kc()),2&e){var n=s.xc();s.Tb(2),s.Ec("ngIf","full"===n.fulfillmentStatus),s.Tb(1),s.Ec("ngIf","partial"===n.fulfillmentStatus),s.Tb(1),s.Ec("ngIf","none"===n.fulfillmentStatus),s.Tb(2),s.Ec("ngIf","full"===n.fulfillmentStatus),s.Tb(1),s.Ec("ngIf","partial"===n.fulfillmentStatus),s.Tb(1),s.Ec("ngIf","none"===n.fulfillmentStatus),s.Tb(1),s.Ec("ngForOf",n.fulfillments)}}function Pe(e,t){if(1&e&&(s.lc(0,"span",1),s.yc(1,"translate"),s.gc(2,"clr-icon",2),s.kc()),2&e){var n=s.xc();s.Ec("title",s.Ac(1,1,"order.refunded-count",s.Ic(4,Ie,n.getRefundedCount())))}}function Me(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc();s.Ec("label",s.zc(1,2,"order.note")),s.Tb(2),s.cd(n.modification.note)}}function Fe(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.yc(3,"localeCurrency"),s.kc()),2&e){var n=t.$implicit,c=s.xc(),r=null;s.Ec("label",s.zc(1,3,"order.surcharges")),s.Tb(2),s.ed(" ",null==(r=c.getSurcharge(n.id))?null:r.description," ",s.Ac(3,5,null==(r=c.getSurcharge(n.id))?null:r.priceWithTax,c.order.currencyCode),"")}}function we(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.gc(2,"vdr-simple-item-list",3),s.kc()),2&e){var n=s.xc();s.Ec("label",s.zc(1,2,"order.added-items")),s.Tb(2),s.Ec("items",n.getAddedItems())}}function Ae(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.gc(2,"vdr-simple-item-list",3),s.kc()),2&e){var n=s.xc();s.Ec("label",s.zc(1,2,"order.removed-items")),s.Tb(2),s.Ec("items",n.getRemovedItems())}}function _e(e,t){if(1&e&&(s.jc(0),s.gc(1,"vdr-custom-field-control",9),s.ic()),2&e){var n=t.$implicit,c=s.xc(2);s.Tb(1),s.Ec("customFieldsFormGroup",c.customFieldForm)("compact",!0)("readonly",n.readonly||!c.editable)("customField",n)}}function ze(e,t){if(1&e){var n=s.mc();s.lc(0,"button",10),s.vc("click",function(){return s.Sc(n),s.xc(2).editable=!0}),s.gc(1,"clr-icon",11),s.bd(2),s.yc(3,"translate"),s.kc()}2&e&&(s.Tb(2),s.dd(" ",s.zc(3,1,"common.edit")," "))}function je(e,t){if(1&e){var n=s.mc();s.lc(0,"button",12),s.vc("click",function(){return s.Sc(n),s.xc(2).onUpdateClick()}),s.gc(1,"clr-icon",13),s.bd(2),s.yc(3,"translate"),s.kc()}if(2&e){var c=s.xc(2);s.Ec("disabled",c.customFieldForm.pristine||c.customFieldForm.invalid),s.Tb(2),s.dd(" ",s.zc(3,2,"common.update")," ")}}function Ze(e,t){if(1&e&&(s.lc(0,"div",1),s.lc(1,"div",2),s.bd(2),s.yc(3,"translate"),s.kc(),s.lc(4,"div",3),s.lc(5,"div",4),s.Zc(6,_e,2,4,"ng-container",5),s.kc(),s.kc(),s.lc(7,"div",6),s.Zc(8,ze,4,3,"button",7),s.Zc(9,je,4,4,"button",8),s.kc(),s.kc()),2&e){var n=s.xc();s.Tb(2),s.dd(" ",s.zc(3,6,"common.custom-fields")," "),s.Tb(3),s.Xb("editable",n.editable),s.Tb(1),s.Ec("ngForOf",n.customFieldsConfig),s.Tb(2),s.Ec("ngIf",!n.editable),s.Tb(1),s.Ec("ngIf",n.editable)}}function De(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.select-state"))}function Le(e,t){if(1&e&&(s.lc(0,"option",4),s.bd(1),s.yc(2,"translate"),s.yc(3,"stateI18nToken"),s.kc()),2&e){var n=t.$implicit;s.Ec("value",n),s.Tb(1),s.dd(" ",s.zc(2,2,s.zc(3,4,n))," ")}}function Re(e,t){if(1&e){var n=s.mc();s.lc(0,"button",7),s.vc("click",function(){return s.Sc(n),s.xc(2).cancel()}),s.bd(1),s.yc(2,"translate"),s.kc()}2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"common.cancel")," "))}function Ne(e,t){if(1&e){var n=s.mc();s.Zc(0,Re,3,3,"button",5),s.lc(1,"button",6),s.vc("click",function(){return s.Sc(n),s.xc().select()}),s.bd(2),s.yc(3,"translate"),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.kc()}if(2&e){var c=s.xc();s.Ec("ngIf",c.cancellable),s.Tb(1),s.Ec("disabled",!c.selectedState),s.Tb(1),s.dd(" ",s.Ac(3,3,"order.transition-to-state",s.Ic(10,ae,s.zc(4,6,s.zc(5,8,c.selectedState))))," ")}}function $e(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.order-state-diagram"))}function qe(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.refund-and-cancel-order"))}function Ve(e,t){if(1&e&&(s.lc(0,"div",36),s.bd(1),s.lc(2,"div",37),s.bd(3),s.yc(4,"currency"),s.yc(5,"number"),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc(3).$implicit,r=s.xc();s.Tb(1),s.dd(" ",n.description," "),s.Tb(2),s.dd(" ",s.Ac(4,2,s.Ac(5,5,n.amount/100/c.quantity,"1.0-2"),r.order.currencyCode)," ")}}function We(e,t){if(1&e&&(s.lc(0,"vdr-dropdown"),s.lc(1,"div",32),s.lc(2,"button",33),s.gc(3,"clr-icon",34),s.kc(),s.kc(),s.lc(4,"vdr-dropdown-menu"),s.Zc(5,Ve,6,8,"div",35),s.kc(),s.kc()),2&e){var n=s.xc().ngIf;s.Tb(5),s.Ec("ngForOf",n)}}function Qe(e,t){if(1&e&&(s.jc(0),s.Zc(1,We,6,1,"vdr-dropdown",26),s.ic()),2&e){var n=t.ngIf;s.Tb(1),s.Ec("ngIf",n.length)}}function He(e,t){if(1&e){var n=s.mc();s.lc(0,"input",38),s.vc("ngModelChange",function(e){s.Sc(n);var t=s.xc().$implicit;return s.xc().lineQuantities[t.id].quantity=e})("input",function(){s.Sc(n);var e=s.xc().$implicit,t=s.xc();return t.handleZeroQuantity(t.lineQuantities[e.id])}),s.kc()}if(2&e){var c=s.xc().$implicit,r=s.xc();s.Ec("ngModel",r.lineQuantities[c.id].quantity)("max",c.quantity)}}function Ue(e,t){if(1&e){var n=s.mc();s.lc(0,"input",39),s.vc("ngModelChange",function(e){s.Sc(n);var t=s.xc().$implicit;return s.xc().lineQuantities[t.id].refund=e}),s.kc()}if(2&e){var c=s.xc().$implicit,r=s.xc();s.Ec("disabled",0===r.lineQuantities[c.id].quantity)("ngModel",r.lineQuantities[c.id].refund)}}function Ge(e,t){if(1&e){var n=s.mc();s.lc(0,"input",39),s.vc("ngModelChange",function(e){s.Sc(n);var t=s.xc().$implicit;return s.xc().lineQuantities[t.id].cancel=e}),s.kc()}if(2&e){var c=s.xc().$implicit,r=s.xc();s.Ec("disabled",0===r.lineQuantities[c.id].quantity)("ngModel",r.lineQuantities[c.id].cancel)}}function Be(e,t){if(1&e&&(s.lc(0,"tr",18),s.lc(1,"td",19),s.gc(2,"img",20),s.yc(3,"assetPreview"),s.kc(),s.lc(4,"td",21),s.bd(5),s.kc(),s.lc(6,"td",22),s.bd(7),s.kc(),s.lc(8,"td",23),s.bd(9),s.gc(10,"vdr-line-refunds",24),s.kc(),s.lc(11,"td",23),s.bd(12),s.yc(13,"localeCurrency"),s.kc(),s.lc(14,"td",23),s.lc(15,"div",25),s.bd(16),s.yc(17,"localeCurrency"),s.Zc(18,Qe,2,1,"ng-container",26),s.kc(),s.kc(),s.lc(19,"td",27),s.Zc(20,He,1,2,"input",28),s.kc(),s.lc(21,"td",29),s.lc(22,"div",30),s.Zc(23,Ue,1,2,"input",31),s.kc(),s.kc(),s.lc(24,"td",29),s.lc(25,"div",30),s.Zc(26,Ge,1,2,"input",31),s.kc(),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc();s.Tb(2),s.Ec("src",s.Ac(3,12,n.featuredAsset,"tiny"),s.Uc),s.Tb(3),s.cd(n.productVariant.name),s.Tb(2),s.cd(n.productVariant.sku),s.Tb(2),s.dd(" ",n.quantity," "),s.Tb(1),s.Ec("line",n)("payments",c.order.payments),s.Tb(2),s.dd(" ",s.Ac(13,15,n.unitPriceWithTax,c.order.currencyCode)," "),s.Tb(4),s.dd(" ",s.Ac(17,18,n.proratedUnitPriceWithTax,c.order.currencyCode)," "),s.Tb(2),s.Ec("ngIf",n.discounts),s.Tb(2),s.Ec("ngIf",c.lineCanBeRefundedOrCancelled(n)),s.Tb(3),s.Ec("ngIf",c.lineCanBeRefundedOrCancelled(n)),s.Tb(3),s.Ec("ngIf",c.lineCanBeRefundedOrCancelled(n))}}function Je(e,t){if(1&e&&(s.lc(0,"option",40),s.bd(1),s.yc(2,"localeCurrency"),s.kc()),2&e){var n=t.$implicit,c=s.xc();s.Ec("ngValue",n)("disabled","Settled"!==n.state),s.Tb(1),s.fd(" #",n.id," ",n.method,": ",s.Ac(2,5,n.amount,c.order.currencyCode)," ")}}var Xe=function(e,t){return{min:e,max:t}};function Ye(e,t){if(1&e&&(s.lc(0,"div",41),s.bd(1),s.yc(2,"translate"),s.yc(3,"currency"),s.yc(4,"localeCurrency"),s.kc()),2&e){var n=s.xc();s.Tb(1),s.dd(" ",s.Ac(2,1,"order.refund-total-error",s.Jc(10,Xe,s.Ac(3,4,0,n.order.currencyCode),s.Ac(4,7,n.settledPaymentsTotal,n.order.currencyCode)))," ")}}function Ke(e,t){1&e&&(s.lc(0,"div",42),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.refund-total-warning")," "))}var et=function(e){return{amount:e}};function tt(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.yc(3,"localeCurrency"),s.ic()),2&e){var n=s.xc(2);s.Tb(1),s.dd(" ",s.Ac(2,1,"order.refund-with-amount",s.Ic(7,et,s.Ac(3,4,n.refundTotal,n.order.currencyCode)))," ")}}function nt(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.dd(" ",s.zc(1,1,"order.cancel-selected-items")," ")}function ct(e,t){if(1&e){var n=s.mc();s.lc(0,"button",43),s.vc("click",function(){return s.Sc(n),s.xc().cancel()}),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"button",44),s.vc("click",function(){return s.Sc(n),s.xc().select()}),s.Zc(4,tt,4,9,"ng-container",45),s.Zc(5,nt,2,3,"ng-template",null,46,s.ad),s.kc()}if(2&e){var c=s.Oc(6),r=s.xc();s.Tb(1),s.cd(s.zc(2,4,"common.cancel")),s.Tb(2),s.Ec("disabled",!r.canSubmit()),s.Tb(1),s.Ec("ngIf",r.isRefunding())("ngIfElse",c)}}function rt(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.settle-refund"))}function it(e,t){if(1&e){var n=s.mc();s.lc(0,"button",4),s.vc("click",function(){return s.Sc(n),s.xc().cancel()}),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"button",5),s.vc("click",function(){return s.Sc(n),s.xc().submit()}),s.bd(4),s.yc(5,"translate"),s.kc()}if(2&e){var c=s.xc();s.Tb(1),s.cd(s.zc(2,3,"common.cancel")),s.Tb(2),s.Ec("disabled",!c.transactionId),s.Tb(1),s.dd(" ",s.zc(5,5,"order.settle-refund")," ")}}var ot=function(e){return{method:e}};function at(e,t){if(1&e){var n=s.mc();s.lc(0,"button",16),s.vc("click",function(){s.Sc(n);var e=s.xc().ngIf;return s.xc().addManualPayment(e)}),s.bd(1),s.yc(2,"translate"),s.yc(3,"localeCurrency"),s.kc()}if(2&e){var c=s.xc().ngIf,r=s.xc();s.Tb(1),s.ed(" ",s.zc(2,2,"order.add-payment-to-order")," (",s.Ac(3,4,r.outstandingPaymentAmount(c),c.currencyCode),") ")}}function lt(e,t){if(1&e){var n=s.mc();s.lc(0,"button",16),s.vc("click",function(){return s.Sc(n),s.xc(2).transitionToState("ArrangingAdditionalPayment")}),s.bd(1),s.yc(2,"translate"),s.kc()}2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.arrange-additional-payment")," "))}function dt(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"button",14),s.vc("click",function(){return s.Sc(n),s.xc(2).transitionToModifying()}),s.gc(2,"clr-icon",17),s.bd(3),s.yc(4,"translate"),s.kc(),s.gc(5,"div",13),s.ic()}2&e&&(s.Tb(3),s.dd(" ",s.zc(4,1,"order.modify-order")," "))}function st(e,t){1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.ic()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.refund-and-cancel-order")," "))}function ut(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.dd(" ",s.zc(1,1,"order.cancel-order")," ")}function ft(e,t){if(1&e){var n=s.mc();s.lc(0,"button",14),s.vc("click",function(){s.Sc(n);var e=s.xc().ngIf;return s.xc().cancelOrRefund(e)}),s.gc(1,"clr-icon",18),s.Zc(2,st,3,3,"ng-container",19),s.Zc(3,ut,2,3,"ng-template",null,20,s.ad),s.kc()}if(2&e){var c=s.Oc(4),r=s.xc().ngIf,i=s.xc();s.Tb(2),s.Ec("ngIf",i.orderHasSettledPayments(r))("ngIfElse",c)}}function mt(e,t){if(1&e){var n=s.mc();s.lc(0,"button",14),s.vc("click",function(){s.Sc(n);var e=t.$implicit;return s.xc(3).transitionToState(e)}),s.gc(1,"clr-icon",22),s.bd(2),s.yc(3,"translate"),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.kc()}if(2&e){var c=t.$implicit;s.Tb(2),s.dd(" ",s.Ac(3,1,"order.transition-to-state",s.Ic(8,ae,s.zc(4,4,s.zc(5,6,c))))," ")}}function bt(e,t){if(1&e&&(s.jc(0),s.gc(1,"div",13),s.Zc(2,mt,6,10,"button",21),s.yc(3,"async"),s.ic()),2&e){var n=s.xc(2);s.Tb(2),s.Ec("ngForOf",s.zc(3,1,n.nextStates$))}}function pt(e,t){if(1&e){var n=s.mc();s.lc(0,"vdr-action-bar"),s.lc(1,"vdr-ab-left"),s.lc(2,"div",1),s.gc(3,"vdr-entity-info",2),s.yc(4,"async"),s.lc(5,"vdr-order-state-label",3),s.lc(6,"button",4),s.vc("click",function(){return s.Sc(n),s.xc().openStateDiagram()}),s.yc(7,"translate"),s.gc(8,"clr-icon",5),s.kc(),s.kc(),s.kc(),s.kc(),s.lc(9,"vdr-ab-right"),s.gc(10,"vdr-action-bar-items",6),s.Zc(11,at,4,7,"button",7),s.Zc(12,lt,3,3,"button",7),s.lc(13,"button",8),s.vc("click",function(){return s.Sc(n),s.xc().fulfillOrder()}),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"vdr-dropdown"),s.lc(17,"button",9),s.gc(18,"clr-icon",10),s.kc(),s.lc(19,"vdr-dropdown-menu",11),s.Zc(20,dt,6,3,"ng-container",0),s.Zc(21,ft,5,2,"button",12),s.Zc(22,bt,4,3,"ng-container",0),s.yc(23,"async"),s.gc(24,"div",13),s.lc(25,"button",14),s.vc("click",function(){s.Sc(n);var e=t.ngIf;return s.xc().manuallyTransitionToState(e)}),s.gc(26,"clr-icon",15),s.bd(27),s.yc(28,"translate"),s.kc(),s.kc(),s.kc(),s.kc(),s.kc()}if(2&e){var c,r=t.ngIf,i=s.xc();s.Tb(3),s.Ec("entity",s.zc(4,11,i.entity$)),s.Tb(2),s.Ec("state",r.state),s.Tb(1),s.Ec("title",s.zc(7,13,"order.order-state-diagram")),s.Tb(5),s.Ec("ngIf","ArrangingAdditionalPayment"===r.state&&(i.hasUnsettledModifications(r)||0<i.outstandingPaymentAmount(r))),s.Tb(1),s.Ec("ngIf","ArrangingAdditionalPayment"!==r.state&&0<i.outstandingPaymentAmount(r)),s.Tb(1),s.Ec("disabled",!i.canAddFulfillment(r)),s.Tb(1),s.dd(" ",s.zc(15,15,"order.fulfill-order")," "),s.Tb(6),s.Ec("ngIf",r.nextStates.includes("Modifying")),s.Tb(1),s.Ec("ngIf",r.nextStates.includes("Cancelled")),s.Tb(1),s.Ec("ngIf",null==(c=s.zc(23,17,i.nextStates$))?null:c.length),s.Tb(5),s.dd(" ",s.zc(28,19,"order.manually-transition-to-state")," ")}}function gt(e,t){if(1&e&&(s.lc(0,"tr"),s.lc(1,"td"),s.bd(2),s.kc(),s.lc(3,"td"),s.bd(4),s.yc(5,"percent"),s.kc(),s.lc(6,"td"),s.bd(7),s.yc(8,"localeCurrency"),s.kc(),s.lc(9,"td"),s.bd(10),s.yc(11,"localeCurrency"),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc().ngIf;s.Tb(2),s.cd(n.description),s.Tb(2),s.cd(s.zc(5,4,n.taxRate/100)),s.Tb(3),s.cd(s.Ac(8,6,n.taxBase,c.currencyCode)),s.Tb(3),s.cd(s.Ac(11,9,n.taxTotal,c.currencyCode))}}function yt(e,t){1&e&&(s.lc(0,"h6"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.shipping-address")," "))}function vt(e,t){1&e&&(s.lc(0,"h6"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.billing-address")," "))}function ht(e,t){if(1&e){var n=s.mc();s.lc(0,"vdr-order-payment-card",38),s.vc("settlePayment",function(e){return s.Sc(n),s.xc(3).settlePayment(e)})("transitionPaymentState",function(e){return s.Sc(n),s.xc(3).transitionPaymentState(e)})("settleRefund",function(e){return s.Sc(n),s.xc(3).settleRefund(e)}),s.kc()}if(2&e){var c=t.$implicit,r=s.xc(2).ngIf;s.Ec("currencyCode",r.currencyCode)("payment",c)}}function kt(e,t){if(1&e&&(s.jc(0),s.Zc(1,ht,1,2,"vdr-order-payment-card",37),s.ic()),2&e){var n=s.xc().ngIf;s.Tb(1),s.Ec("ngForOf",n.payments)}}function Tt(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"vdr-fulfillment-card",39),s.vc("transitionState",function(e){s.Sc(n);var c=t.$implicit;return s.xc(2).transitionFulfillment(c.id,e)}),s.kc(),s.ic()}if(2&e){var c=t.$implicit,r=s.xc().ngIf;s.Tb(1),s.Ec("fulfillment",c)("order",r)}}function Ct(e,t){if(1&e){var n=s.mc();s.lc(0,"div"),s.lc(1,"div",23),s.lc(2,"div",24),s.gc(3,"vdr-order-table",25),s.lc(4,"h4"),s.bd(5),s.yc(6,"translate"),s.kc(),s.lc(7,"table",26),s.lc(8,"thead"),s.lc(9,"tr"),s.lc(10,"th"),s.bd(11),s.yc(12,"translate"),s.kc(),s.lc(13,"th"),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"th"),s.bd(17),s.yc(18,"translate"),s.kc(),s.lc(19,"th"),s.bd(20),s.yc(21,"translate"),s.kc(),s.kc(),s.kc(),s.lc(22,"tbody"),s.Zc(23,gt,12,12,"tr",27),s.kc(),s.kc(),s.lc(24,"vdr-order-history",28),s.vc("addNote",function(e){return s.Sc(n),s.xc().addNote(e)})("updateNote",function(e){return s.Sc(n),s.xc().updateNote(e)})("deleteNote",function(e){return s.Sc(n),s.xc().deleteNote(e)}),s.yc(25,"async"),s.kc(),s.kc(),s.lc(26,"div",29),s.lc(27,"vdr-order-custom-fields-card",30),s.vc("updateClick",function(e){return s.Sc(n),s.xc().updateCustomFields(e)}),s.kc(),s.lc(28,"div",31),s.lc(29,"div",32),s.bd(30),s.yc(31,"translate"),s.kc(),s.lc(32,"div",33),s.lc(33,"div",34),s.gc(34,"vdr-customer-label",35),s.Zc(35,yt,3,3,"h6",0),s.gc(36,"vdr-formatted-address",36),s.Zc(37,vt,3,3,"h6",0),s.gc(38,"vdr-formatted-address",36),s.kc(),s.kc(),s.kc(),s.Zc(39,kt,2,1,"ng-container",0),s.Zc(40,Tt,2,2,"ng-container",27),s.kc(),s.kc(),s.kc()}if(2&e){var c=t.ngIf,r=s.xc();s.Tb(3),s.Ec("order",c)("orderLineCustomFields",r.orderLineCustomFields),s.Tb(2),s.cd(s.zc(6,20,"order.tax-summary")),s.Tb(6),s.cd(s.zc(12,22,"common.description")),s.Tb(3),s.cd(s.zc(15,24,"order.tax-rate")),s.Tb(3),s.cd(s.zc(18,26,"order.tax-base")),s.Tb(3),s.cd(s.zc(21,28,"order.tax-total")),s.Tb(3),s.Ec("ngForOf",c.taxSummary),s.Tb(1),s.Ec("order",c)("history",s.zc(25,30,r.history$)),s.Tb(3),s.Ec("customFieldsConfig",r.customFields)("customFieldValues",c.customFields),s.Tb(3),s.dd(" ",s.zc(31,32,"order.customer")," "),s.Tb(4),s.Ec("customer",c.customer),s.Tb(1),s.Ec("ngIf",r.getOrderAddressLines(c.shippingAddress).length),s.Tb(1),s.Ec("address",c.shippingAddress),s.Tb(1),s.Ec("ngIf",r.getOrderAddressLines(c.billingAddress).length),s.Tb(1),s.Ec("address",c.billingAddress),s.Tb(1),s.Ec("ngIf",c.payments&&c.payments.length),s.Tb(1),s.Ec("ngForOf",c.fulfillments)}}function Ot(e,t){1&e&&(s.bd(0),s.yc(1,"translate")),2&e&&s.cd(s.zc(1,1,"order.confirm-modifications"))}function xt(e,t){if(1&e&&(s.lc(0,"option",9),s.bd(1),s.yc(2,"localeCurrency"),s.kc()),2&e){var n=t.$implicit,c=s.xc(2);s.Ec("ngValue",n),s.Tb(1),s.fd(" #",n.id," ",n.method,": ",s.Ac(2,4,n.amount,c.order.currencyCode)," ")}}function It(e,t){if(1&e){var n=s.mc();s.lc(0,"div"),s.lc(1,"clr-select-container"),s.lc(2,"label"),s.bd(3),s.yc(4,"translate"),s.kc(),s.lc(5,"select",5),s.vc("ngModelChange",function(e){return s.Sc(n),s.xc().selectedPayment=e}),s.Zc(6,xt,3,7,"option",6),s.kc(),s.kc(),s.lc(7,"label",7),s.bd(8),s.yc(9,"translate"),s.kc(),s.lc(10,"textarea",8),s.vc("ngModelChange",function(e){return s.Sc(n),s.xc().refundNote=e}),s.kc(),s.kc()}if(2&e){var c=s.xc();s.Tb(3),s.cd(s.zc(4,5,"order.payment-to-refund")),s.Tb(2),s.Ec("ngModel",c.selectedPayment),s.Tb(1),s.Ec("ngForOf",c.order.payments),s.Tb(2),s.cd(s.zc(9,7,"order.refund-cancellation-reason")),s.Tb(2),s.Ec("ngModel",c.refundNote)}}function St(e,t){if(1&e){var n=s.mc();s.lc(0,"button",10),s.vc("click",function(){return s.Sc(n),s.xc().cancel()}),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"button",11),s.vc("click",function(){return s.Sc(n),s.xc().submit()}),s.bd(4),s.yc(5,"translate"),s.kc()}if(2&e){var c=s.xc();s.Tb(1),s.cd(s.zc(2,3,"common.cancel")),s.Tb(2),s.Ec("disabled",c.priceDifference<0&&!c.selectedPayment),s.Tb(1),s.dd(" ",s.zc(5,5,"common.confirm")," ")}}function Et(e,t){if(1&e){var n=s.mc();s.lc(0,"vdr-action-bar"),s.lc(1,"vdr-ab-left"),s.lc(2,"div",1),s.gc(3,"vdr-entity-info",2),s.yc(4,"async"),s.gc(5,"vdr-order-state-label",3),s.kc(),s.kc(),s.lc(6,"vdr-ab-right"),s.lc(7,"button",4),s.vc("click",function(){s.Sc(n);var e=t.ngIf;return s.xc().transitionToPriorState(e)}),s.bd(8),s.yc(9,"translate"),s.kc(),s.kc(),s.kc()}if(2&e){var c=t.ngIf,r=s.xc();s.Tb(3),s.Ec("entity",s.zc(4,3,r.entity$)),s.Tb(2),s.Ec("state",c.state),s.Tb(3),s.dd(" ",s.zc(9,5,"order.cancel-modification")," ")}}function Pt(e,t){1&e&&(s.lc(0,"th"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.cd(s.zc(2,1,"common.custom-fields")))}function Mt(e,t){if(1&e&&(s.gc(0,"img",41),s.yc(1,"assetPreview")),2&e){var n=s.xc().$implicit;s.Ec("src",s.Ac(1,1,n.featuredAsset,"tiny"),s.Uc)}}var Ft=function(e){return[e]};function wt(e,t){if(1&e&&(s.jc(0),s.gc(1,"vdr-custom-field-control",44),s.ic()),2&e){var n=t.$implicit,c=s.xc(2).index,r=s.xc(2);s.Tb(1),s.Ec("customField",n)("customFieldsFormGroup",r.orderLineCustomFieldsFormArray.get(s.Ic(3,Ft,c)))("compact",!0)}}function At(e,t){if(1&e&&(s.lc(0,"td",42),s.Zc(1,wt,2,5,"ng-container",43),s.kc()),2&e){var n=s.xc(3);s.Tb(1),s.Ec("ngForOf",n.orderLineCustomFields)}}function _t(e,t){if(1&e){var n=s.mc();s.lc(0,"tr",29),s.lc(1,"td",30),s.Zc(2,Mt,2,4,"img",31),s.kc(),s.lc(3,"td",32),s.bd(4),s.kc(),s.lc(5,"td",33),s.bd(6),s.kc(),s.lc(7,"td",34),s.bd(8),s.yc(9,"localeCurrency"),s.lc(10,"div",16),s.yc(11,"translate"),s.bd(12),s.yc(13,"localeCurrency"),s.kc(),s.kc(),s.lc(14,"td",35),s.lc(15,"input",36),s.vc("input",function(e){s.Sc(n);var c=t.$implicit;return s.xc(2).updateLineQuantity(c,e.target.value)}),s.kc(),s.gc(16,"vdr-line-refunds",37),s.gc(17,"vdr-line-fulfillment",38),s.kc(),s.Zc(18,At,2,1,"td",39),s.lc(19,"td",40),s.bd(20),s.yc(21,"localeCurrency"),s.lc(22,"div",16),s.yc(23,"translate"),s.bd(24),s.yc(25,"localeCurrency"),s.kc(),s.kc(),s.kc()}if(2&e){var c=t.$implicit,r=s.xc().ngIf,i=s.xc();s.Xb("is-cancelled",0===c.quantity)("modified",i.isLineModified(c)),s.Tb(2),s.Ec("ngIf",c.featuredAsset),s.Tb(2),s.cd(c.productVariant.name),s.Tb(2),s.cd(c.productVariant.sku),s.Tb(2),s.dd(" ",s.Ac(9,19,c.unitPriceWithTax,r.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(11,22,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(13,24,c.unitPrice,r.currencyCode)," "),s.Tb(3),s.Ec("value",c.quantity),s.Tb(1),s.Ec("line",c)("payments",r.payments),s.Tb(1),s.Ec("line",c)("orderState",r.state),s.Tb(1),s.Ec("ngIf",i.orderLineCustomFields.length),s.Tb(2),s.dd(" ",s.Ac(21,27,c.linePriceWithTax,r.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(23,30,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(25,32,c.linePrice,r.currencyCode)," ")}}function zt(e,t){if(1&e&&(s.gc(0,"img",41),s.yc(1,"assetPreview")),2&e){var n=s.xc().$implicit;s.Ec("src",s.Ac(1,1,n.productAsset,"tiny"),s.Uc)}}function jt(e,t){if(1&e&&(s.jc(0),s.gc(1,"vdr-custom-field-control",44),s.ic()),2&e){var n=t.$implicit,c=s.xc(2).index,r=s.xc(2);s.Tb(1),s.Ec("customField",n)("customFieldsFormGroup",r.addItemCustomFieldsFormArray.get(s.Ic(3,Ft,c)))("compact",!0)}}function Zt(e,t){if(1&e&&(s.lc(0,"td",42),s.Zc(1,jt,2,5,"ng-container",43),s.kc()),2&e){var n=s.xc(3);s.Tb(1),s.Ec("ngForOf",n.orderLineCustomFields)}}function Dt(e,t){if(1&e){var n=s.mc();s.lc(0,"tr",45),s.lc(1,"td",30),s.Zc(2,zt,2,4,"img",31),s.kc(),s.lc(3,"td",32),s.bd(4),s.kc(),s.lc(5,"td",33),s.bd(6),s.kc(),s.lc(7,"td",34),s.bd(8),s.yc(9,"localeCurrency"),s.lc(10,"div",16),s.yc(11,"translate"),s.bd(12),s.yc(13,"localeCurrency"),s.kc(),s.kc(),s.lc(14,"td",35),s.lc(15,"input",36),s.vc("input",function(e){s.Sc(n);var c=t.$implicit;return s.xc(2).updateAddedItemQuantity(c,e.target.value)}),s.kc(),s.lc(16,"button",46),s.vc("click",function(){s.Sc(n);var e=t.index;return s.xc(2).removeAddedItem(e)}),s.gc(17,"clr-icon",47),s.kc(),s.kc(),s.Zc(18,Zt,2,1,"td",39),s.lc(19,"td",40),s.bd(20),s.yc(21,"currency"),s.lc(22,"div",16),s.yc(23,"translate"),s.bd(24),s.yc(25,"currency"),s.kc(),s.kc(),s.kc()}if(2&e){var c=t.$implicit,r=s.xc().ngIf,i=s.xc();s.Tb(2),s.Ec("ngIf",c.productAsset),s.Tb(2),s.cd(c.productVariantName),s.Tb(2),s.cd(c.sku),s.Tb(2),s.dd(" ",s.Ac(9,11,c.priceWithTax,r.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(11,14,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(13,16,c.price,r.currencyCode)," "),s.Tb(3),s.Ec("value",c.quantity),s.Tb(3),s.Ec("ngIf",i.orderLineCustomFields.length),s.Tb(2),s.dd(" ",s.Ac(21,19,c.priceWithTax*c.quantity/100,r.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(23,22,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(25,24,c.price*c.quantity/100,r.currencyCode)," ")}}function Lt(e,t){1&e&&s.gc(0,"td")}function Rt(e,t){if(1&e&&(s.lc(0,"tr",48),s.lc(1,"td",49),s.bd(2),s.kc(),s.lc(3,"td",33),s.bd(4),s.kc(),s.gc(5,"td",50),s.gc(6,"td"),s.Zc(7,Lt,1,0,"td",0),s.lc(8,"td",40),s.bd(9),s.yc(10,"localeCurrency"),s.lc(11,"div",16),s.yc(12,"translate"),s.bd(13),s.yc(14,"localeCurrency"),s.kc(),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc().ngIf,r=s.xc();s.Tb(2),s.cd(n.description),s.Tb(2),s.cd(n.sku),s.Tb(3),s.Ec("ngIf",r.orderLineCustomFields.length),s.Tb(2),s.dd(" ",s.Ac(10,6,n.priceWithTax,c.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(12,9,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(14,11,n.price,c.currencyCode)," ")}}function Nt(e,t){1&e&&s.gc(0,"td")}function $t(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"localeCurrency"),s.lc(3,"div",16),s.yc(4,"translate"),s.bd(5),s.yc(6,"localeCurrency"),s.kc(),s.ic()),2&e){var n=t.ngIf,c=s.xc(2).ngIf;s.Tb(1),s.dd(" ",s.Ac(2,3,n.priceWithTax,c.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(4,6,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(6,8,n.price,c.currencyCode)," ")}}function qt(e,t){if(1&e){var n=s.mc();s.lc(0,"tr",51),s.lc(1,"td",49),s.bd(2),s.lc(3,"button",46),s.vc("click",function(){s.Sc(n);var e=t.index;return s.xc(2).removeSurcharge(e)}),s.gc(4,"clr-icon",47),s.kc(),s.kc(),s.lc(5,"td",33),s.bd(6),s.kc(),s.gc(7,"td",50),s.gc(8,"td"),s.Zc(9,Nt,1,0,"td",0),s.lc(10,"td",40),s.Zc(11,$t,7,11,"ng-container",0),s.kc(),s.kc()}if(2&e){var c=t.$implicit,r=s.xc(2);s.Tb(2),s.dd(" ",c.description," "),s.Tb(4),s.cd(c.sku),s.Tb(3),s.Ec("ngIf",r.orderLineCustomFields.length),s.Tb(2),s.Ec("ngIf",r.getSurchargePrices(c))}}function Vt(e,t){1&e&&s.gc(0,"td")}function Wt(e,t){if(1&e&&(s.gc(0,"img",58),s.yc(1,"assetPreview")),2&e){var n=t.ngIf;s.Ec("src",s.Ac(1,1,n,"tiny"),s.Uc)}}function Qt(e,t){if(1&e&&(s.lc(0,"div",55),s.Zc(1,Wt,2,4,"img",56),s.lc(2,"div"),s.lc(3,"strong",57),s.bd(4),s.kc(),s.lc(5,"small"),s.bd(6),s.kc(),s.lc(7,"div"),s.bd(8),s.yc(9,"localeCurrency"),s.kc(),s.kc(),s.kc()),2&e){var n=s.xc(2).ngIf,c=s.xc();s.Tb(1),s.Ec("ngIf",c.addItemSelectedVariant.productAsset),s.Tb(3),s.cd(c.addItemSelectedVariant.productVariantName),s.Tb(2),s.cd(c.addItemSelectedVariant.sku),s.Tb(2),s.dd(" ",s.Ac(9,4,c.getSelectedItemPrice(c.addItemSelectedVariant),n.currencyCode)," ")}}function Ht(e,t){if(1&e&&(s.jc(0),s.gc(1,"vdr-custom-field-control",59),s.ic()),2&e){var n=t.$implicit,c=s.xc(3);s.Tb(1),s.Ec("readonly",!c.addItemSelectedVariant)("customField",n)("customFieldsFormGroup",c.addItemCustomFieldsForm)("compact",!0)}}function Ut(e,t){if(1&e){var n=s.mc();s.lc(0,"clr-accordion-content"),s.lc(1,"vdr-product-selector",52),s.vc("productSelected",function(e){return s.Sc(n),s.xc(2).addItemSelectedVariant=e}),s.kc(),s.Zc(2,Qt,10,7,"div",53),s.Zc(3,Ht,2,4,"ng-container",43),s.lc(4,"button",54),s.vc("click",function(){s.Sc(n);var e=s.xc(2);return e.addItemToOrder(e.addItemSelectedVariant)}),s.bd(5),s.yc(6,"translate"),s.kc(),s.kc()}if(2&e){var c=s.xc(2);s.Tb(2),s.Ec("ngIf",c.addItemSelectedVariant),s.Tb(1),s.Ec("ngForOf",c.orderLineCustomFields),s.Tb(1),s.Ec("disabled",!c.addItemSelectedVariant||c.addItemCustomFieldsForm.invalid),s.Tb(1),s.dd(" ",s.zc(6,4,"order.add-item-to-order")," ")}}var Gt=function(e){return{rate:e}};function Bt(e,t){if(1&e){var n=s.mc();s.lc(0,"clr-accordion-content"),s.lc(1,"form",60),s.vc("submit",function(){s.Sc(n);var e=s.xc(2);return e.addSurcharge(e.surchargeForm.value)}),s.lc(2,"vdr-form-field",61),s.yc(3,"translate"),s.gc(4,"input",62),s.kc(),s.lc(5,"vdr-form-field",63),s.yc(6,"translate"),s.gc(7,"input",64),s.kc(),s.lc(8,"vdr-form-field",65),s.yc(9,"translate"),s.gc(10,"vdr-currency-input",66),s.kc(),s.lc(11,"vdr-form-field",67),s.yc(12,"translate"),s.gc(13,"input",68),s.kc(),s.lc(14,"vdr-form-field",69),s.yc(15,"translate"),s.lc(16,"vdr-affixed-input",70),s.gc(17,"input",71),s.kc(),s.kc(),s.lc(18,"vdr-form-field",72),s.yc(19,"translate"),s.gc(20,"input",73),s.kc(),s.lc(21,"button",74),s.bd(22),s.yc(23,"translate"),s.kc(),s.kc(),s.kc()}if(2&e){var c,r=s.xc().ngIf,i=s.xc(),o=null;s.Tb(1),s.Ec("formGroup",i.surchargeForm),s.Tb(1),s.Ec("label",s.zc(3,10,"common.description")),s.Tb(3),s.Ec("label",s.zc(6,12,"order.product-sku")),s.Tb(3),s.Ec("label",s.zc(9,14,"common.price")),s.Tb(2),s.Ec("currencyCode",r.currencyCode),s.Tb(1),s.Ec("label",s.Ac(12,16,"catalog.price-includes-tax-at",s.Ic(25,Gt,null==(c=i.surchargeForm.get("taxRate"))?null:c.value))),s.Tb(3),s.Ec("label",s.zc(15,19,"order.tax-rate")),s.Tb(4),s.Ec("label",s.zc(19,21,"order.tax-description")),s.Tb(3),s.Ec("disabled",i.surchargeForm.invalid||i.surchargeForm.pristine||0===(null==(o=i.surchargeForm.get("price"))?null:o.value)),s.Tb(1),s.dd(" ",s.zc(23,23,"order.add-surcharge")," ")}}function Jt(e,t){if(1&e&&(s.lc(0,"clr-accordion-content"),s.gc(1,"vdr-address-form",75),s.yc(2,"async"),s.kc()),2&e){var n=s.xc(2);s.Tb(1),s.Ec("formGroup",n.shippingAddressForm)("availableCountries",s.zc(2,3,n.availableCountries$))("customFields",n.addressCustomFields)}}function Xt(e,t){if(1&e&&(s.lc(0,"clr-accordion-content"),s.gc(1,"vdr-address-form",75),s.yc(2,"async"),s.kc()),2&e){var n=s.xc(2);s.Tb(1),s.Ec("formGroup",n.billingAddressForm)("availableCountries",s.zc(2,3,n.availableCountries$))("customFields",n.addressCustomFields)}}function Yt(e,t){if(1&e&&(s.lc(0,"li"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e){var n=s.xc(2);s.Tb(1),s.dd(" ",s.Ac(2,1,"order.modification-adding-items",s.Ic(4,Ie,null==n.modifyOrderInput.addItems?null:n.modifyOrderInput.addItems.length))," ")}}function Kt(e,t){if(1&e&&(s.lc(0,"li"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e){var n=s.xc(2);s.Tb(1),s.dd(" ",s.Ac(2,1,"order.modification-adjusting-lines",s.Ic(4,Ie,null==n.modifyOrderInput.adjustOrderLines?null:n.modifyOrderInput.adjustOrderLines.length))," ")}}function en(e,t){if(1&e&&(s.lc(0,"li"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e){var n=s.xc(2);s.Tb(1),s.dd(" ",s.Ac(2,1,"order.modification-adding-surcharges",s.Ic(4,Ie,null==n.modifyOrderInput.surcharges?null:n.modifyOrderInput.surcharges.length))," ")}}function tn(e,t){1&e&&(s.lc(0,"li"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.modification-updating-shipping-address")," "))}function nn(e,t){1&e&&(s.lc(0,"li"),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.modification-updating-billing-address")," "))}function cn(e,t){if(1&e){var n=s.mc();s.lc(0,"div"),s.lc(1,"div",5),s.lc(2,"div",6),s.lc(3,"table",7),s.lc(4,"thead"),s.lc(5,"tr"),s.gc(6,"th"),s.lc(7,"th"),s.bd(8),s.yc(9,"translate"),s.kc(),s.lc(10,"th"),s.bd(11),s.yc(12,"translate"),s.kc(),s.lc(13,"th"),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"th"),s.bd(17),s.yc(18,"translate"),s.kc(),s.Zc(19,Pt,3,3,"th",0),s.lc(20,"th"),s.bd(21),s.yc(22,"translate"),s.kc(),s.kc(),s.kc(),s.lc(23,"tbody"),s.Zc(24,_t,26,35,"tr",8),s.Zc(25,Dt,26,27,"tr",9),s.Zc(26,Rt,15,14,"tr",10),s.Zc(27,qt,12,4,"tr",11),s.lc(28,"tr",12),s.lc(29,"td",13),s.bd(30),s.yc(31,"translate"),s.kc(),s.lc(32,"td",14),s.bd(33),s.kc(),s.gc(34,"td",15),s.Zc(35,Vt,1,0,"td",0),s.lc(36,"td",14),s.bd(37),s.yc(38,"localeCurrency"),s.lc(39,"div",16),s.yc(40,"translate"),s.bd(41),s.yc(42,"localeCurrency"),s.kc(),s.kc(),s.kc(),s.kc(),s.kc(),s.lc(43,"h4",17),s.bd(44),s.yc(45,"translate"),s.kc(),s.lc(46,"clr-accordion"),s.lc(47,"clr-accordion-panel"),s.lc(48,"clr-accordion-title"),s.bd(49),s.yc(50,"translate"),s.kc(),s.Zc(51,Ut,7,6,"clr-accordion-content",18),s.kc(),s.lc(52,"clr-accordion-panel"),s.lc(53,"clr-accordion-title"),s.bd(54),s.yc(55,"translate"),s.kc(),s.Zc(56,Bt,24,27,"clr-accordion-content",18),s.kc(),s.lc(57,"clr-accordion-panel"),s.lc(58,"clr-accordion-title"),s.bd(59),s.yc(60,"translate"),s.kc(),s.Zc(61,Jt,3,5,"clr-accordion-content",18),s.kc(),s.lc(62,"clr-accordion-panel"),s.lc(63,"clr-accordion-title"),s.bd(64),s.yc(65,"translate"),s.kc(),s.Zc(66,Xt,3,5,"clr-accordion-content",18),s.kc(),s.kc(),s.kc(),s.lc(67,"div",19),s.lc(68,"div",20),s.lc(69,"div",21),s.bd(70),s.yc(71,"translate"),s.kc(),s.lc(72,"div",22),s.lc(73,"ul"),s.Zc(74,Yt,3,6,"li",0),s.Zc(75,Kt,3,6,"li",0),s.Zc(76,en,3,6,"li",0),s.Zc(77,tn,3,3,"li",0),s.Zc(78,nn,3,3,"li",0),s.kc(),s.kc(),s.lc(79,"div",22),s.lc(80,"label",23),s.bd(81),s.yc(82,"translate"),s.kc(),s.lc(83,"textarea",24),s.vc("ngModelChange",function(e){return s.Sc(n),s.xc().note=e}),s.kc(),s.lc(84,"clr-checkbox-wrapper",25),s.lc(85,"input",26),s.vc("ngModelChange",function(e){return s.Sc(n),s.xc().recalculateShipping=e}),s.kc(),s.lc(86,"label"),s.bd(87),s.yc(88,"translate"),s.kc(),s.kc(),s.kc(),s.lc(89,"div",27),s.lc(90,"button",28),s.vc("click",function(){s.Sc(n);var e=t.ngIf;return s.xc().previewAndModify(e)}),s.bd(91),s.yc(92,"translate"),s.kc(),s.kc(),s.kc(),s.kc(),s.kc(),s.kc()}if(2&e){var c=t.ngIf,r=s.xc();s.Tb(8),s.cd(s.zc(9,34,"order.product-name")),s.Tb(3),s.cd(s.zc(12,36,"order.product-sku")),s.Tb(3),s.cd(s.zc(15,38,"order.unit-price")),s.Tb(3),s.cd(s.zc(18,40,"order.quantity")),s.Tb(2),s.Ec("ngIf",r.orderLineCustomFields.length),s.Tb(2),s.cd(s.zc(22,42,"order.total")),s.Tb(3),s.Ec("ngForOf",c.lines),s.Tb(1),s.Ec("ngForOf",r.addedLines)("ngForTrackBy",r.trackByProductVariantId),s.Tb(1),s.Ec("ngForOf",c.surcharges),s.Tb(1),s.Ec("ngForOf",r.modifyOrderInput.surcharges),s.Tb(3),s.cd(s.zc(31,44,"order.shipping")),s.Tb(3),s.cd(null==c.shippingLines[0]||null==c.shippingLines[0].shippingMethod?null:c.shippingLines[0].shippingMethod.name),s.Tb(2),s.Ec("ngIf",r.orderLineCustomFields.length),s.Tb(2),s.dd(" ",s.Ac(38,46,c.shippingWithTax,c.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(40,49,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(42,51,c.shipping,c.currencyCode)," "),s.Tb(3),s.cd(s.zc(45,54,"order.modifications")),s.Tb(5),s.cd(s.zc(50,56,"order.add-item-to-order")),s.Tb(5),s.cd(s.zc(55,58,"order.add-surcharge")),s.Tb(5),s.cd(s.zc(60,60,"order.edit-shipping-address")),s.Tb(5),s.cd(s.zc(65,62,"order.edit-billing-address")),s.Tb(6),s.dd(" ",s.zc(71,64,"order.modification-summary")," "),s.Tb(4),s.Ec("ngIf",null==r.modifyOrderInput.addItems?null:r.modifyOrderInput.addItems.length),s.Tb(1),s.Ec("ngIf",null==r.modifyOrderInput.adjustOrderLines?null:r.modifyOrderInput.adjustOrderLines.length),s.Tb(1),s.Ec("ngIf",null==r.modifyOrderInput.surcharges?null:r.modifyOrderInput.surcharges.length),s.Tb(1),s.Ec("ngIf",r.shippingAddressForm.dirty),s.Tb(1),s.Ec("ngIf",r.billingAddressForm.dirty),s.Tb(3),s.cd(s.zc(82,66,"order.note")),s.Tb(2),s.Ec("ngModel",r.note),s.Tb(2),s.Ec("ngModel",r.recalculateShipping),s.Tb(2),s.cd(s.zc(88,68,"order.modification-recalculate-shipping")),s.Tb(3),s.Ec("disabled",!r.canPreviewChanges()),s.Tb(1),s.dd(" ",s.zc(92,70,"order.preview-changes")," ")}}function rn(e,t){1&e&&(s.lc(0,"span",12),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.note-only-visible-to-administrators")," "))}function on(e,t){1&e&&(s.lc(0,"span",13),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.note-visible-to-customer")," "))}function an(e,t){1&e&&(s.lc(0,"div",11),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.history-order-fulfilled")," "))}function ln(e,t){1&e&&(s.lc(0,"div",11),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.history-order-cancelled")," "))}var dn=function(e,t){return{from:e,to:t}};function sn(e,t){if(1&e&&(s.bd(0),s.yc(1,"translate")),2&e){var n=s.xc(2).$implicit;s.dd(" ",s.Ac(1,1,"order.history-order-transition",s.Jc(4,dn,n.data.from,n.data.to))," ")}}function un(e,t){if(1&e&&(s.jc(0),s.Zc(1,an,3,3,"div",17),s.Zc(2,ln,3,3,"div",17),s.Zc(3,sn,2,7,"ng-template",18),s.ic()),2&e){var n=s.xc().$implicit;s.Tb(1),s.Ec("ngIf","Delivered"===n.data.to),s.Tb(1),s.Ec("ngIf","Cancelled"===n.data.to),s.Tb(1),s.Ec("ngIf","Cancelled"!==n.data.to&&"Delivered"!==n.data.to)}}function fn(e,t){1&e&&(s.lc(0,"vdr-chip",23),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.cd(s.zc(2,1,"order.modification-settled")))}function mn(e,t){1&e&&(s.lc(0,"vdr-chip",24),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.cd(s.zc(2,1,"order.modification-not-settled")))}function bn(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.lc(3,"strong"),s.bd(4),s.yc(5,"localeCurrency"),s.kc(),s.Zc(6,fn,3,3,"vdr-chip",20),s.Zc(7,mn,3,3,"vdr-chip",21),s.lc(8,"vdr-history-entry-detail"),s.gc(9,"vdr-modification-detail",22),s.kc(),s.ic()),2&e){var n=t.ngIf,c=s.xc(3);s.Tb(1),s.dd(" ",s.zc(2,6,"order.modify-order-price-difference"),": "),s.Tb(3),s.cd(s.Ac(5,8,n.priceChange,c.order.currencyCode)),s.Tb(2),s.Ec("ngIf",n.isSettled),s.Tb(1),s.Ec("ngIf",!n.isSettled),s.Tb(2),s.Ec("order",c.order)("modification",n)}}function pn(e,t){if(1&e&&(s.jc(0),s.lc(1,"div",11),s.bd(2),s.yc(3,"translate"),s.kc(),s.Zc(4,bn,10,11,"ng-container",19),s.ic()),2&e){var n=s.xc().$implicit,c=s.xc();s.Tb(2),s.dd(" ",s.zc(3,2,"order.history-order-modified")," "),s.Tb(2),s.Ec("ngIf",c.getModification(n.data.modificationId))}}function gn(e,t){if(1&e&&(s.lc(0,"vdr-history-entry-detail"),s.gc(1,"vdr-payment-detail",27),s.kc()),2&e){var n=t.ngIf,c=s.xc(4);s.Tb(1),s.Ec("payment",n)("currencyCode",c.order.currencyCode)}}function yn(e,t){if(1&e&&(s.jc(0),s.lc(1,"div",11),s.bd(2),s.yc(3,"translate"),s.kc(),s.bd(4),s.yc(5,"translate"),s.Zc(6,gn,2,2,"vdr-history-entry-detail",19),s.ic()),2&e){var n,c=s.xc(2).$implicit,r=s.xc();s.Tb(2),s.dd(" ",s.zc(3,4,"order.history-payment-settled")," "),s.Tb(2),s.ed(" ",s.zc(5,6,"order.transaction-id"),": ",null==(n=r.getPayment(c))?null:n.transactionId," "),s.Tb(2),s.Ec("ngIf",r.getPayment(c))}}var vn=function(e,t,n){return{from:e,to:t,id:n}};function hn(e,t){if(1&e&&(s.bd(0),s.yc(1,"translate")),2&e){var n,c=s.xc(2).$implicit,r=s.xc();s.dd(" ",s.Ac(1,1,"order.history-payment-transition",s.Kc(4,vn,c.data.from,c.data.to,null==(n=r.getPayment(c))?null:n.transactionId))," ")}}function kn(e,t){if(1&e&&(s.jc(0),s.Zc(1,yn,7,8,"ng-container",25),s.Zc(2,hn,2,8,"ng-template",null,26,s.ad),s.ic()),2&e){var n=s.Oc(3),c=s.xc().$implicit;s.Tb(1),s.Ec("ngIf","Settled"===c.data.to)("ngIfElse",n)}}function Tn(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.ic()),2&e){var n=s.xc().$implicit;s.Tb(1),s.dd(" ",s.Ac(2,1,"order.history-refund-transition",s.Kc(4,vn,n.data.from,n.data.to,n.data.refundId))," ")}}function Cn(e,t){if(1&e&&(s.lc(0,"vdr-history-entry-detail"),s.lc(1,"vdr-labeled-data",28),s.yc(2,"translate"),s.bd(3),s.kc(),s.lc(4,"vdr-labeled-data",28),s.yc(5,"translate"),s.gc(6,"vdr-simple-item-list",29),s.kc(),s.kc()),2&e){var n=t.ngIf,c=s.xc(2).$implicit;s.Tb(1),s.Ec("label",s.zc(2,4,"order.cancellation-reason")),s.Tb(2),s.dd(" ",c.data.reason," "),s.Tb(1),s.Ec("label",s.zc(5,6,"order.contents")),s.Tb(2),s.Ec("items",n)}}function On(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.Zc(3,Cn,7,8,"vdr-history-entry-detail",19),s.ic()),2&e){var n=s.xc().$implicit,c=s.xc();s.Tb(1),s.dd(" ",s.Ac(2,2,"order.history-items-cancelled",s.Ic(5,Ie,n.data.orderItemIds.length))," "),s.Tb(2),s.Ec("ngIf",c.getCancelledItems(n))}}function xn(e,t){if(1&e&&(s.lc(0,"vdr-history-entry-detail"),s.gc(1,"vdr-fulfillment-detail",30),s.kc()),2&e){var n=t.ngIf,c=s.xc(3);s.Tb(1),s.Ec("fulfillmentId",n.id)("order",c.order)}}function In(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.Zc(3,xn,2,2,"vdr-history-entry-detail",19),s.ic()),2&e){var n=s.xc().$implicit,c=s.xc();s.Tb(1),s.dd(" ",s.zc(2,2,"order.history-fulfillment-created")," "),s.Tb(2),s.Ec("ngIf",c.getFulfillment(n))}}function Sn(e,t){if(1&e&&(s.jc(0),s.lc(1,"div",11),s.bd(2),s.yc(3,"translate"),s.kc(),s.bd(4),s.yc(5,"translate"),s.ic()),2&e){var n,c=s.xc(2).$implicit,r=s.xc();s.Tb(2),s.dd(" ",s.zc(3,3,"order.history-fulfillment-delivered")," "),s.Tb(2),s.ed(" ",s.zc(5,5,"order.tracking-code"),": ",null==(n=r.getFulfillment(c))?null:n.trackingCode," ")}}function En(e,t){if(1&e&&(s.jc(0),s.lc(1,"div",11),s.bd(2),s.yc(3,"translate"),s.kc(),s.bd(4),s.yc(5,"translate"),s.ic()),2&e){var n,c=s.xc(2).$implicit,r=s.xc();s.Tb(2),s.dd(" ",s.zc(3,3,"order.history-fulfillment-shipped")," "),s.Tb(2),s.ed(" ",s.zc(5,5,"order.tracking-code"),": ",null==(n=r.getFulfillment(c))?null:n.trackingCode," ")}}function Pn(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.ic()),2&e){var n=s.xc(2).$implicit;s.Tb(1),s.dd(" ",s.Ac(2,1,"order.history-fulfillment-transition",s.Jc(4,dn,n.data.from,n.data.to))," ")}}function Mn(e,t){if(1&e&&(s.lc(0,"vdr-history-entry-detail"),s.gc(1,"vdr-fulfillment-detail",30),s.kc()),2&e){var n=t.ngIf,c=s.xc(3);s.Tb(1),s.Ec("fulfillmentId",n.id)("order",c.order)}}function Fn(e,t){if(1&e&&(s.jc(0),s.Zc(1,Sn,6,7,"ng-container",19),s.Zc(2,En,6,7,"ng-container",19),s.Zc(3,Pn,3,7,"ng-container",19),s.Zc(4,Mn,2,2,"vdr-history-entry-detail",19),s.ic()),2&e){var n=s.xc().$implicit,c=s.xc();s.Tb(1),s.Ec("ngIf","Delivered"===n.data.to),s.Tb(1),s.Ec("ngIf","Shipped"===n.data.to),s.Tb(1),s.Ec("ngIf","Delivered"!==n.data.to&&"Shipped"!==n.data.to),s.Tb(1),s.Ec("ngIf",c.getFulfillment(n))}}function wn(e,t){1&e&&(s.lc(0,"span",43),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.cd(s.zc(2,1,"common.public")))}function An(e,t){1&e&&(s.lc(0,"span",44),s.bd(1),s.yc(2,"translate"),s.kc()),2&e&&(s.Tb(1),s.cd(s.zc(2,1,"common.private")))}function _n(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"div",31),s.lc(2,"div",32),s.Zc(3,wn,3,3,"span",33),s.Zc(4,An,3,3,"span",34),s.bd(5),s.kc(),s.gc(6,"div",35),s.lc(7,"vdr-dropdown"),s.lc(8,"button",36),s.gc(9,"clr-icon",37),s.kc(),s.lc(10,"vdr-dropdown-menu",38),s.lc(11,"button",39),s.vc("click",function(){s.Sc(n);var e=s.xc().$implicit;return s.xc().updateNote.emit(e)}),s.yc(12,"hasPermission"),s.gc(13,"clr-icon",40),s.bd(14),s.yc(15,"translate"),s.kc(),s.gc(16,"div",41),s.lc(17,"button",39),s.vc("click",function(){s.Sc(n);var e=s.xc().$implicit;return s.xc().deleteNote.emit(e)}),s.yc(18,"hasPermission"),s.gc(19,"clr-icon",42),s.bd(20),s.yc(21,"translate"),s.kc(),s.kc(),s.kc(),s.kc(),s.ic()}if(2&e){var c=s.xc().$implicit;s.Tb(3),s.Ec("ngIf",c.isPublic),s.Tb(1),s.Ec("ngIf",!c.isPublic),s.Tb(1),s.dd(" ",c.data.note," "),s.Tb(6),s.Ec("disabled",!s.zc(12,7,"UpdateOrder")),s.Tb(3),s.dd(" ",s.zc(15,9,"common.edit")," "),s.Tb(3),s.Ec("disabled",!s.zc(18,11,"UpdateOrder")),s.Tb(3),s.dd(" ",s.zc(21,13,"common.delete")," ")}}var zn=function(e){return["/marketing","promotions",e]};function jn(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.lc(3,"vdr-chip"),s.lc(4,"a",45),s.bd(5),s.kc(),s.kc(),s.ic()),2&e){var n=s.xc().$implicit;s.Tb(1),s.dd(" ",s.zc(2,3,"order.history-coupon-code-applied"),": "),s.Tb(3),s.Ec("routerLink",s.Ic(5,zn,n.data.promotionId)),s.Tb(1),s.cd(n.data.couponCode)}}function Zn(e,t){if(1&e&&(s.jc(0),s.bd(1),s.yc(2,"translate"),s.lc(3,"vdr-chip"),s.lc(4,"span",46),s.bd(5),s.kc(),s.kc(),s.ic()),2&e){var n=s.xc().$implicit;s.Tb(1),s.dd(" ",s.zc(2,2,"order.history-coupon-code-removed"),": "),s.Tb(4),s.cd(n.data.couponCode)}}function Dn(e,t){if(1&e){var n=s.mc();s.lc(0,"vdr-timeline-entry",14),s.vc("expandClick",function(){s.Sc(n);var e=s.xc();return e.expanded=!e.expanded}),s.jc(1,15),s.Zc(2,un,4,3,"ng-container",16),s.Zc(3,pn,5,4,"ng-container",16),s.Zc(4,kn,4,2,"ng-container",16),s.Zc(5,Tn,3,8,"ng-container",16),s.Zc(6,On,4,7,"ng-container",16),s.Zc(7,In,4,4,"ng-container",16),s.Zc(8,Fn,5,4,"ng-container",16),s.Zc(9,_n,22,15,"ng-container",16),s.Zc(10,jn,6,7,"ng-container",16),s.Zc(11,Zn,6,4,"ng-container",16),s.ic(),s.kc()}if(2&e){var c=t.$implicit,r=s.xc();s.Ec("displayType",r.getDisplayType(c))("iconShape",r.getTimelineIcon(c))("createdAt",c.createdAt)("name",r.getName(c))("featured",r.isFeatured(c))("collapsed",!r.expanded&&!r.isFeatured(c)),s.Tb(1),s.Ec("ngSwitch",c.type),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_STATE_TRANSITION),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_MODIFIED),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_PAYMENT_TRANSITION),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_REFUND_TRANSITION),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_CANCELLATION),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_FULFILLMENT),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_FULFILLMENT_TRANSITION),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_NOTE),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_COUPON_APPLIED),s.Tb(1),s.Ec("ngSwitchCase",r.type.ORDER_COUPON_REMOVED)}}function Ln(e,t){if(1&e){var n=s.mc();s.lc(0,"button",18),s.vc("click",function(){s.Sc(n);var e=t.$implicit;return s.xc(2).selectFilterPreset(e.name)}),s.bd(1),s.yc(2,"translate"),s.kc()}if(2&e){var c=t.$implicit,r=s.xc().ngIf;s.Xb("btn-primary",r===c.name),s.Tb(1),s.dd(" ",s.zc(2,3,c.label)," ")}}function Rn(e,t){if(1&e){var n=s.mc();s.lc(0,"div",16),s.Zc(1,Ln,3,5,"button",17),s.lc(2,"button",18),s.vc("click",function(){return s.Sc(n),s.xc().selectFilterPreset("custom")}),s.bd(3),s.yc(4,"translate"),s.gc(5,"clr-icon",19),s.kc(),s.kc()}if(2&e){var c=t.ngIf,r=s.xc();s.Tb(1),s.Ec("ngForOf",r.filterPresets),s.Tb(1),s.Xb("btn-primary","custom"===c),s.Tb(1),s.dd(" ",s.zc(4,4,"order.filter-custom")," ")}}function Nn(e,t){if(1&e&&(s.bd(0),s.yc(1,"translate"),s.yc(2,"stateI18nToken")),2&e){var n=t.item;s.cd(s.zc(1,1,s.zc(2,3,n)))}}function $n(e,t){if(1&e&&(s.lc(0,"span",20),s.bd(1),s.yc(2,"translate"),s.yc(3,"stateI18nToken"),s.kc(),s.lc(4,"span",21),s.vc("click",function(){var e=t.item;return(0,t.clear)(e)}),s.bd(5,"\xd7"),s.kc()),2&e){var n=t.item;s.Tb(1),s.dd(" ",s.zc(2,1,s.zc(3,3,n)),"")}}var qn=function(e){return["./",e,"modify"]},Vn=function(e){return["./",e]};function Wn(e,t){if(1&e&&(s.lc(0,"td",22),s.bd(1),s.kc(),s.lc(2,"td",22),s.gc(3,"vdr-customer-label",23),s.kc(),s.lc(4,"td",22),s.gc(5,"vdr-order-state-label",24),s.kc(),s.lc(6,"td",22),s.bd(7),s.yc(8,"localeCurrency"),s.kc(),s.lc(9,"td",22),s.bd(10),s.yc(11,"timeAgo"),s.kc(),s.lc(12,"td",22),s.bd(13),s.yc(14,"localeDate"),s.kc(),s.lc(15,"td",22),s.bd(16),s.kc(),s.lc(17,"td",25),s.gc(18,"vdr-table-row-action",26),s.yc(19,"translate"),s.kc()),2&e){var n=t.item,c=s.xc();s.Tb(1),s.cd(n.code),s.Tb(2),s.Ec("customer",n.customer),s.Tb(2),s.Ec("state",n.state),s.Tb(2),s.cd(s.Ac(8,9,n.total,n.currencyCode)),s.Tb(3),s.cd(s.zc(11,12,n.updatedAt)),s.Tb(3),s.cd(s.Ac(14,14,n.orderPlacedAt,"medium")),s.Tb(3),s.cd(c.getShippingNames(n)),s.Tb(2),s.Ec("label",s.zc(19,17,"common.open"))("linkTo","Modifying"===n.state?s.Ic(19,qn,n.id):s.Ic(21,Vn,n.id))}}function Qn(e,t){if(1&e&&(s.jc(0),s.bd(1),s.ic()),2&e){var n=s.xc();s.Tb(1),s.dd("#",n.payment.transactionId,"")}}function Hn(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",11),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc().$implicit;s.Ec("label",s.zc(1,2,"order.transaction-id")),s.Tb(2),s.dd(" ",n.transactionId," ")}}function Un(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",11),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc().$implicit;s.Ec("label",s.zc(1,2,"order.refund-reason")),s.Tb(2),s.dd(" ",n.reason," ")}}function Gn(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",11),s.yc(1,"translate"),s.gc(2,"vdr-object-tree",13),s.kc()),2&e){var n=s.xc().$implicit;s.Ec("label",s.zc(1,2,"order.refund-metadata")),s.Tb(2),s.Ec("value",n.metadata)}}function Bn(e,t){if(1&e){var n=s.mc();s.lc(0,"div",14),s.lc(1,"button",15),s.vc("click",function(){s.Sc(n);var e=s.xc().$implicit;return s.xc().settleRefund.emit(e)}),s.bd(2),s.yc(3,"translate"),s.kc(),s.kc()}2&e&&(s.Tb(2),s.dd(" ",s.zc(3,1,"order.settle-refund")," "))}function Jn(e,t){if(1&e&&(s.jc(0),s.lc(1,"div",1),s.gc(2,"clr-icon",9),s.bd(3),s.yc(4,"translate"),s.gc(5,"div",10),s.gc(6,"vdr-refund-state-label",4),s.kc(),s.lc(7,"div",5),s.lc(8,"vdr-labeled-data",11),s.yc(9,"translate"),s.bd(10),s.yc(11,"localeDate"),s.kc(),s.lc(12,"vdr-labeled-data",11),s.yc(13,"translate"),s.bd(14),s.yc(15,"localeCurrency"),s.kc(),s.Zc(16,Hn,3,4,"vdr-labeled-data",12),s.Zc(17,Un,3,4,"vdr-labeled-data",12),s.Zc(18,Gn,3,4,"vdr-labeled-data",12),s.kc(),s.Zc(19,Bn,4,3,"div",8),s.ic()),2&e){var n=t.$implicit,c=s.xc();s.Tb(3),s.ed(" ",s.zc(4,11,"order.refund")," #",n.id," "),s.Tb(3),s.Ec("state",n.state),s.Tb(2),s.Ec("label",s.zc(9,13,"common.created-at")),s.Tb(2),s.dd(" ",s.Ac(11,15,n.createdAt,"medium")," "),s.Tb(2),s.Ec("label",s.zc(13,18,"order.refund-total")),s.Tb(2),s.dd(" ",s.Ac(15,20,n.total,c.currencyCode)," "),s.Tb(2),s.Ec("ngIf",n.transactionId),s.Tb(1),s.Ec("ngIf",n.reason),s.Tb(1),s.Ec("ngIf",c.refundHasMetadata(n)),s.Tb(1),s.Ec("ngIf","Pending"===n.state)}}function Xn(e,t){if(1&e){var n=s.mc();s.lc(0,"button",15),s.vc("click",function(){s.Sc(n);var e=s.xc(2);return e.settlePayment.emit(e.payment)}),s.bd(1),s.yc(2,"translate"),s.kc()}2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.settle-payment")," "))}function Yn(e,t){if(1&e&&(s.jc(0),s.gc(1,"clr-icon",23),s.bd(2),s.yc(3,"translate"),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.ic()),2&e){var n=s.xc().$implicit;s.Tb(2),s.dd(" ",s.Ac(3,1,"order.transition-to-state",s.Ic(8,ae,s.zc(4,4,s.zc(5,6,n))))," ")}}function Kn(e,t){1&e&&(s.gc(0,"clr-icon",24),s.bd(1),s.yc(2,"translate")),2&e&&(s.Tb(1),s.dd(" ",s.zc(2,1,"order.cancel-payment")," "))}function ec(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"button",20),s.vc("click",function(){s.Sc(n);var e=t.$implicit,c=s.xc(2);return c.transitionPaymentState.emit({payment:c.payment,state:e})}),s.Zc(2,Yn,6,10,"ng-container",21),s.Zc(3,Kn,3,3,"ng-template",null,22,s.ad),s.kc(),s.ic()}if(2&e){var c=t.$implicit,r=s.Oc(4);s.Tb(2),s.Ec("ngIf","Cancelled"!==c)("ngIfElse",r)}}function tc(e,t){if(1&e&&(s.lc(0,"div",14),s.Zc(1,Xn,3,3,"button",16),s.lc(2,"vdr-dropdown"),s.lc(3,"button",17),s.gc(4,"clr-icon",18),s.kc(),s.lc(5,"vdr-dropdown-menu",19),s.Zc(6,ec,5,2,"ng-container",7),s.kc(),s.kc(),s.kc()),2&e){var n=s.xc();s.Tb(1),s.Ec("ngIf",n.payment.nextStates.includes("Settled")),s.Tb(5),s.Ec("ngForOf",n.nextOtherStates())}}function nc(e,t){if(1&e&&(s.lc(0,"div",3),s.gc(1,"div",4),s.gc(2,"clr-icon",5),s.lc(3,"div",6),s.bd(4),s.yc(5,"translate"),s.yc(6,"stateI18nToken"),s.kc(),s.kc()),2&e){var n=s.xc();s.Tb(4),s.dd(" ",s.zc(5,1,s.zc(6,3,n.cancelledState))," ")}}function cc(e,t){if(1&e){var n=s.mc();s.jc(0),s.lc(1,"vdr-order-process-node",1),s.vc("mouseenter",function(){s.Sc(n);var e=t.$implicit;return s.xc().onMouseOver(e.name)})("mouseleave",function(){return s.Sc(n),s.xc().onMouseOut()}),s.yc(2,"async"),s.kc(),s.ic()}if(2&e){var c=t.$implicit,r=t.index,i=s.xc();s.Tb(1),s.Ec("node",c)("index",r)("active",s.zc(2,3,i.activeState$)===c.name)}}function rc(e,t){if(1&e&&(s.jc(0),s.gc(1,"vdr-order-process-edge",2),s.ic()),2&e){var n=t.$implicit;s.Tb(1),s.Ec("from",n.from)("to",n.to)("index",n.index)}}function ic(e,t){if(1&e&&(s.gc(0,"img",23),s.yc(1,"assetPreview")),2&e){var n=s.xc().$implicit;s.Ec("src",s.Ac(1,1,n.featuredAsset,"tiny"),s.Uc)}}function oc(e,t){if(1&e&&(s.lc(0,"div",26),s.lc(1,"a",27),s.bd(2),s.kc(),s.lc(3,"div",28),s.bd(4),s.yc(5,"localeCurrency"),s.lc(6,"div",8),s.yc(7,"translate"),s.bd(8),s.yc(9,"localeCurrency"),s.kc(),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc(4);s.Tb(1),s.Ec("routerLink",c.getPromotionLink(n)),s.Tb(1),s.cd(n.description),s.Tb(2),s.dd(" ",s.Ac(5,5,n.amountWithTax,c.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(7,8,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(9,10,n.amount,c.order.currencyCode)," ")}}function ac(e,t){if(1&e&&(s.lc(0,"vdr-dropdown"),s.lc(1,"div",24),s.bd(2),s.yc(3,"translate"),s.kc(),s.lc(4,"vdr-dropdown-menu"),s.Zc(5,oc,10,13,"div",25),s.kc(),s.kc()),2&e){var n=s.xc().ngIf;s.Tb(2),s.dd(" ",s.zc(3,2,"order.promotions-applied")," "),s.Tb(3),s.Ec("ngForOf",n)}}function lc(e,t){if(1&e&&(s.jc(0),s.Zc(1,ac,6,4,"vdr-dropdown",22),s.ic()),2&e){var n=t.ngIf;s.Tb(1),s.Ec("ngIf",n.length)}}function dc(e,t){if(1&e&&(s.lc(0,"div",32),s.gc(1,"vdr-custom-field-control",33),s.kc()),2&e){var n=t.$implicit;s.Tb(1),s.Ec("compact",!0)("readonly",!0)("customField",n.config)("customFieldsFormGroup",n.formGroup)}}function sc(e,t){if(1&e&&(s.lc(0,"tr"),s.lc(1,"td",29),s.lc(2,"div",30),s.Zc(3,dc,2,4,"div",31),s.kc(),s.kc(),s.kc()),2&e){var n=s.xc().ngIf;s.Tb(3),s.Ec("ngForOf",n)}}function uc(e,t){if(1&e&&(s.jc(0),s.Zc(1,sc,4,1,"tr",22),s.ic()),2&e){var n=t.ngIf;s.Tb(1),s.Ec("ngIf",n.length)}}function fc(e,t){if(1&e&&(s.jc(0),s.lc(1,"tr",12),s.lc(2,"td",13),s.Zc(3,ic,2,4,"img",14),s.kc(),s.lc(4,"td",15),s.bd(5),s.kc(),s.lc(6,"td",16),s.bd(7),s.kc(),s.lc(8,"td",17),s.bd(9),s.yc(10,"localeCurrency"),s.lc(11,"div",8),s.yc(12,"translate"),s.bd(13),s.yc(14,"localeCurrency"),s.kc(),s.kc(),s.lc(15,"td",18),s.bd(16),s.gc(17,"vdr-line-refunds",19),s.gc(18,"vdr-line-fulfillment",20),s.kc(),s.lc(19,"td",21),s.bd(20),s.yc(21,"localeCurrency"),s.lc(22,"div",8),s.yc(23,"translate"),s.bd(24),s.yc(25,"localeCurrency"),s.kc(),s.Zc(26,lc,2,1,"ng-container",22),s.kc(),s.kc(),s.Zc(27,uc,2,1,"ng-container",22),s.ic()),2&e){var n=t.$implicit,c=s.xc();s.Tb(1),s.Xb("is-cancelled",0===n.quantity),s.Tb(2),s.Ec("ngIf",n.featuredAsset),s.Tb(2),s.cd(n.productVariant.name),s.Tb(2),s.cd(n.productVariant.sku),s.Tb(2),s.dd(" ",s.Ac(10,18,n.unitPriceWithTax,c.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(12,21,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(14,23,n.unitPrice,c.order.currencyCode)," "),s.Tb(3),s.dd(" ",n.quantity," "),s.Tb(1),s.Ec("line",n)("payments",c.order.payments),s.Tb(1),s.Ec("line",n)("orderState",c.order.state),s.Tb(2),s.dd(" ",s.Ac(21,26,n.linePriceWithTax,c.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(23,29,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(25,31,n.linePrice,c.order.currencyCode)," "),s.Tb(2),s.Ec("ngIf",c.getLineDiscounts(n)),s.Tb(1),s.Ec("ngIf",c.customFieldsForLine[n.id])}}function mc(e,t){if(1&e&&(s.lc(0,"tr",34),s.lc(1,"td",35),s.bd(2),s.kc(),s.lc(3,"td",16),s.bd(4),s.kc(),s.gc(5,"td",36),s.lc(6,"td",21),s.bd(7),s.yc(8,"localeCurrency"),s.lc(9,"div",8),s.yc(10,"translate"),s.bd(11),s.yc(12,"localeCurrency"),s.kc(),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc();s.Tb(2),s.cd(n.description),s.Tb(2),s.cd(n.sku),s.Tb(3),s.dd(" ",s.Ac(8,5,n.priceWithTax,c.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(10,8,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(12,10,n.price,c.order.currencyCode)," ")}}function bc(e,t){if(1&e&&(s.lc(0,"vdr-chip"),s.bd(1),s.kc()),2&e){var n=t.ngIf;s.Tb(1),s.cd(n)}}function pc(e,t){if(1&e&&(s.lc(0,"tr",37),s.lc(1,"td",38),s.lc(2,"a",39),s.bd(3),s.kc(),s.Zc(4,bc,2,1,"vdr-chip",22),s.kc(),s.lc(5,"td",7),s.bd(6),s.yc(7,"localeCurrency"),s.lc(8,"div",8),s.yc(9,"translate"),s.bd(10),s.yc(11,"localeCurrency"),s.kc(),s.kc(),s.kc()),2&e){var n=t.$implicit,c=s.xc();s.Tb(2),s.Ec("routerLink",c.getPromotionLink(n)),s.Tb(1),s.cd(n.description),s.Tb(1),s.Ec("ngIf",c.getCouponCodeForAdjustment(c.order,n)),s.Tb(2),s.dd(" ",s.Ac(7,6,n.amountWithTax,c.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(9,9,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(11,11,n.amount,c.order.currencyCode)," ")}}function gc(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc();s.Ec("label",s.zc(1,2,"order.error-message")),s.Tb(2),s.dd(" ",n.payment.errorMessage,"\n")}}function yc(e,t){if(1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.kc()),2&e){var n=s.xc();s.Ec("label",s.zc(1,2,"order.transaction-id")),s.Tb(2),s.dd(" ",n.payment.transactionId,"\n")}}function vc(e,t){1&e&&s.gc(0,"clr-icon",2)}function hc(e,t){1&e&&s.gc(0,"clr-icon",2)}function kc(e,t){if(1&e&&(s.lc(0,"li",2),s.lc(1,"div",3),s.bd(2),s.kc(),s.gc(3,"clr-icon",4),s.bd(4),s.kc()),2&e){var n=t.$implicit;s.Ec("title",n.name),s.Tb(2),s.cd(n.quantity),s.Tb(2),s.dd(" ",n.name," ")}}var Tc=function(){function e(t){m(this,e),this.dataService=t,this.form=new b.i({method:new b.f("",b.C.required),transactionId:new b.f("",b.C.required)})}return p(e,[{key:"ngOnInit",value:function(){this.paymentMethods$=this.dataService.settings.getPaymentMethods(999).mapSingle(function(e){return e.paymentMethods.items})}},{key:"submit",value:function(){var e=this.form.value;this.resolveWith({method:e.method,transactionId:e.transactionId})}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();Tc.\u0275fac=function(e){return new(e||Tc)(s.fc(g.L))},Tc.\u0275cmp=s.Zb({type:Tc,selectors:[["vdr-add-manual-payment-dialog"]],decls:10,vars:11,consts:[["vdrDialogTitle",""],[3,"formGroup"],["for","method",3,"label"],["bindLabel","code","autofocus","","bindValue","code","formControlName","method",3,"items","addTag"],["for","transactionId",3,"label"],["id","transactionId","type","text","formControlName","transactionId"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Zc(0,H,2,3,"ng-template",0),s.lc(1,"form",1),s.lc(2,"vdr-form-field",2),s.yc(3,"translate"),s.gc(4,"ng-select",3),s.yc(5,"async"),s.kc(),s.lc(6,"vdr-form-field",4),s.yc(7,"translate"),s.gc(8,"input",5),s.kc(),s.kc(),s.Zc(9,U,7,11,"ng-template",6)),2&e&&(s.Tb(1),s.Ec("formGroup",t.form),s.Tb(1),s.Ec("label",s.zc(3,5,"order.payment-method")),s.Tb(2),s.Ec("items",s.zc(5,7,t.paymentMethods$))("addTag",!0),s.Tb(2),s.Ec("label",s.zc(7,9,"order.transaction-id")))},directives:[g.R,b.E,b.q,b.j,g.db,$.a,b.p,b.h,g.eb,b.b,g.Q],pipes:[q.d,V.b,g.zb],styles:[".ng-select[_ngcontent-%COMP%]{min-width:100%}"],changeDetection:0}),Tc.ctorParameters=function(){return[{type:g.L}]};var Cc=function(){function e(t){var n=this;m(this,e),this.i18nService=t,this.lineQuantities={},this.reasons=[Object(y.a)("order.cancel-reason-customer-request"),Object(y.a)("order.cancel-reason-not-available")],this.reasons=this.reasons.map(function(e){return n.i18nService.translate(e)})}return p(e,[{key:"selectionCount",get:function(){return Object.values(this.lineQuantities).reduce(function(e,t){return e+t},0)}},{key:"ngOnInit",value:function(){this.lineQuantities=this.order.lines.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.id,0))},{})}},{key:"select",value:function(){this.resolveWith({orderId:this.order.id,lines:this.getLineInputs(),reason:this.reason})}},{key:"cancel",value:function(){this.resolveWith()}},{key:"getLineInputs",value:function(){if(!this.order.active)return Object.entries(this.lineQuantities).map(function(e){var t=n(e,2);return{orderLineId:t[0],quantity:t[1]}}).filter(function(e){return 0<e.quantity})}}]),e}();Cc.\u0275fac=function(e){return new(e||Cc)(s.fc(g.nb))},Cc.\u0275cmp=s.Zb({type:Cc,selectors:[["vdr-cancel-order-dialog"]],decls:29,vars:22,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-lines"],[1,"table"],["class","order-line",3,"is-cancelled",4,"ngFor","ngForOf"],[1,"cancellation-details"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"items","addTag","ngModel","ngModelChange"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"ngModel","max","ngModelChange",4,"ngIf","ngIfElse"],["nonEditable",""],["type","number","min","0",3,"ngModel","max","ngModelChange"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf"]],template:function(e,t){1&e&&(s.Zc(0,G,2,3,"ng-template",0),s.lc(1,"div",1),s.lc(2,"div",2),s.lc(3,"table",3),s.lc(4,"thead"),s.lc(5,"tr"),s.gc(6,"th"),s.lc(7,"th"),s.bd(8),s.yc(9,"translate"),s.kc(),s.lc(10,"th"),s.bd(11),s.yc(12,"translate"),s.kc(),s.lc(13,"th"),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"th"),s.bd(17),s.yc(18,"translate"),s.kc(),s.lc(19,"th"),s.bd(20),s.yc(21,"translate"),s.kc(),s.kc(),s.kc(),s.Zc(22,X,17,15,"tr",4),s.kc(),s.kc(),s.lc(23,"div",5),s.lc(24,"label",6),s.bd(25),s.yc(26,"translate"),s.kc(),s.lc(27,"ng-select",7),s.vc("ngModelChange",function(e){return t.reason=e}),s.kc(),s.kc(),s.kc(),s.Zc(28,ee,6,6,"ng-template",8)),2&e&&(s.Tb(8),s.cd(s.zc(9,10,"order.product-name")),s.Tb(3),s.cd(s.zc(12,12,"order.product-sku")),s.Tb(3),s.cd(s.zc(15,14,"order.quantity")),s.Tb(3),s.cd(s.zc(18,16,"order.unit-price")),s.Tb(3),s.cd(s.zc(21,18,"order.cancel")),s.Tb(2),s.Ec("ngForOf",t.order.lines),s.Tb(3),s.cd(s.zc(26,20,"order.cancellation-reason")),s.Tb(2),s.Ec("items",t.reasons)("addTag",!0)("ngModel",t.reason))},directives:[g.R,V.n,W.u,$.a,b.p,b.s,g.Q,V.o,g.eb,b.v,b.b],pipes:[q.d,g.r,g.zb],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]   .cancellation-details[_ngcontent-%COMP%]{margin-top:0;margin-left:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-lines[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}.fulfillment-wrapper[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}"],changeDetection:0}),Cc.ctorParameters=function(){return[{type:g.nb}]};var Oc=function(){function e(t,n){m(this,e),this.dataService=t,this.changeDetector=n,this.fulfillmentHandlerControl=new b.f,this.fulfillmentQuantities={}}return p(e,[{key:"ngOnInit",value:function(){var e=this;this.dataService.settings.getGlobalSettings().single$.subscribe(function(t){var n=t.globalSettings;e.fulfillmentQuantities=e.order.lines.reduce(function(t,c){var r=e.getFulfillableCount(c,n.trackInventory);return Object.assign(Object.assign({},t),i({},c.id,{fulfillCount:r,max:r}))},{}),e.changeDetector.markForCheck()}),this.dataService.shippingMethod.getShippingMethodOperations().mapSingle(function(e){return e.fulfillmentHandlers}).subscribe(function(t){e.fulfillmentHandlerDef=t.find(function(t){var n,c;return t.code===(null===(c=null===(n=e.order.shippingLines[0])||void 0===n?void 0:n.shippingMethod)||void 0===c?void 0:c.fulfillmentHandlerCode)})||t[0],e.fulfillmentHandler=Object(g.Yb)(e.fulfillmentHandlerDef),e.fulfillmentHandlerControl.patchValue(e.fulfillmentHandler),e.changeDetector.markForCheck()})}},{key:"getFulfillableCount",value:function(e,t){var n=e.productVariant,c=n.trackInventory,r=n.stockOnHand,i=c===g.hb.INHERIT?t:c===g.hb.TRUE,o=this.getUnfulfilledCount(e);return i?Math.min(o,r):o}},{key:"getUnfulfilledCount",value:function(e){var t=e.items.reduce(function(e,t){return e+(t.fulfillment?1:0)},0);return e.quantity-t}},{key:"canSubmit",value:function(){var e=Object.values(this.fulfillmentQuantities).reduce(function(e,t){return e+t.fulfillCount},0);return Object(g.Zb)(this.fulfillmentHandlerDef,this.fulfillmentHandlerControl.value)&&this.fulfillmentHandlerControl.valid&&0<e}},{key:"select",value:function(){var e=Object.entries(this.fulfillmentQuantities).map(function(e){var t=n(e,2);return{orderLineId:t[0],quantity:t[1].fulfillCount}});this.resolveWith({lines:e,handler:Object(g.lc)(this.fulfillmentHandler,this.fulfillmentHandlerControl.value)})}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();Oc.\u0275fac=function(e){return new(e||Oc)(s.fc(g.L),s.fc(s.k))},Oc.\u0275cmp=s.Zb({type:Oc,selectors:[["vdr-fulfill-order-dialog"]],decls:34,vars:29,consts:[["vdrDialogTitle",""],[1,"fulfillment-wrapper"],[1,"order-table"],[1,"table"],["class","order-line",3,"ignore",4,"ngFor","ngForOf"],[1,"shipping-details"],[3,"address"],[3,"operationDefinition","operation","formControl","removable"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[1,"align-middle","fulfil"],["type","number","min","0",3,"disabled","ngModel","max","ngModelChange",4,"ngIf"],[3,"src"],["type","number","min","0",3,"disabled","ngModel","max","ngModelChange"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Zc(0,te,2,3,"ng-template",0),s.lc(1,"div",1),s.lc(2,"div",2),s.lc(3,"table",3),s.lc(4,"thead"),s.lc(5,"tr"),s.gc(6,"th"),s.lc(7,"th"),s.bd(8),s.yc(9,"translate"),s.kc(),s.lc(10,"th"),s.bd(11),s.yc(12,"translate"),s.kc(),s.lc(13,"th"),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"th"),s.bd(17),s.yc(18,"translate"),s.kc(),s.lc(19,"th"),s.bd(20),s.yc(21,"translate"),s.kc(),s.kc(),s.kc(),s.Zc(22,re,13,8,"tr",4),s.kc(),s.kc(),s.lc(23,"div",5),s.gc(24,"vdr-formatted-address",6),s.lc(25,"h6"),s.bd(26),s.yc(27,"translate"),s.kc(),s.bd(28),s.lc(29,"strong"),s.bd(30),s.yc(31,"localeCurrency"),s.kc(),s.gc(32,"vdr-configurable-input",7),s.kc(),s.kc(),s.Zc(33,ie,6,7,"ng-template",8)),2&e&&(s.Tb(8),s.cd(s.zc(9,14,"order.product-name")),s.Tb(3),s.cd(s.zc(12,16,"order.product-sku")),s.Tb(3),s.cd(s.zc(15,18,"order.unfulfilled")),s.Tb(3),s.cd(s.zc(18,20,"catalog.stock-on-hand")),s.Tb(3),s.cd(s.zc(21,22,"order.fulfill")),s.Tb(2),s.Ec("ngForOf",t.order.lines),s.Tb(2),s.Ec("address",t.order.shippingAddress),s.Tb(2),s.cd(s.zc(27,24,"order.shipping-method")),s.Tb(2),s.dd(" ",null==t.order.shippingLines[0]||null==t.order.shippingLines[0].shippingMethod?null:t.order.shippingLines[0].shippingMethod.name," "),s.Tb(2),s.cd(s.Ac(31,26,t.order.shipping,t.order.currencyCode)),s.Tb(2),s.Ec("operationDefinition",t.fulfillmentHandlerDef)("operation",t.fulfillmentHandler)("formControl",t.fulfillmentHandlerControl)("removable",!1))},directives:[g.R,V.n,g.gb,g.E,b.p,b.g,g.Q,V.o,g.eb,b.v,b.b,b.s],pipes:[q.d,g.zb,g.r],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.fulfillment-wrapper[_ngcontent-%COMP%]{flex:1}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:24px}@media screen and (min-width:768px){.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]{margin-top:0;margin-left:24px;width:250px}}.fulfillment-wrapper[_ngcontent-%COMP%]   .shipping-details[_ngcontent-%COMP%]   clr-input-container[_ngcontent-%COMP%]{margin-top:24px}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.fulfillment-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.fulfillment-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}"],changeDetection:0}),Oc.ctorParameters=function(){return[{type:g.L},{type:s.k}]};var xc=function(){function e(){m(this,e),this.transitionState=new s.u}return p(e,[{key:"nextSuggestedState",value:function(){var e;if(this.fulfillment){var t=this.fulfillment.nextStates,n=function(e){return t.includes(e)?e:t[0]};switch(null===(e=this.fulfillment)||void 0===e?void 0:e.state){case"Pending":return n("Shipped");case"Shipped":return n("Delivered");default:return t.find(function(e){return"Cancelled"!==e})}}}},{key:"nextOtherStates",value:function(){if(!this.fulfillment)return[];var e=this.nextSuggestedState();return this.fulfillment.nextStates.filter(function(t){return t!==e})}}]),e}();xc.\u0275fac=function(e){return new(e||xc)},xc.\u0275cmp=s.Zb({type:xc,selectors:[["vdr-fulfillment-card"]],inputs:{fulfillment:"fulfillment",order:"order"},outputs:{transitionState:"transitionState"},decls:10,vars:6,consts:[[1,"card"],[1,"card-header","fulfillment-header"],[1,"fulfillment-state"],[3,"state"],[1,"card-block"],[3,"fulfillmentId","order",4,"ngIf"],["class","card-footer",4,"ngIf"],[3,"fulfillmentId","order"],[1,"card-footer"],[4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-primary",3,"click"],["type","button","vdrDropdownItem","",1,"btn",3,"click"],[4,"ngIf","ngIfElse"],["cancel",""],["shape","step-forward-2"],["shape","error-standard",1,"is-error"]],template:function(e,t){1&e&&(s.lc(0,"div",0),s.lc(1,"div",1),s.lc(2,"div"),s.bd(3),s.yc(4,"translate"),s.kc(),s.lc(5,"div",2),s.gc(6,"vdr-fulfillment-state-label",3),s.kc(),s.kc(),s.lc(7,"div",4),s.Zc(8,oe,1,2,"vdr-fulfillment-detail",5),s.kc(),s.Zc(9,fe,7,2,"div",6),s.kc()),2&e&&(s.Tb(3),s.cd(s.zc(4,4,"order.fulfillment")),s.Tb(3),s.Ec("state",null==t.fulfillment?null:t.fulfillment.state),s.Tb(2),s.Ec("ngIf",!!t.fulfillment),s.Tb(1),s.Ec("ngIf",null==t.fulfillment?null:t.fulfillment.nextStates.length))},directives:function(){return[Sc,V.o,Ic,g.T,g.W,W.o,g.V,V.n,g.U]},pipes:function(){return[q.d,g.Rb]},styles:[".fulfillment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}"],changeDetection:0}),xc.propDecorators={fulfillment:[{type:s.E}],order:[{type:s.E}],transitionState:[{type:s.P}]};var Ic=function(){function e(t){m(this,e),this.serverConfigService=t,this.customFieldConfig=[],this.customFieldFormGroup=new b.i({})}return p(e,[{key:"ngOnInit",value:function(){this.customFieldConfig=this.serverConfigService.getCustomFieldsFor("Fulfillment")}},{key:"ngOnChanges",value:function(e){this.buildCustomFieldsFormGroup()}},{key:"fulfillment",get:function(){var e=this;return this.order.fulfillments&&this.order.fulfillments.find(function(t){return t.id===e.fulfillmentId})}},{key:"items",get:function(){var e,c,r=new Map,i=null===(e=this.fulfillment)||void 0===e?void 0:e.orderItems.map(function(e){return e.id}),o=t(this.order.lines);try{for(o.s();!(c=o.n()).done;){var a,l=c.value,d=t(l.items);try{for(d.s();!(a=d.n()).done;){var s=a.value;if(null==i?void 0:i.includes(s.id)){var u=r.get(l.productVariant.name);null!=u?r.set(l.productVariant.name,u+1):r.set(l.productVariant.name,1)}}}catch(f){d.e(f)}finally{d.f()}}}catch(f){o.e(f)}finally{o.f()}return Array.from(r.entries()).map(function(e){var t=n(e,2);return{name:t[0],quantity:t[1]}})}},{key:"buildCustomFieldsFormGroup",value:function(){var e,n=this.fulfillment.customFields,c=t(this.serverConfigService.getCustomFieldsFor("Fulfillment"));try{for(c.s();!(e=c.n()).done;){var r=e.value;this.customFieldFormGroup.addControl(r.name,new b.f(n[r.name]))}}catch(i){c.e(i)}finally{c.f()}}},{key:"customFieldIsObject",value:function(e){return Array.isArray(e)||Object(v.isObject)(e)}}]),e}();Ic.\u0275fac=function(e){return new(e||Ic)(s.fc(g.Mb))},Ic.\u0275cmp=s.Zb({type:Ic,selectors:[["vdr-fulfillment-detail"]],inputs:{fulfillmentId:"fulfillmentId",order:"order"},features:[s.Rb],decls:12,vars:17,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"items"],[4,"ngFor","ngForOf"],[3,"readonly","compact","customField","customFieldsFormGroup",4,"ngIf"],[3,"readonly","compact","customField","customFieldsFormGroup"]],template:function(e,t){1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.yc(3,"localeDate"),s.kc(),s.lc(4,"vdr-labeled-data",0),s.yc(5,"translate"),s.bd(6),s.kc(),s.Zc(7,me,3,4,"vdr-labeled-data",1),s.lc(8,"vdr-labeled-data",0),s.yc(9,"translate"),s.gc(10,"vdr-simple-item-list",2),s.kc(),s.Zc(11,pe,2,1,"ng-container",3)),2&e&&(s.Ec("label",s.zc(1,8,"common.created-at")),s.Tb(2),s.dd(" ",s.Ac(3,10,null==t.fulfillment?null:t.fulfillment.createdAt,"medium"),"\n"),s.Tb(2),s.Ec("label",s.zc(5,13,"order.fulfillment-method")),s.Tb(2),s.dd(" ",null==t.fulfillment?null:t.fulfillment.method,"\n"),s.Tb(1),s.Ec("ngIf",null==t.fulfillment?null:t.fulfillment.trackingCode),s.Tb(1),s.Ec("label",s.zc(9,15,"order.contents")),s.Tb(2),s.Ec("items",t.items),s.Tb(1),s.Ec("ngForOf",t.customFieldConfig))},directives:function(){return[g.ub,V.o,Xc,V.n,g.I]},pipes:function(){return[q.d,g.Ab]},styles:[""],changeDetection:0}),Ic.ctorParameters=function(){return[{type:g.Mb}]},Ic.propDecorators={fulfillmentId:[{type:s.E}],order:[{type:s.E}]};var Sc=function(){function e(){m(this,e)}return p(e,[{key:"chipColorType",get:function(){switch(this.state){case"Pending":case"Shipped":return"warning";case"Delivered":return"success";case"Cancelled":return"error"}}}]),e}();Sc.\u0275fac=function(e){return new(e||Sc)},Sc.\u0275cmp=s.Zb({type:Sc,selectors:[["vdr-fulfillment-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(e,t){1&e&&(s.lc(0,"vdr-chip",0),s.yc(1,"translate"),s.Zc(2,ge,1,0,"clr-icon",1),s.bd(3),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.kc()),2&e&&(s.Ec("title",s.zc(1,4,"order.payment-state"))("colorType",t.chipColorType),s.Tb(2),s.Ec("ngIf","Delivered"===t.state),s.Tb(1),s.dd(" ",s.zc(4,6,s.zc(5,8,t.state)),"\n"))},directives:[g.D,V.o,W.o],pipes:[q.d,g.Rb],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0}),Sc.propDecorators={state:[{type:s.E}]};var Ec=function(){function c(){m(this,c),this.fulfilledCount=0,this.fulfillments=[]}return p(c,[{key:"ngOnChanges",value:function(e){this.line&&(this.fulfilledCount=this.getDeliveredCount(this.line),this.fulfillmentStatus=this.getFulfillmentStatus(this.fulfilledCount,this.line.items.length),this.fulfillments=this.getFulfillments(this.line))}},{key:"getDeliveredCount",value:function(e){return e.items.reduce(function(e,t){return e+(t.fulfillment?1:0)},0)}},{key:"getFulfillmentStatus",value:function(e,t){return e===t?"full":0<e&&e<t?"partial":"none"}},{key:"getFulfillments",value:function(c){var r,i={},o=t(c.items);try{for(o.s();!(r=o.n()).done;){var a=r.value;a.fulfillment&&(void 0===i[a.fulfillment.id]?i[a.fulfillment.id]=1:i[a.fulfillment.id]++)}}catch(d){o.e(d)}finally{o.f()}var l=c.items.reduce(function(t,n){return n.fulfillment?[].concat(e(t),[n.fulfillment]):t},[]);return Object.entries(i).map(function(e){var t=n(e,2),c=t[0];return{count:t[1],fulfillment:l.find(function(e){return e.id===c})}})}}]),c}();Ec.\u0275fac=function(e){return new(e||Ec)},Ec.\u0275cmp=s.Zb({type:Ec,selectors:[["vdr-line-fulfillment"]],inputs:{line:"line",orderState:"orderState"},features:[s.Rb],decls:1,vars:1,consts:[["class","search-settings-menu",4,"ngIf"],[1,"search-settings-menu"],["type","button","vdrDropdownTrigger","",1,"icon-button"],["class","item-fulfilled","shape","check-circle",4,"ngIf"],["class","item-partially-fulfilled","shape","check-circle",4,"ngIf"],["class","item-not-fulfilled","shape","exclamation-circle",4,"ngIf"],["vdrPosition","bottom-right"],["class","dropdown-header",4,"ngIf"],["class","fulfillment-detail",4,"ngFor","ngForOf"],["shape","check-circle",1,"item-fulfilled"],["shape","check-circle",1,"item-partially-fulfilled"],["shape","exclamation-circle",1,"item-not-fulfilled"],[1,"dropdown-header"],[1,"fulfillment-detail"],[1,"fulfillment-title"],[3,"label"],[3,"label",4,"ngIf"]],template:function(e,t){1&e&&s.Zc(0,Ee,10,7,"vdr-dropdown",0),2&e&&s.Ec("ngIf",t.fulfilledCount||"PartiallyDelivered"===t.orderState)},directives:[V.o,g.T,g.W,g.V,V.n,W.o,W.u,g.ub],pipes:[q.d,g.Ab],styles:[".item-fulfilled[_ngcontent-%COMP%]{color:var(--color-success-500)}.item-partially-fulfilled[_ngcontent-%COMP%]{color:var(--color-warning-500)}.item-not-fulfilled[_ngcontent-%COMP%]{color:var(--color-error-500)}.fulfillment-detail[_ngcontent-%COMP%]{margin:6px 12px}.fulfillment-detail[_ngcontent-%COMP%]:not(:last-of-type){border-bottom:1px dashed var(--color-component-border-200)}"],changeDetection:0}),Ec.propDecorators={line:[{type:s.E}],orderState:[{type:s.E}]};var Pc=function(){function t(){m(this,t)}return p(t,[{key:"getRefundedCount",value:function(){var t,n,c=null!==(n=null===(t=this.payments)||void 0===t?void 0:t.reduce(function(t,n){return[].concat(e(t),e(n.refunds))},[]))&&void 0!==n?n:[];return this.line.items.filter(function(e){if(null===e.refundId&&!e.cancelled)return!1;if(e.refundId){var t=c.find(function(t){return t.id===e.refundId});return"Failed"!==(null==t?void 0:t.state)}return!1}).length}}]),t}();Pc.\u0275fac=function(e){return new(e||Pc)},Pc.\u0275cmp=s.Zb({type:Pc,selectors:[["vdr-line-refunds"]],inputs:{line:"line",payments:"payments"},decls:1,vars:1,consts:[[3,"title",4,"ngIf"],[3,"title"],["shape","redo","dir","down",1,"is-solid"]],template:function(e,t){1&e&&s.Zc(0,Pe,3,6,"span",0),2&e&&s.Ec("ngIf",t.getRefundedCount())},directives:[V.o,W.o,Q.b],pipes:[q.d],styles:["[_nghost-%COMP%]{color:var(--color-error-500)}"],changeDetection:0}),Pc.propDecorators={line:[{type:s.E}],payments:[{type:s.E}]};var Mc=function(){function c(){m(this,c),this.addedItems=new Map,this.removedItems=new Map}return p(c,[{key:"ngOnChanges",value:function(){var e=this.getModifiedLines(),t=e.added,n=e.removed;this.addedItems=t,this.removedItems=n}},{key:"getSurcharge",value:function(e){return this.order.surcharges.find(function(t){return t.id===e})}},{key:"getAddedItems",value:function(){return e(this.addedItems.entries()).map(function(e){var t=n(e,2),c=t[0],r=t[1];return{name:c.productVariant.name,quantity:r}})}},{key:"getRemovedItems",value:function(){return e(this.removedItems.entries()).map(function(e){var t=n(e,2),c=t[0],r=t[1];return{name:c.productVariant.name,quantity:r}})}},{key:"getModifiedLines",value:function(){var e,n,c,r=new Map,i=new Map,o=t(this.modification.orderItems||[]);try{for(o.s();!(c=o.n()).done;){var a=c.value,l=this.getOrderLineAndItem(a.id);if(l){var d=l.line;if(l.item.cancelled){var s=null!==(e=i.get(d))&&void 0!==e?e:0;i.set(d,s+1)}else{var u=null!==(n=r.get(d))&&void 0!==n?n:0;r.set(d,u+1)}}}}catch(f){o.e(f)}finally{o.f()}return{added:r,removed:i}}},{key:"getOrderLineAndItem",value:function(e){var n,c=t(this.order.lines);try{for(c.s();!(n=c.n()).done;){var r=n.value,i=r.items.find(function(t){return t.id===e});if(i)return{line:r,item:i}}}catch(o){c.e(o)}finally{c.f()}}}]),c}();Mc.\u0275fac=function(e){return new(e||Mc)},Mc.\u0275cmp=s.Zb({type:Mc,selectors:[["vdr-modification-detail"]],inputs:{order:"order",modification:"modification"},features:[s.Rb],decls:7,vars:8,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],[3,"items"]],template:function(e,t){1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.kc(),s.Zc(3,Me,3,4,"vdr-labeled-data",1),s.Zc(4,Fe,4,8,"vdr-labeled-data",2),s.Zc(5,we,3,4,"vdr-labeled-data",1),s.Zc(6,Ae,3,4,"vdr-labeled-data",1)),2&e&&(s.Ec("label",s.zc(1,6,"common.ID")),s.Tb(2),s.cd(t.modification.id),s.Tb(1),s.Ec("ngIf",t.modification.note),s.Tb(1),s.Ec("ngForOf",t.modification.surcharges),s.Tb(1),s.Ec("ngIf",t.getAddedItems().length),s.Tb(1),s.Ec("ngIf",t.getRemovedItems().length))},directives:function(){return[g.ub,V.o,V.n,Xc]},pipes:function(){return[q.d,g.zb]},styles:[""],changeDetection:0}),Mc.propDecorators={order:[{type:s.E}],modification:[{type:s.E}]};var Fc=function(){function e(t){m(this,e),this.formBuilder=t,this.customFieldsConfig=[],this.customFieldValues={},this.updateClick=new s.u,this.editable=!1}return p(e,[{key:"ngOnInit",value:function(){this.customFieldForm=this.formBuilder.group({});var e,n=t(this.customFieldsConfig);try{for(n.s();!(e=n.n()).done;){var c=e.value;this.customFieldForm.addControl(c.name,this.formBuilder.control(this.customFieldValues[c.name]))}}catch(r){n.e(r)}finally{n.f()}}},{key:"onUpdateClick",value:function(){this.updateClick.emit(this.customFieldForm.value),this.customFieldForm.markAsPristine(),this.editable=!1}}]),e}();Fc.\u0275fac=function(e){return new(e||Fc)(s.fc(b.e))},Fc.\u0275cmp=s.Zb({type:Fc,selectors:[["vdr-order-custom-fields-card"]],inputs:{customFieldsConfig:"customFieldsConfig",customFieldValues:"customFieldValues"},outputs:{updateClick:"updateClick"},decls:1,vars:1,consts:[["class","card",4,"ngIf"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text","custom-field-form"],[4,"ngFor","ngForOf"],[1,"card-footer"],["class","btn btn-sm btn-secondary",3,"click",4,"ngIf"],["class","btn btn-sm btn-primary",3,"disabled","click",4,"ngIf"],["entityName","Order",3,"customFieldsFormGroup","compact","readonly","customField"],[1,"btn","btn-sm","btn-secondary",3,"click"],["shape","pencil"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],["shape","check"]],template:function(e,t){1&e&&s.Zc(0,Ze,10,8,"div",0),2&e&&s.Ec("ngIf",t.customFieldsConfig.length)},directives:[V.o,V.n,g.I,W.o],pipes:[q.d],styles:["vdr-custom-field-control[_ngcontent-%COMP%]{margin-bottom:6px;display:block}.custom-field-form[_ngcontent-%COMP%]     .clr-control-label{color:var(--color-grey-400)}.custom-field-form.editable[_ngcontent-%COMP%]     .clr-control-label{color:inherit}"],changeDetection:0}),Fc.ctorParameters=function(){return[{type:b.e}]},Fc.propDecorators={customFieldsConfig:[{type:s.E}],customFieldValues:[{type:s.E}],updateClick:[{type:s.P}]};var wc=function(){function e(){m(this,e),this.nextStates=[],this.message="",this.selectedState=""}return p(e,[{key:"select",value:function(){this.selectedState&&this.resolveWith(this.selectedState)}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();wc.\u0275fac=function(e){return new(e||wc)},wc.\u0275cmp=s.Zb({type:wc,selectors:[["vdr-order-state-select-dialog"]],decls:8,vars:5,consts:[["vdrDialogTitle",""],["clrSelect","","name","state",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["vdrDialogButtons",""],[3,"value"],["type","submit","class","btn btn-secondary",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],["type","submit",1,"btn","btn-secondary",3,"click"]],template:function(e,t){1&e&&(s.Zc(0,De,2,3,"ng-template",0),s.lc(1,"p"),s.bd(2),s.yc(3,"translate"),s.kc(),s.lc(4,"clr-select-container"),s.lc(5,"select",1),s.vc("ngModelChange",function(e){return t.selectedState=e}),s.Zc(6,Le,4,6,"option",2),s.kc(),s.kc(),s.Zc(7,Ne,6,12,"ng-template",3)),2&e&&(s.Tb(2),s.cd(s.zc(3,3,t.message)),s.Tb(3),s.Ec("ngModel",t.selectedState),s.Tb(1),s.Ec("ngForOf",t.nextStates))},directives:[g.R,W.B,g.eb,b.A,W.A,b.p,b.s,V.n,g.Q,b.u,b.D,V.o],pipes:[q.d,g.Rb],styles:[""],changeDetection:0});var Ac=function(){function e(t,n,c,r){m(this,e),this.dataService=t,this.modalService=n,this.notificationService=c,this.i18nService=r}return p(e,[{key:"transitionToPreModifyingState",value:function(e,t){var n=this;return this.getPreModifyingState(e).pipe(Object(I.a)(function(c){var r={orderId:e,nextStates:t,message:n.i18nService.translate(Object(y.a)("order.unable-to-transition-to-state-try-another"),{state:c}),cancellable:!1,retry:10};return c?n.transitionToStateOrThrow(e,c).pipe(Object(S.a)(function(e){return n.manuallyTransitionToState(r)})):n.manuallyTransitionToState(r)}))}},{key:"manuallyTransitionToState",value:function(e){var t,n=this;return this.modalService.fromComponent(wc,{locals:{nextStates:e.nextStates,cancellable:e.cancellable,message:e.message},closable:!1,size:"md"}).pipe(Object(I.a)(function(t){if(t)return n.transitionToStateOrThrow(e.orderId,t);if(e.cancellable)return k.a;throw new Error("An order state must be selected")}),(t=function(t){return t.pipe(Object(F.a)(2e3),Object(w.a)(e.retry))},function(e){return e.lift(new P(t,e))}))}},{key:"getPreModifyingState",value:function(e){return this.dataService.order.getOrderHistory(e,{filter:{type:{eq:g.mb.ORDER_STATE_TRANSITION}},sort:{createdAt:g.Pb.DESC}}).mapSingle(function(e){return e.order}).pipe(Object(A.a)(function(e){var t=null==e?void 0:e.history.items.find(function(e){return"Modifying"===e.data.to});return t?t.data.from:void 0}))}},{key:"transitionToStateOrThrow",value:function(e,t){var n=this;return this.dataService.order.transitionToState(e,t).pipe(Object(A.a)(function(e){var t=e.transitionOrderToState;switch(null==t?void 0:t.__typename){case"Order":return null==t?void 0:t.state;case"OrderStateTransitionError":throw n.notificationService.error(null==t?void 0:t.transitionError),new Error(null==t?void 0:t.transitionError)}}))}}]),e}();Ac.\u0275fac=function(e){return new(e||Ac)(s.sc(g.L),s.sc(g.Db),s.sc(g.Eb),s.sc(g.nb))},Ac.\u0275prov=Object(s.bc)({factory:function(){return new Ac(Object(s.sc)(g.L),Object(s.sc)(g.Db),Object(s.sc)(g.Eb),Object(s.sc)(g.nb))},token:Ac,providedIn:"root"}),Ac.ctorParameters=function(){return[{type:g.L},{type:g.Db},{type:g.Eb},{type:g.nb}]};var _c=function(){function e(t){m(this,e),this.serverConfigService=t,this.states=[]}return p(e,[{key:"ngOnInit",value:function(){this.states=this.serverConfigService.getOrderProcessStates()}}]),e}();_c.\u0275fac=function(e){return new(e||_c)(s.fc(g.Mb))},_c.\u0275cmp=s.Zb({type:_c,selectors:[["vdr-order-process-graph-dialog"]],decls:2,vars:2,consts:[["vdrDialogTitle",""],[3,"states","initialState"]],template:function(e,t){1&e&&(s.Zc(0,$e,2,3,"ng-template",0),s.gc(1,"vdr-order-process-graph",1)),2&e&&(s.Tb(1),s.Ec("states",t.states)("initialState",t.activeState))},directives:function(){return[g.R,Hc]},pipes:function(){return[q.d]},styles:[""],changeDetection:0}),_c.ctorParameters=function(){return[{type:g.Mb}]};var zc=function(){function t(e){var n=this;m(this,t),this.i18nService=e,this.lineQuantities={},this.refundShipping=!1,this.adjustment=0,this.reasons=[Object(y.a)("order.refund-reason-customer-request"),Object(y.a)("order.refund-reason-not-available")],this.reasons=this.reasons.map(function(e){return n.i18nService.translate(e)})}return p(t,[{key:"refundTotal",get:function(){var e=this;return this.order.lines.reduce(function(t,n){var c=e.lineQuantities[n.id],r=c.refund&&c.quantity||0;return t+n.proratedUnitPriceWithTax*r},0)+(this.refundShipping?this.order.shippingWithTax:0)+this.adjustment}},{key:"settledPaymentsTotal",get:function(){return this.settledPayments.map(function(e){return e.amount-Object(v.summate)(e.refunds.filter(function(e){return"Failed"!==e.state}),"total")}).reduce(function(e,t){return e+t},0)}},{key:"lineCanBeRefundedOrCancelled",value:function(t){var n,c,r=null!==(c=null===(n=this.order.payments)||void 0===n?void 0:n.reduce(function(t,n){return[].concat(e(t),e(n.refunds))},[]))&&void 0!==c?c:[];return 0<t.items.filter(function(e){if(e.cancelled)return!1;if(null==e.refundId)return!0;var t=r.find(function(t){return t.id===e.refundId});return"Failed"===(null==t?void 0:t.state)}).length}},{key:"ngOnInit",value:function(){this.lineQuantities=this.order.lines.reduce(function(e,t){return Object.assign(Object.assign({},e),i({},t.id,{quantity:0,refund:!1,cancel:!1}))},{}),this.settledPayments=(this.order.payments||[]).filter(function(e){return"Settled"===e.state}),this.settledPayments.length&&(this.selectedPayment=this.settledPayments[0])}},{key:"handleZeroQuantity",value:function(e){0===(null==e?void 0:e.quantity)&&(e.cancel=!1,e.refund=!1)}},{key:"isRefunding",value:function(){return Object.values(this.lineQuantities).reduce(function(e,t){return e||0<t.quantity&&t.refund},!1)}},{key:"isCancelling",value:function(){return Object.values(this.lineQuantities).reduce(function(e,t){return e||0<t.quantity&&t.cancel},!1)}},{key:"canSubmit",value:function(){return this.isRefunding()?!!(this.selectedPayment&&this.reason&&0<this.refundTotal&&this.refundTotal<=this.settledPaymentsTotal):!!this.isCancelling()&&!!this.reason}},{key:"select",value:function(){var e=this.selectedPayment;if(e){var t=this.getOrderLineInput(function(e){return e.refund}),n=this.getOrderLineInput(function(e){return e.cancel});this.resolveWith({refund:{lines:t,reason:this.reason,shipping:this.refundShipping?this.order.shippingWithTax:0,adjustment:this.adjustment,paymentId:e.id},cancel:{lines:n,orderId:this.order.id,reason:this.reason}})}}},{key:"cancel",value:function(){this.resolveWith()}},{key:"getOrderLineInput",value:function(e){return Object.entries(this.lineQuantities).filter(function(t){var c=n(t,2),r=(c[0],c[1]);return 0<r.quantity&&e(r)}).map(function(e){var t=n(e,2);return{orderLineId:t[0],quantity:t[1].quantity}})}}]),t}();zc.\u0275fac=function(e){return new(e||zc)(s.fc(g.nb))},zc.\u0275cmp=s.Zb({type:zc,selectors:[["vdr-refund-order-dialog"]],decls:69,vars:74,consts:[["vdrDialogTitle",""],[1,"refund-wrapper"],[1,"order-table"],[1,"table"],["class","order-line",4,"ngFor","ngForOf"],[1,"refund-details","mt4"],[1,"clr-control-label"],["bindLabel","name","autofocus","","bindValue","id",3,"disabled","items","placeholder","addTag","ngModel","ngModelChange"],["clrSelect","","name","options",3,"ngModel","disabled","ngModelChange"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],["type","checkbox","clrCheckbox","",3,"ngModel","disabled","ngModelChange"],["clrInput","",3,"disabled","currencyCode","ngModel","ngModelChange"],[1,"totals"],[1,"order-total"],[1,"refund-total"],["class","refund-total-error",4,"ngIf"],["class","refund-total-warning",4,"ngIf"],["vdrDialogButtons",""],[1,"order-line"],[1,"align-middle","thumb"],[3,"src"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","quantity"],[3,"line","payments"],[1,"prorated-wrapper"],[4,"ngIf"],[1,"align-middle","fulfil"],["type","number","min","0",3,"ngModel","max","ngModelChange","input",4,"ngIf"],[1,"align-middle"],[1,"cancel-checkbox-wrapper"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange",4,"ngIf"],["vdrDropdownTrigger","",1,"promotions-label"],[1,"icon-button"],["shape","info"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-amount"],["type","number","min","0",3,"ngModel","max","ngModelChange","input"],["type","checkbox","clrCheckbox","",3,"disabled","ngModel","ngModelChange"],[3,"ngValue","disabled"],[1,"refund-total-error"],[1,"refund-total-warning"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[4,"ngIf","ngIfElse"],["cancelling",""]],template:function(e,t){1&e&&(s.Zc(0,qe,2,3,"ng-template",0),s.lc(1,"div",1),s.lc(2,"div",2),s.lc(3,"table",3),s.lc(4,"thead"),s.lc(5,"tr"),s.gc(6,"th"),s.lc(7,"th"),s.bd(8),s.yc(9,"translate"),s.kc(),s.lc(10,"th"),s.bd(11),s.yc(12,"translate"),s.kc(),s.lc(13,"th"),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"th"),s.bd(17),s.yc(18,"translate"),s.kc(),s.lc(19,"th"),s.bd(20),s.yc(21,"translate"),s.kc(),s.lc(22,"th"),s.bd(23),s.yc(24,"translate"),s.kc(),s.lc(25,"th"),s.bd(26),s.yc(27,"translate"),s.kc(),s.lc(28,"th"),s.bd(29),s.yc(30,"translate"),s.kc(),s.kc(),s.kc(),s.Zc(31,Be,27,21,"tr",4),s.kc(),s.kc(),s.lc(32,"div",5),s.lc(33,"div"),s.lc(34,"label",6),s.bd(35),s.yc(36,"translate"),s.kc(),s.lc(37,"ng-select",7),s.vc("ngModelChange",function(e){return t.reason=e}),s.yc(38,"translate"),s.kc(),s.kc(),s.lc(39,"div"),s.lc(40,"clr-select-container"),s.lc(41,"label"),s.bd(42),s.yc(43,"translate"),s.kc(),s.lc(44,"select",8),s.vc("ngModelChange",function(e){return t.selectedPayment=e}),s.Zc(45,Je,3,8,"option",9),s.kc(),s.kc(),s.lc(46,"clr-checkbox-wrapper"),s.lc(47,"input",10),s.vc("ngModelChange",function(e){return t.refundShipping=e}),s.kc(),s.lc(48,"label"),s.bd(49),s.yc(50,"translate"),s.yc(51,"localeCurrency"),s.kc(),s.kc(),s.lc(52,"clr-input-container"),s.lc(53,"label"),s.bd(54),s.yc(55,"translate"),s.kc(),s.lc(56,"vdr-currency-input",11),s.vc("ngModelChange",function(e){return t.adjustment=e}),s.kc(),s.kc(),s.lc(57,"div",12),s.lc(58,"div",13),s.bd(59),s.yc(60,"translate"),s.yc(61,"localeCurrency"),s.kc(),s.lc(62,"div",14),s.bd(63),s.yc(64,"translate"),s.yc(65,"localeCurrency"),s.kc(),s.Zc(66,Ye,5,13,"div",15),s.Zc(67,Ke,3,3,"div",16),s.kc(),s.kc(),s.kc(),s.kc(),s.Zc(68,ct,7,6,"ng-template",17)),2&e&&(s.Tb(8),s.cd(s.zc(9,35,"order.product-name")),s.Tb(3),s.cd(s.zc(12,37,"order.product-sku")),s.Tb(3),s.cd(s.zc(15,39,"order.quantity")),s.Tb(3),s.cd(s.zc(18,41,"order.unit-price")),s.Tb(3),s.cd(s.zc(21,43,"order.prorated-unit-price")),s.Tb(3),s.cd(s.zc(24,45,"order.quantity")),s.Tb(3),s.cd(s.zc(27,47,"order.refund")),s.Tb(3),s.cd(s.zc(30,49,"order.cancel")),s.Tb(2),s.Ec("ngForOf",t.order.lines),s.Tb(4),s.cd(s.zc(36,51,"order.refund-cancellation-reason")),s.Tb(2),s.Ec("disabled",!t.isRefunding()&&!t.isCancelling())("items",t.reasons)("placeholder",s.zc(38,53,"order.refund-cancellation-reason-required"))("addTag",!0)("ngModel",t.reason),s.Tb(5),s.cd(s.zc(43,55,"order.payment-to-refund")),s.Tb(2),s.Ec("ngModel",t.selectedPayment)("disabled",!t.isRefunding()),s.Tb(1),s.Ec("ngForOf",t.settledPayments),s.Tb(2),s.Ec("ngModel",t.refundShipping)("disabled",!t.isRefunding()),s.Tb(2),s.ed(" ",s.zc(50,57,"order.refund-shipping")," (",s.Ac(51,59,t.order.shippingWithTax,t.order.currencyCode),") "),s.Tb(5),s.cd(s.zc(55,62,"order.refund-adjustment")),s.Tb(2),s.Ec("disabled",!t.isRefunding())("currencyCode",t.order.currencyCode)("ngModel",t.adjustment),s.Tb(1),s.Xb("disabled",!t.isRefunding()),s.Tb(2),s.ed(" ",s.zc(60,64,"order.payment-amount"),": ",s.Ac(61,66,t.selectedPayment.amount,t.order.currencyCode)," "),s.Tb(4),s.ed(" ",s.zc(64,69,"order.refund-total"),": ",s.Ac(65,71,t.refundTotal,t.order.currencyCode)," "),s.Tb(3),s.Ec("ngIf",t.refundTotal<0||t.settledPaymentsTotal<t.refundTotal),s.Tb(1),s.Ec("ngIf",t.selectedPayment.amount<t.refundTotal))},directives:[g.R,V.n,W.u,$.a,b.p,b.s,W.B,g.eb,b.A,W.A,W.k,b.a,W.i,W.t,g.H,W.s,V.o,g.Q,Pc,g.T,g.W,W.o,g.V,b.v,b.b,b.u,b.D],pipes:[q.d,g.zb,g.r,V.d,V.f],styles:["[_nghost-%COMP%]{height:100%;display:flex;min-height:64vh}.refund-wrapper[_ngcontent-%COMP%]{flex:1;flex-direction:column}.refund-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.refund-wrapper[_ngcontent-%COMP%]   .order-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-top:0}.refund-wrapper[_ngcontent-%COMP%]   tr.ignore[_ngcontent-%COMP%]{color:var(--color-grey-300)}.cancel-checkbox-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}clr-checkbox-wrapper[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px;display:block}.refund-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.totals[_ngcontent-%COMP%]{margin-top:48px}.totals[_ngcontent-%COMP%]   .refund-total[_ngcontent-%COMP%]{font-size:18px}.totals[_ngcontent-%COMP%]   .refund-total-error[_ngcontent-%COMP%]{color:var(--color-error-500)}.totals[_ngcontent-%COMP%]   .refund-total-warning[_ngcontent-%COMP%]{color:var(--color-warning-600);max-width:250px}.totals.disabled[_ngcontent-%COMP%]{color:var(--color-grey-300)}.prorated-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.line-promotion[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:12px;padding:3px 6px}.line-promotion[_ngcontent-%COMP%]   .promotion-amount[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}),zc.ctorParameters=function(){return[{type:g.nb}]};var jc=function(){function e(){m(this,e),this.transactionId=""}return p(e,[{key:"submit",value:function(){this.resolveWith(this.transactionId)}},{key:"cancel",value:function(){this.resolveWith()}}]),e}();jc.\u0275fac=function(e){return new(e||jc)},jc.\u0275cmp=s.Zb({type:jc,selectors:[["vdr-settle-refund-dialog"]],decls:10,vars:10,consts:[["vdrDialogTitle",""],[1,"instruction"],["clrInput","","name","transactionId",3,"ngModel","ngModelChange"],["vdrDialogButtons",""],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Zc(0,rt,2,3,"ng-template",0),s.lc(1,"p",1),s.bd(2),s.yc(3,"translate"),s.kc(),s.lc(4,"clr-input-container"),s.lc(5,"label"),s.bd(6),s.yc(7,"translate"),s.kc(),s.lc(8,"input",2),s.vc("ngModelChange",function(e){return t.transactionId=e}),s.kc(),s.kc(),s.Zc(9,it,6,7,"ng-template",3)),2&e&&(s.Tb(2),s.dd(" ",s.Ac(3,3,"order.settle-refund-manual-instructions",s.Ic(8,ot,t.refund.method)),"\n"),s.Tb(4),s.cd(s.zc(7,6,"order.transaction-id")),s.Tb(2),s.Ec("ngModel",t.transactionId))},directives:[g.R,W.t,W.u,g.eb,b.b,W.s,b.p,b.s,g.Q],pipes:[q.d],styles:["[_nghost-%COMP%]{padding-bottom:32px}.instruction[_ngcontent-%COMP%]{margin-top:0;margin-bottom:24px}"],changeDetection:0});var Zc,Dc=function(n){a(r,n);var c=d(r);function r(e,t,n,i,o,a,l,d){var s;return m(this,r),(s=c.call(this,t,e,n,o)).changeDetector=i,s.dataService=o,s.notificationService=a,s.modalService=l,s.orderTransitionService=d,s.detailForm=new b.i({}),s.fetchHistory=new T.a,s.defaultStates=["AddingItems","ArrangingPayment","PaymentAuthorized","PaymentSettled","PartiallyShipped","Shipped","PartiallyDelivered","Delivered","Cancelled","Modifying","ArrangingAdditionalPayment"],s}return p(r,[{key:"ngOnInit",value:function(){var e=this;this.init(),this.entity$.pipe(Object(w.a)(1)).subscribe(function(t){"Modifying"===t.state&&e.router.navigate(["./","modify"],{relativeTo:e.route})}),this.customFields=this.getCustomFieldConfig("Order"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.history$=this.fetchHistory.pipe(Object(_.a)(null),Object(I.a)(function(){return e.dataService.order.getOrderHistory(e.id,{sort:{createdAt:g.Pb.DESC}}).mapStream(function(e){var t;return null===(t=e.order)||void 0===t?void 0:t.history.items})})),this.nextStates$=this.entity$.pipe(Object(A.a)(function(t){return e.defaultStates.includes(t.state)?t.nextStates.filter(function(t){return!e.defaultStates.includes(t)}):t.nextStates}))}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"openStateDiagram",value:function(){var e=this;this.entity$.pipe(Object(w.a)(1),Object(I.a)(function(t){return e.modalService.fromComponent(_c,{closable:!0,locals:{activeState:t.state}})})).subscribe()}},{key:"transitionToState",value:function(e){var t=this;this.dataService.order.transitionToState(this.id,e).subscribe(function(n){var c=n.transitionOrderToState;switch(null==c?void 0:c.__typename){case"Order":t.notificationService.success(Object(y.a)("order.transitioned-to-state-success"),{state:e}),t.fetchHistory.next();break;case"OrderStateTransitionError":t.notificationService.error(c.transitionError)}})}},{key:"manuallyTransitionToState",value:function(e){this.orderTransitionService.manuallyTransitionToState({orderId:e.id,nextStates:e.nextStates,cancellable:!0,message:Object(y.a)("order.manually-transition-to-state-message"),retry:0}).subscribe()}},{key:"transitionToModifying",value:function(){var e=this;this.dataService.order.transitionToState(this.id,"Modifying").subscribe(function(t){var n=t.transitionOrderToState;switch(null==n?void 0:n.__typename){case"Order":e.router.navigate(["./modify"],{relativeTo:e.route});break;case"OrderStateTransitionError":e.notificationService.error(n.transitionError)}})}},{key:"updateCustomFields",value:function(e){var t=this;this.dataService.order.updateOrderCustomFields({id:this.id,customFields:e}).subscribe(function(){t.notificationService.success(Object(y.a)("common.notify-update-success"),{entity:"Order"})})}},{key:"getOrderAddressLines",value:function(e){return e?Object.values(e).filter(function(e){return"OrderAddress"!==e}).filter(function(e){return!!e}):[]}},{key:"settlePayment",value:function(e){var t=this;this.dataService.order.settlePayment(e.id).subscribe(function(e){var n=e.settlePayment;switch(n.__typename){case"Payment":"Settled"===n.state?t.notificationService.success(Object(y.a)("order.settle-payment-success")):t.notificationService.error(Object(y.a)("order.settle-payment-error")),t.dataService.order.getOrder(t.id).single$.subscribe(),t.fetchHistory.next();break;case"OrderStateTransitionError":case"PaymentStateTransitionError":case"SettlePaymentError":t.notificationService.error(n.message)}})}},{key:"transitionPaymentState",value:function(e){var t=this,n=e.payment,c=e.state;this.dataService.order.transitionPaymentToState(n.id,c).subscribe(function(e){var n=e.transitionPaymentToState;switch(n.__typename){case"Payment":t.notificationService.success(Object(y.a)("order.transitioned-payment-to-state-success"),{state:c}),t.dataService.order.getOrder(t.id).single$.subscribe(),t.fetchHistory.next();break;case"PaymentStateTransitionError":t.notificationService.error(n.message)}})}},{key:"canAddFulfillment",value:function(t){return!t.lines.reduce(function(t,n){return[].concat(e(t),e(n.items))},[]).every(function(e){return!!e.fulfillment})&&!this.hasUnsettledModifications(t)&&0===this.outstandingPaymentAmount(t)&&(t.nextStates.includes("Shipped")||t.nextStates.includes("PartiallyShipped")||t.nextStates.includes("Delivered"))}},{key:"hasUnsettledModifications",value:function(e){return 0<e.modifications.filter(function(e){return!e.isSettled}).length}},{key:"getOutstandingModificationAmount",value:function(e){return Object(v.summate)(e.modifications.filter(function(e){return!e.isSettled}),"priceChange")}},{key:"outstandingPaymentAmount",value:function(e){var n,c,r,i,o=0,a=t(null!==(c=null===(n=e.payments)||void 0===n?void 0:n.filter(function(e){return"Cancelled"!==e.state&&"Declined"!==e.state&&"Error"!==e.state}))&&void 0!==c?c:[]);try{for(a.s();!(i=a.n()).done;){var l=i.value,d=null!==(r=l.refunds.filter(function(e){return"Failed"!==e.state}))&&void 0!==r?r:[],s=Object(v.summate)(d,"total");o+=l.amount-s}}catch(u){a.e(u)}finally{a.f()}return e.totalWithTax-o}},{key:"addManualPayment",value:function(e){var t=this;this.modalService.fromComponent(Tc,{closable:!0,locals:{outstandingAmount:this.outstandingPaymentAmount(e),currencyCode:e.currencyCode}}).pipe(Object(I.a)(function(e){return e?t.dataService.order.addManualPaymentToOrder({orderId:t.id,transactionId:e.transactionId,method:e.method,metadata:e.metadata||{}}):k.a}),Object(I.a)(function(n){var c=n.addManualPaymentToOrder;switch(c.__typename){case"Order":return t.notificationService.success(Object(y.a)("order.add-payment-to-order-success")),t.orderTransitionService.transitionToPreModifyingState(e.id,e.nextStates);case"ManualPaymentStateError":return t.notificationService.error(c.message),k.a;default:return k.a}})).subscribe(function(e){e&&t.refetchOrder({result:e})})}},{key:"fulfillOrder",value:function(){var e=this;this.entity$.pipe(Object(w.a)(1),Object(I.a)(function(t){return e.modalService.fromComponent(Oc,{size:"xl",locals:{order:t}})}),Object(I.a)(function(t){return t?e.dataService.order.createFulfillment(t):Object(C.a)(void 0)}),Object(I.a)(function(t){return e.refetchOrder(t).pipe(Object(z.a)(t))})).subscribe(function(t){if(t){var n=t.addFulfillmentToOrder;switch(n.__typename){case"Fulfillment":e.notificationService.success(Object(y.a)("order.create-fulfillment-success"));break;case"EmptyOrderLineSelectionError":case"InsufficientStockOnHandError":case"ItemsAlreadyFulfilledError":case"InvalidFulfillmentHandlerError":e.notificationService.error(n.message);break;case"FulfillmentStateTransitionError":e.notificationService.error(n.transitionError);break;case"CreateFulfillmentError":e.notificationService.error(n.fulfillmentHandlerError);break;case void 0:e.notificationService.error(JSON.stringify(n));break;default:Object(v.assertNever)(n)}}})}},{key:"transitionFulfillment",value:function(e,t){var n=this;this.dataService.order.transitionFulfillmentToState(e,t).pipe(Object(I.a)(function(e){return n.refetchOrder(e)})).subscribe(function(){n.notificationService.success(Object(y.a)("order.successfully-updated-fulfillment"))})}},{key:"cancelOrRefund",value:function(e){var t=this.orderHasSettledPayments(e);"PaymentAuthorized"!==e.state&&!0!==e.active&&t?this.refundOrder(e):this.cancelOrder(e)}},{key:"settleRefund",value:function(e){var t=this;this.modalService.fromComponent(jc,{size:"md",locals:{refund:e}}).pipe(Object(I.a)(function(n){return n?t.dataService.order.settleRefund({transactionId:n,id:e.id},t.id):Object(C.a)(void 0)})).subscribe(function(e){e&&t.notificationService.success(Object(y.a)("order.settle-refund-success"))})}},{key:"addNote",value:function(e){var t=this,n=e.note,c=e.isPublic;this.dataService.order.addNoteToOrder({id:this.id,note:n,isPublic:c}).pipe(Object(I.a)(function(e){return t.refetchOrder(e)})).subscribe(function(e){t.notificationService.success(Object(y.a)("common.notify-create-success"),{entity:"Note"})})}},{key:"updateNote",value:function(e){var t=this;this.modalService.fromComponent(g.Y,{closable:!0,locals:{displayPrivacyControls:!0,note:e.data.note,noteIsPrivate:!e.isPublic}}).pipe(Object(I.a)(function(n){return n?t.dataService.order.updateOrderNote({noteId:e.id,isPublic:!n.isPrivate,note:n.note}):k.a})).subscribe(function(e){t.fetchHistory.next(),t.notificationService.success(Object(y.a)("common.notify-update-success"),{entity:"Note"})})}},{key:"deleteNote",value:function(e){var t=this;return this.modalService.dialog({title:Object(y.a)("common.confirm-delete-note"),body:e.data.note,buttons:[{type:"secondary",label:Object(y.a)("common.cancel")},{type:"danger",label:Object(y.a)("common.delete"),returnValue:!0}]}).pipe(Object(I.a)(function(n){return n?t.dataService.order.deleteOrderNote(e.id):k.a})).subscribe(function(){t.fetchHistory.next(),t.notificationService.success(Object(y.a)("common.notify-delete-success"),{entity:"Note"})})}},{key:"orderHasSettledPayments",value:function(e){var t;return!!(null===(t=e.payments)||void 0===t?void 0:t.find(function(e){return"Settled"===e.state}))}},{key:"cancelOrder",value:function(e){var t=this;this.modalService.fromComponent(Cc,{size:"xl",locals:{order:e}}).pipe(Object(I.a)(function(e){return e?t.dataService.order.cancelOrder(e):Object(C.a)(void 0)}),Object(I.a)(function(e){return t.refetchOrder(e)})).subscribe(function(e){e&&t.notificationService.success(Object(y.a)("order.cancelled-order-success"))})}},{key:"refundOrder",value:function(e){var t=this;this.modalService.fromComponent(zc,{size:"xl",locals:{order:e}}).pipe(Object(I.a)(function(e){var n;if(!e)return Object(C.a)(void 0);var c=[];return e.refund.lines.length&&c.push(t.dataService.order.refundOrder(e.refund).pipe(Object(A.a)(function(e){return e.refundOrder}))),(null===(n=e.cancel.lines)||void 0===n?void 0:n.length)&&c.push(t.dataService.order.cancelOrder(e.cancel).pipe(Object(A.a)(function(e){return e.cancelOrder}))),Object(O.a).apply(void 0,c)})).subscribe(function(e){if(e)switch(e.__typename){case"Order":t.refetchOrder(e).subscribe(),t.notificationService.success(Object(y.a)("order.cancelled-order-success"));break;case"Refund":t.refetchOrder(e).subscribe(),"Failed"===e.state?t.notificationService.error(Object(y.a)("order.refund-order-failed")):t.notificationService.success(Object(y.a)("order.refund-order-success"));break;case"QuantityTooGreatError":case"MultipleOrderError":case"OrderStateTransitionError":case"CancelActiveOrderError":case"EmptyOrderLineSelectionError":case"AlreadyRefundedError":case"NothingToRefundError":case"PaymentOrderMismatchError":case"RefundOrderStateError":case"RefundStateTransitionError":t.notificationService.error(e.message)}})}},{key:"refetchOrder",value:function(e){return this.fetchHistory.next(),e?this.dataService.order.getOrder(this.id).single$:Object(C.a)(void 0)}},{key:"setFormValues",value:function(e){}}]),r}(g.w);Dc.\u0275fac=function(e){return new(e||Dc)(s.fc(h.e),s.fc(h.a),s.fc(g.Mb),s.fc(s.k),s.fc(g.L),s.fc(g.Eb),s.fc(g.Db),s.fc(Ac))},Dc.\u0275cmp=s.Zb({type:Dc,selectors:[["vdr-order-detail"]],features:[s.Qb],decls:4,vars:6,consts:[[4,"ngIf"],[1,"flex","clr-align-items-center"],[3,"entity"],[3,"state"],[1,"icon-button",3,"title","click"],["shape","list"],["locationId","order-detail"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","class","btn","vdrDropdownItem","",3,"click",4,"ngIf"],[1,"dropdown-divider"],["type","button","vdrDropdownItem","",1,"btn",3,"click"],["shape","step-forward-2",1,"is-warning"],[1,"btn","btn-primary",3,"click"],["shape","pencil"],["shape","error-standard",1,"is-error"],[4,"ngIf","ngIfElse"],["cancelOnly",""],["type","button","class","btn","vdrDropdownItem","",3,"click",4,"ngFor","ngForOf"],["shape","step-forward-2"],[1,"clr-row"],[1,"clr-col-lg-8"],[3,"order","orderLineCustomFields"],[1,"table"],[4,"ngFor","ngForOf"],[3,"order","history","addNote","updateNote","deleteNote"],[1,"clr-col-lg-4","order-cards"],[3,"customFieldsConfig","customFieldValues","updateClick"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"card-text"],[3,"customer"],[3,"address"],[3,"currencyCode","payment","settlePayment","transitionPaymentState","settleRefund",4,"ngFor","ngForOf"],[3,"currencyCode","payment","settlePayment","transitionPaymentState","settleRefund"],[3,"fulfillment","order","transitionState"]],template:function(e,t){1&e&&(s.Zc(0,pt,29,21,"vdr-action-bar",0),s.yc(1,"async"),s.Zc(2,Ct,41,34,"div",0),s.yc(3,"async")),2&e&&(s.Ec("ngIf",s.zc(1,2,t.entity$)),s.Tb(2),s.Ec("ngIf",s.zc(3,4,t.entity$)))},directives:function(){return[V.o,g.c,g.e,g.ab,g.Gb,W.o,g.f,g.d,g.T,g.W,g.V,g.U,V.n,Uc,Nc,Fc,g.J,g.gb,qc,xc]},pipes:function(){return[V.b,q.d,g.zb,g.Rb,V.v]},styles:[".shipping-address[_ngcontent-%COMP%]{list-style-type:none;line-height:1.3em}.order-cards[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:6px;color:var(--color-text-200)}"],changeDetection:0}),Dc.ctorParameters=function(){return[{type:h.e},{type:h.a},{type:g.Mb},{type:s.k},{type:g.L},{type:g.Eb},{type:g.Db},{type:Ac}]},function(e){e[e.Refund=0]="Refund",e[e.Payment=1]="Payment",e[e.PriceUnchanged=2]="PriceUnchanged",e[e.Cancel=3]="Cancel"}(Zc||(Zc={}));var Lc=function(){function e(){m(this,e)}return p(e,[{key:"priceDifference",get:function(){return this.order.totalWithTax-this.originalTotalWithTax}},{key:"ngOnInit",value:function(){this.refundNote=this.modifyOrderInput.note||""}},{key:"cancel",value:function(){this.resolveWith({result:Zc.Cancel})}},{key:"submit",value:function(){0<this.priceDifference?this.resolveWith({result:Zc.Payment}):this.priceDifference<0?this.resolveWith({result:Zc.Refund,refundPaymentId:this.selectedPayment.id,refundNote:this.refundNote}):this.resolveWith({result:Zc.PriceUnchanged})}}]),e}();Lc.\u0275fac=function(e){return new(e||Lc)},Lc.\u0275cmp=s.Zb({type:Lc,selectors:[["vdr-order-edits-preview-dialog"]],decls:10,vars:10,consts:[["vdrDialogTitle",""],[3,"order","orderLineCustomFields"],[1,"h4"],[4,"ngIf"],["vdrDialogButtons",""],["clrSelect","","name","options",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"clr-control-label"],["name","refundNote","clrTextarea","","required","",3,"ngModel","ngModelChange"],[3,"ngValue"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(s.Zc(0,Ot,2,3,"ng-template",0),s.gc(1,"vdr-order-table",1),s.lc(2,"h4",2),s.bd(3),s.yc(4,"translate"),s.lc(5,"strong"),s.bd(6),s.yc(7,"localeCurrency"),s.kc(),s.kc(),s.Zc(8,It,11,9,"div",3),s.Zc(9,St,6,7,"ng-template",4)),2&e&&(s.Tb(1),s.Ec("order",t.order)("orderLineCustomFields",t.orderLineCustomFields),s.Tb(2),s.dd(" ",s.zc(4,5,"order.modify-order-price-difference"),": "),s.Tb(3),s.cd(s.Ac(7,7,t.priceDifference,t.order.currencyCode)),s.Tb(2),s.Ec("ngIf",t.priceDifference<0))},directives:function(){return[g.R,Uc,V.o,g.Q,W.B,W.u,g.eb,b.A,W.A,b.p,b.s,V.n,b.b,W.H,b.z,b.u,b.D]},pipes:function(){return[q.d,g.zb]},styles:[""],changeDetection:0});var Rc=function(e){a(r,e);var c=d(r);function r(e,t,n,i,o,a,l,d){var s;return m(this,r),(s=c.call(this,t,e,n,o)).changeDetector=i,s.dataService=o,s.notificationService=a,s.modalService=l,s.orderTransitionService=d,s.detailForm=new b.i({}),s.modifyOrderInput={dryRun:!0,orderId:"",addItems:[],adjustOrderLines:[],surcharges:[],note:"",updateShippingAddress:{},updateBillingAddress:{}},s.note="",s.recalculateShipping=!0,s.addedVariants=new Map,s}return p(r,[{key:"addedLines",get:function(){var e=this,t=function(e){return"SinglePrice"===e.__typename?e.value:0};return(this.modifyOrderInput.addItems||[]).map(function(n){var c=e.addedVariants.get(n.productVariantId);if(c)return Object.assign(Object.assign({},c),{price:t(c.price),priceWithTax:t(c.priceWithTax),quantity:n.quantity})}).filter(v.notNullOrUndefined)}},{key:"ngOnInit",value:function(){var e=this;this.init(),this.addressCustomFields=this.getCustomFieldConfig("Address"),this.modifyOrderInput.orderId=this.route.snapshot.paramMap.get("id"),this.orderLineCustomFields=this.getCustomFieldConfig("OrderLine"),this.entity$.pipe(Object(j.a)(this.destroy$)).subscribe(function(n){var c,r,i,o,a,l,d,s,u,f,m,p,g,y,v,h,k,T;e.surchargeForm=new b.i({description:new b.f("",b.C.required),sku:new b.f(""),price:new b.f(0,b.C.required),priceIncludesTax:new b.f(!0),taxRate:new b.f(0),taxDescription:new b.f("")}),e.shippingAddressForm||(e.shippingAddressForm=new b.i({fullName:new b.f(null===(c=n.shippingAddress)||void 0===c?void 0:c.fullName),company:new b.f(null===(r=n.shippingAddress)||void 0===r?void 0:r.company),streetLine1:new b.f(null===(i=n.shippingAddress)||void 0===i?void 0:i.streetLine1),streetLine2:new b.f(null===(o=n.shippingAddress)||void 0===o?void 0:o.streetLine2),city:new b.f(null===(a=n.shippingAddress)||void 0===a?void 0:a.city),province:new b.f(null===(l=n.shippingAddress)||void 0===l?void 0:l.province),postalCode:new b.f(null===(d=n.shippingAddress)||void 0===d?void 0:d.postalCode),countryCode:new b.f(null===(s=n.shippingAddress)||void 0===s?void 0:s.countryCode),phoneNumber:new b.f(null===(u=n.shippingAddress)||void 0===u?void 0:u.phoneNumber)})),e.billingAddressForm||(e.billingAddressForm=new b.i({fullName:new b.f(null===(f=n.billingAddress)||void 0===f?void 0:f.fullName),company:new b.f(null===(m=n.billingAddress)||void 0===m?void 0:m.company),streetLine1:new b.f(null===(p=n.billingAddress)||void 0===p?void 0:p.streetLine1),streetLine2:new b.f(null===(g=n.billingAddress)||void 0===g?void 0:g.streetLine2),city:new b.f(null===(y=n.billingAddress)||void 0===y?void 0:y.city),province:new b.f(null===(v=n.billingAddress)||void 0===v?void 0:v.province),postalCode:new b.f(null===(h=n.billingAddress)||void 0===h?void 0:h.postalCode),countryCode:new b.f(null===(k=n.billingAddress)||void 0===k?void 0:k.countryCode),phoneNumber:new b.f(null===(T=n.billingAddress)||void 0===T?void 0:T.phoneNumber)})),e.orderLineCustomFieldsFormArray=new b.c([]);var C,O=t(n.lines);try{var x=function(){var n,c=C.value,r=new b.i({}),i=t(e.orderLineCustomFields);try{for(i.s();!(n=i.n()).done;){var o=n.value.name;r.addControl(o,new b.f(c.customFields[o]))}}catch(a){i.e(a)}finally{i.f()}r.valueChanges.pipe(Object(j.a)(e.destroy$)).subscribe(function(t){var n=e.modifyOrderInput.adjustOrderLines.find(function(e){return e.orderLineId===c.id});n||(n={orderLineId:c.id,quantity:c.quantity},e.modifyOrderInput.adjustOrderLines.push(n)),e.orderLineCustomFields.length&&(n.customFields=t)}),e.orderLineCustomFieldsFormArray.push(r)};for(O.s();!(C=O.n()).done;)x()}catch(I){O.e(I)}finally{O.f()}}),this.addItemCustomFieldsFormArray=new b.c([]),this.addItemCustomFieldsForm=new b.i({});var n,c=t(this.orderLineCustomFields);try{for(c.s();!(n=c.n()).done;){var r=n.value;this.addItemCustomFieldsForm.addControl(r.name,new b.f)}}catch(i){c.e(i)}finally{c.f()}this.availableCountries$=this.dataService.settings.getAvailableCountries().mapSingle(function(e){return e.countries.items}).pipe(Object(Z.a)(1)),this.dataService.order.getOrderHistory(this.id,{take:1,sort:{createdAt:g.Pb.DESC},filter:{type:{eq:g.mb.ORDER_STATE_TRANSITION}}}).single$.subscribe(function(t){var n=t.order;e.previousState=null==n?void 0:n.history.items[0].data.from})}},{key:"ngOnDestroy",value:function(){this.destroy()}},{key:"transitionToPriorState",value:function(e){var t=this;this.orderTransitionService.transitionToPreModifyingState(e.id,e.nextStates).subscribe(function(e){t.router.navigate([".."],{relativeTo:t.route})})}},{key:"canPreviewChanges",value:function(){var e=this.modifyOrderInput,t=e.addItems,n=e.adjustOrderLines,c=e.surcharges;return!!(null==t?void 0:t.length)||!!(null==c?void 0:c.length)||!!(null==n?void 0:n.length)||this.shippingAddressForm.dirty&&this.shippingAddressForm.valid||this.billingAddressForm.dirty&&this.billingAddressForm.valid}},{key:"isLineModified",value:function(e){var t;return!!(null===(t=this.modifyOrderInput.adjustOrderLines)||void 0===t?void 0:t.find(function(t){return t.orderLineId===e.id&&t.quantity!==e.quantity}))}},{key:"updateLineQuantity",value:function(e,t){var n=this.modifyOrderInput.adjustOrderLines,c=null==n?void 0:n.find(function(t){return t.orderLineId===e.id});c&&+t===e.quantity&&(null==n||n.splice(null==n?void 0:n.indexOf(c),1)),c||(c={orderLineId:e.id,quantity:+t},null==n||n.push(c)),c.quantity=+t}},{key:"updateAddedItemQuantity",value:function(e,t){var n,c=null===(n=this.modifyOrderInput.addItems)||void 0===n?void 0:n.find(function(t){return t.productVariantId===e.productVariantId});c&&(c.quantity=+t)}},{key:"trackByProductVariantId",value:function(e,t){return t.productVariantId}},{key:"getSelectedItemPrice",value:function(e){switch(null==e?void 0:e.priceWithTax.__typename){case"SinglePrice":return e.priceWithTax.value;default:return 0}}},{key:"addItemToOrder",value:function(e){var t,c,r=this;if(e){var i=this.orderLineCustomFields.length?this.addItemCustomFieldsForm.value:void 0,o=null===(t=this.modifyOrderInput.addItems)||void 0===t?void 0:t.find(function(t){return r.isMatchingAddItemRow(t,e,i)});if(o?o.quantity++:(o={productVariantId:e.productVariantId,quantity:1},i&&(o.customFields=i),null===(c=this.modifyOrderInput.addItems)||void 0===c||c.push(o)),i){for(var a=new b.i({}),l=0,d=Object.entries(i);l<d.length;l++){var s=n(d[l],2),u=s[0],f=s[1];a.addControl(u,new b.f(f))}this.addItemCustomFieldsFormArray.push(a),a.valueChanges.pipe(Object(j.a)(this.destroy$)).subscribe(function(e){o&&(o.customFields=e)})}this.addItemCustomFieldsForm.reset({}),this.addItemSelectedVariant=void 0,this.addedVariants.set(e.productVariantId,e)}}},{key:"isMatchingAddItemRow",value:function(e,t,n){return e.productVariantId===t.productVariantId&&JSON.stringify(e.customFields)===JSON.stringify(n)}},{key:"removeAddedItem",value:function(e){this.modifyOrderInput.addItems.splice(e,1),-1<e&&this.addItemCustomFieldsFormArray.removeAt(e)}},{key:"getSurchargePrices",value:function(e){var t=e.priceIncludesTax?e.price:Math.round(e.price*((100+(e.taxRate||0))/100));return{price:e.priceIncludesTax?Math.round(e.price/((100+(e.taxRate||0))/100)):e.price,priceWithTax:t}}},{key:"addSurcharge",value:function(e){var t;null===(t=this.modifyOrderInput.surcharges)||void 0===t||t.push(e),this.surchargeForm.reset({price:0,priceIncludesTax:!0,taxRate:0})}},{key:"removeSurcharge",value:function(e){var t;null===(t=this.modifyOrderInput.surcharges)||void 0===t||t.splice(e,1)}},{key:"previewAndModify",value:function(e){var t,n=this,c=Object.assign(Object.assign(Object.assign(Object.assign({},this.modifyOrderInput),this.billingAddressForm.dirty?{updateBillingAddress:this.billingAddressForm.value}:{}),this.shippingAddressForm.dirty?{updateShippingAddress:this.shippingAddressForm.value}:{}),{dryRun:!0,note:null!==(t=this.note)&&void 0!==t?t:"",options:{recalculateShipping:this.recalculateShipping}}),r=e.totalWithTax;this.dataService.order.modifyOrder(c).pipe(Object(I.a)(function(e){var t=e.modifyOrder;switch(t.__typename){case"Order":return n.modalService.fromComponent(Lc,{size:"xl",closable:!1,locals:{originalTotalWithTax:r,order:t,orderLineCustomFields:n.orderLineCustomFields,modifyOrderInput:c}});case"InsufficientStockError":case"NegativeQuantityError":case"NoChangesSpecifiedError":case"OrderLimitError":case"OrderModificationStateError":case"PaymentMethodMissingError":case"RefundPaymentIdMissingError":return n.notificationService.error(t.message),Object(C.a)(!1);case null:case void 0:return Object(C.a)(!1);default:Object(v.assertNever)(t)}}),Object(I.a)(function(t){if(t&&t.result!==Zc.Cancel){var i=Object.assign(Object.assign({},c),{dryRun:!1});return t.result===Zc.Refund&&(i.refund={paymentId:t.refundPaymentId,reason:t.refundNote}),n.dataService.order.modifyOrder(i).pipe(Object(I.a)(function(t){var c=t.modifyOrder;if("Order"===c.__typename){var i=0<c.totalWithTax-r?"ArrangingAdditionalPayment":n.previousState;return n.dataService.order.transitionToState(e.id,i).pipe(Object(z.a)(!0))}return n.notificationService.error(c.message),k.a}))}return n.dataService.order.getOrder(n.id).mapSingle(function(){return!1})})).subscribe(function(e){e&&n.router.navigate(["../"],{relativeTo:n.route})})}},{key:"setFormValues",value:function(e,t){}}]),r}(g.w);Rc.\u0275fac=function(e){return new(e||Rc)(s.fc(h.e),s.fc(h.a),s.fc(g.Mb),s.fc(s.k),s.fc(g.L),s.fc(g.Eb),s.fc(g.Db),s.fc(Ac))},Rc.\u0275cmp=s.Zb({type:Rc,selectors:[["vdr-order-editor"]],features:[s.Qb],decls:4,vars:6,consts:[[4,"ngIf"],[1,"flex","clr-align-items-center"],[3,"entity"],[3,"state"],[1,"btn","btn-secondary",3,"click"],[1,"clr-row"],[1,"clr-col-lg-8"],[1,"order-table","table"],["class","order-line",3,"is-cancelled","modified",4,"ngFor","ngForOf"],["class","modified",4,"ngFor","ngForOf","ngForTrackBy"],["class","surcharge",4,"ngFor","ngForOf"],["class","surcharge modified",4,"ngFor","ngForOf"],[1,"shipping"],[1,"left","clr-align-middle"],[1,"clr-align-middle"],["colspan","3"],[1,"net-price",3,"title"],[1,"mb2"],[4,"clrIfExpanded"],[1,"clr-col-lg-4","order-cards"],[1,"card"],[1,"card-header"],[1,"card-block"],[1,"clr-control-label"],["name","note","clrTextarea","","required","",3,"ngModel","ngModelChange"],[1,""],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],[1,"card-footer"],[1,"btn","btn-primary",3,"disabled","click"],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","unit-price"],[1,"align-middle","quantity"],["type","number","min","0",3,"value","input"],[3,"line","payments"],[3,"line","orderState"],["class","order-line-custom-field align-middle",4,"ngIf"],[1,"align-middle","total"],[3,"src"],[1,"order-line-custom-field","align-middle"],[4,"ngFor","ngForOf"],["entityName","OrderLine",3,"customField","customFieldsFormGroup","compact"],[1,"modified"],[1,"icon-button",3,"click"],["shape","trash"],[1,"surcharge"],["colspan","2",1,"align-middle","name","left"],[1,"align-middle"],[1,"surcharge","modified"],[1,"mb4",3,"productSelected"],["class","flex mb4",4,"ngIf"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"flex","mb4"],["class","mr4",3,"src",4,"ngIf"],[1,"mr4"],[1,"mr4",3,"src"],["entityName","OrderLine",3,"readonly","customField","customFieldsFormGroup","compact"],[3,"formGroup","submit"],["for","description",3,"label"],["id","description","type","text","formControlName","description"],["for","sku",3,"label"],["id","sku","type","text","formControlName","sku"],["for","price",3,"label"],["id","price","formControlName","price",3,"currencyCode"],["for","priceIncludesTax",3,"label"],["id","priceIncludesTax","type","checkbox","clrCheckbox","","formControlName","priceIncludesTax"],["for","taxRate",3,"label"],["suffix","%"],["id","taxRate","type","number","min","0","max","100","formControlName","taxRate"],["for","taxDescription",3,"label"],["id","taxDescription","type","text","formControlName","taxDescription"],[1,"btn","btn-secondary",3,"disabled"],[3,"formGroup","availableCountries","customFields"]],template:function(e,t){1&e&&(s.Zc(0,Et,10,7,"vdr-action-bar",0),s.yc(1,"async"),s.Zc(2,cn,93,72,"div",0),s.yc(3,"async")),2&e&&(s.Ec("ngIf",s.zc(1,2,t.entity$)),s.Tb(2),s.Ec("ngIf",s.zc(3,4,t.entity$)))},directives:[V.o,g.c,g.e,g.ab,g.Gb,g.f,V.n,W.l,W.b,W.O,W.d,W.N,W.e,W.Q,W.q,W.u,g.eb,b.b,W.H,b.z,b.p,b.s,W.k,b.a,W.i,Pc,Ec,g.I,W.o,W.c,g.Jb,b.E,b.q,b.j,g.db,b.h,g.H,g.i,b.v,g.g],pipes:[V.b,q.d,g.zb,g.r,V.d],styles:[".order-table[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}.order-table[_ngcontent-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .order-table[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}.order-table[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700}.order-table[_ngcontent-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-right:18px}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}.order-table[_ngcontent-%COMP%]   .net-price[_ngcontent-%COMP%], .order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}.order-table[_ngcontent-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px}.order-table[_ngcontent-%COMP%]   .promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted var(--color-text-200);text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}.order-table[_ngcontent-%COMP%]   tr.modified[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background-color:var(--color-warning-100)}"],changeDetection:0}),Rc.ctorParameters=function(){return[{type:h.e},{type:h.a},{type:g.Mb},{type:s.k},{type:g.L},{type:g.Eb},{type:g.Db},{type:Ac}]};var Nc=function(){function e(){m(this,e),this.addNote=new s.u,this.updateNote=new s.u,this.deleteNote=new s.u,this.note="",this.noteIsPrivate=!0,this.expanded=!1,this.type=g.mb}return p(e,[{key:"getDisplayType",value:function(e){if(e.type===g.mb.ORDER_STATE_TRANSITION){if("Delivered"===e.data.to)return"success";if("Cancelled"===e.data.to)return"error"}return e.type===g.mb.ORDER_FULFILLMENT_TRANSITION&&"Delivered"===e.data.to?"success":e.type!==g.mb.ORDER_PAYMENT_TRANSITION||"Declined"!==e.data.to&&"Cancelled"!==e.data.to?e.type===g.mb.ORDER_CANCELLATION?"error":e.type===g.mb.ORDER_REFUND_TRANSITION?"warning":"default":"error"}},{key:"getTimelineIcon",value:function(e){if(e.type===g.mb.ORDER_STATE_TRANSITION){if("Delivered"===e.data.to)return["success-standard","is-solid"];if("Cancelled"===e.data.to)return"ban"}if(e.type===g.mb.ORDER_PAYMENT_TRANSITION&&"Settled"===e.data.to)return"credit-card";if(e.type===g.mb.ORDER_NOTE)return"note";if(e.type===g.mb.ORDER_MODIFIED)return"pencil";if(e.type===g.mb.ORDER_FULFILLMENT_TRANSITION){if("Shipped"===e.data.to)return"truck";if("Delivered"===e.data.to)return"truck"}}},{key:"isFeatured",value:function(e){switch(e.type){case g.mb.ORDER_STATE_TRANSITION:return"Delivered"===e.data.to||"Cancelled"===e.data.to||"Settled"===e.data.to;case g.mb.ORDER_PAYMENT_TRANSITION:return"Settled"===e.data.to||"Cancelled"===e.data.to;case g.mb.ORDER_FULFILLMENT_TRANSITION:return"Delivered"===e.data.to||"Shipped"===e.data.to;case g.mb.ORDER_NOTE:case g.mb.ORDER_MODIFIED:return!0;default:return!1}}},{key:"getFulfillment",value:function(e){if((e.type===g.mb.ORDER_FULFILLMENT||e.type===g.mb.ORDER_FULFILLMENT_TRANSITION)&&this.order.fulfillments)return this.order.fulfillments.find(function(t){return t.id===e.data.fulfillmentId})}},{key:"getPayment",value:function(e){if(e.type===g.mb.ORDER_PAYMENT_TRANSITION&&this.order.payments)return this.order.payments.find(function(t){return t.id===e.data.paymentId})}},{key:"getCancelledItems",value:function(e){var c,r=new Map,i=e.data.orderItemIds,o=t(this.order.lines);try{for(o.s();!(c=o.n()).done;){var a,l=c.value,d=t(l.items);try{for(d.s();!(a=d.n()).done;){var s=a.value;if(i.includes(s.id)){var u=r.get(l.productVariant.name);null!=u?r.set(l.productVariant.name,u+1):r.set(l.productVariant.name,1)}}}catch(f){d.e(f)}finally{d.f()}}}catch(f){o.e(f)}finally{o.f()}return Array.from(r.entries()).map(function(e){var t=n(e,2);return{name:t[0],quantity:t[1]}})}},{key:"getModification",value:function(e){return this.order.modifications.find(function(t){return t.id===e})}},{key:"getName",value:function(e){var t=e.administrator;if(t)return"".concat(t.firstName," ").concat(t.lastName);var n=this.order.customer;return n?"".concat(n.firstName," ").concat(n.lastName):""}},{key:"addNoteToOrder",value:function(){this.addNote.emit({note:this.note,isPublic:!this.noteIsPrivate}),this.note="",this.noteIsPrivate=!0}}]),e}();Nc.\u0275fac=function(e){return new(e||Nc)},Nc.\u0275cmp=s.Zb({type:Nc,selectors:[["vdr-order-history"]],inputs:{order:"order",history:"history"},outputs:{addNote:"addNote",updateNote:"updateNote",deleteNote:"deleteNote"},decls:23,vars:24,consts:[[1,"entry-list"],["iconShape","note","displayType","muted",3,"featured"],[1,"note-entry"],["name","note",1,"note",3,"ngModel","ngModelChange"],[1,"btn","btn-secondary",3,"disabled","click"],[1,"visibility-select"],["type","checkbox","clrCheckbox","",3,"ngModel","ngModelChange"],["class","private",4,"ngIf"],["class","public",4,"ngIf"],[3,"displayType","iconShape","createdAt","name","featured","collapsed","expandClick",4,"ngFor","ngForOf"],[3,"isLast","createdAt","featured"],[1,"title"],[1,"private"],[1,"public"],[3,"displayType","iconShape","createdAt","name","featured","collapsed","expandClick"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","title",4,"ngIf"],[3,"ngIf"],[4,"ngIf"],["colorType","success",4,"ngIf"],["colorType","error",4,"ngIf"],[3,"order","modification"],["colorType","success"],["colorType","error"],[4,"ngIf","ngIfElse"],["regularPaymentTransition",""],[3,"payment","currencyCode"],[3,"label"],[3,"items"],[3,"fulfillmentId","order"],[1,"flex"],[1,"note-text"],["class","note-visibility public",4,"ngIf"],["class","note-visibility private",4,"ngIf"],[1,"flex-spacer"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["vdrDropdownItem","",1,"button",3,"disabled","click"],["shape","edit"],[1,"dropdown-divider"],["shape","trash",1,"is-danger"],[1,"note-visibility","public"],[1,"note-visibility","private"],[3,"routerLink"],[1,"cancelled-coupon-code"]],template:function(e,t){1&e&&(s.lc(0,"h4"),s.bd(1),s.yc(2,"translate"),s.kc(),s.lc(3,"div",0),s.lc(4,"vdr-timeline-entry",1),s.lc(5,"div",2),s.lc(6,"textarea",3),s.vc("ngModelChange",function(e){return t.note=e}),s.kc(),s.lc(7,"button",4),s.vc("click",function(){return t.addNoteToOrder()}),s.bd(8),s.yc(9,"translate"),s.kc(),s.kc(),s.lc(10,"div",5),s.lc(11,"clr-checkbox-wrapper"),s.lc(12,"input",6),s.vc("ngModelChange",function(e){return t.noteIsPrivate=e}),s.kc(),s.lc(13,"label"),s.bd(14),s.yc(15,"translate"),s.kc(),s.kc(),s.Zc(16,rn,3,3,"span",7),s.Zc(17,on,3,3,"span",8),s.kc(),s.kc(),s.Zc(18,Dn,12,17,"vdr-timeline-entry",9),s.lc(19,"vdr-timeline-entry",10),s.lc(20,"div",11),s.bd(21),s.yc(22,"translate"),s.kc(),s.kc(),s.kc()),2&e&&(s.Tb(1),s.cd(s.zc(2,16,"order.order-history")),s.Tb(2),s.Xb("expanded",t.expanded),s.Tb(1),s.Ec("featured",!0),s.Tb(2),s.Ec("ngModel",t.note),s.Tb(1),s.Ec("disabled",!t.note),s.Tb(1),s.dd(" ",s.zc(9,18,"common.add-note")," "),s.Tb(4),s.Ec("ngModel",t.noteIsPrivate),s.Tb(2),s.cd(s.zc(15,20,"order.note-is-private")),s.Tb(2),s.Ec("ngIf",t.noteIsPrivate),s.Tb(1),s.Ec("ngIf",!t.noteIsPrivate),s.Tb(1),s.Ec("ngForOf",t.history),s.Tb(1),s.Ec("isLast",!0)("createdAt",t.order.createdAt)("featured",!0),s.Tb(2),s.dd(" ",s.zc(22,22,"order.history-order-created")," "))},directives:function(){return[g.Vb,g.eb,b.b,b.p,b.s,W.k,b.a,W.i,W.u,V.o,V.n,V.q,V.r,g.lb,Mc,g.D,Gc,g.ub,Xc,Ic,g.T,g.W,W.o,g.V,g.U,h.h]},pipes:function(){return[q.d,g.zb,g.ib]},styles:["[_nghost-%COMP%]{margin-top:48px;display:block}.entry-list[_ngcontent-%COMP%]{margin-top:24px;margin-left:24px;margin-right:12px}.note-entry[_ngcontent-%COMP%]{display:flex;align-items:center}.note-entry[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{flex:1}.note-entry[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.visibility-select[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}.visibility-select[_ngcontent-%COMP%]   .public[_ngcontent-%COMP%]{color:var(--color-warning-500)}.visibility-select[_ngcontent-%COMP%]   .private[_ngcontent-%COMP%]{color:var(--color-success-500)}textarea.note[_ngcontent-%COMP%]{flex:1;height:36px;border-radius:3px;margin-right:6px}.note-text[_ngcontent-%COMP%]{color:var(--color-grey-800);white-space:pre-wrap}.cancelled-coupon-code[_ngcontent-%COMP%]{text-decoration:line-through}.note-visibility[_ngcontent-%COMP%]{text-transform:lowercase}.note-visibility.public[_ngcontent-%COMP%]{color:var(--color-warning-500)}.note-visibility.private[_ngcontent-%COMP%]{color:var(--color-success-500)}"],changeDetection:0}),Nc.propDecorators={order:[{type:s.E}],history:[{type:s.E}],addNote:[{type:s.P}],updateNote:[{type:s.P}],deleteNote:[{type:s.P}]};var $c=function(e){a(n,e);var t=d(n);function n(e,c,r,i,a){var l,d;m(this,n),(d=t.call(this,i,a)).serverConfigService=e,d.dataService=c,d.localStorageService=r,d.searchOrderCodeControl=new b.f(""),d.searchLastNameControl=new b.f(""),d.orderStates=d.serverConfigService.getOrderProcessStates().map(function(e){return e.name}),d.filterPresets=[{name:"open",label:Object(y.a)("order.filter-preset-open"),config:{active:!1,states:d.orderStates.filter(function(e){return"Delivered"!==e&&"Cancelled"!==e&&"Shipped"!==e})}},{name:"shipped",label:Object(y.a)("order.filter-preset-shipped"),config:{active:!1,states:["Shipped"]}},{name:"completed",label:Object(y.a)("order.filter-preset-completed"),config:{active:!1,states:["Delivered","Cancelled"]}},{name:"active",label:Object(y.a)("order.filter-preset-active"),config:{active:!0}}],o((l=u(d),f(n.prototype)),"setQueryFn",l).call(l,function(e,t){return d.dataService.order.getOrders({take:e,skip:t}).refetchOnChannelChange()},function(e){return e.orders},function(e,t){return d.createQueryOptions(e,t,d.searchOrderCodeControl.value,d.searchLastNameControl.value,d.route.snapshot.queryParamMap.get("filter")||"open")});var s=d.localStorageService.get("orderListLastCustomFilters");return s&&d.setQueryParam(s,{replaceUrl:!0}),d}return p(n,[{key:"ngOnInit",value:function(){var e,t=this;o(f(n.prototype),"ngOnInit",this).call(this),this.activePreset$=this.route.queryParamMap.pipe(Object(A.a)(function(e){return e.get("filter")||"open"}),Object(D.a)());var c=Object(O.a)(this.searchOrderCodeControl.valueChanges,this.searchLastNameControl.valueChanges).pipe(Object(L.a)(function(e){return 2<e.length||0===e.length}),Object(R.a)(250));Object(O.a)(c,this.route.queryParamMap).pipe(Object(j.a)(this.destroy$)).subscribe(function(e){t.refresh()});var r=this.route.snapshot.queryParamMap;this.customFilterForm=new b.i({states:new b.f(null!==(e=r.getAll("states"))&&void 0!==e?e:[]),placedAtStart:new b.f(r.get("placedAtStart")),placedAtEnd:new b.f(r.get("placedAtEnd"))})}},{key:"selectFilterPreset",value:function(e){var t,n=null!==(t=this.localStorageService.get("orderListLastCustomFilters"))&&void 0!==t?t:{},c="custom"===e?n:{states:void 0,placedAtStart:void 0,placedAtEnd:void 0};this.setQueryParam(Object.assign({filter:e,page:1},c),{replaceUrl:!0})}},{key:"applyCustomFilters",value:function(){var e=this.customFilterForm.value,t={states:e.states,placedAtStart:e.placedAtStart,placedAtEnd:e.placedAtEnd};this.setQueryParam(Object.assign({filter:"custom"},t)),this.customFilterForm.markAsPristine(),this.localStorageService.set("orderListLastCustomFilters",t)}},{key:"createQueryOptions",value:function(e,t,n,c,r){var i,o=this.filterPresets.find(function(e){return e.name===r}),a={};if(o)null!=o.config.active&&(a.active={eq:o.config.active}),o.config.states&&(a.state={in:o.config.states});else if("custom"===r){var l=this.route.snapshot.queryParamMap,d=null!==(i=l.getAll("states"))&&void 0!==i?i:[],s=l.get("placedAtStart"),u=l.get("placedAtEnd");d.length&&(a.state={in:d}),s&&u?a.orderPlacedAt={between:{start:s,end:u}}:s?a.orderPlacedAt={after:s}:u&&(a.orderPlacedAt={before:u})}return c&&(a.customerLastName={contains:c}),n&&(a.code={contains:n}),{options:{skip:e,take:t,filter:Object.assign({},null!=a?a:{}),sort:{updatedAt:g.Pb.DESC}}}}},{key:"getShippingNames",value:function(e){return e.shippingLines.length?e.shippingLines.map(function(e){return e.shippingMethod.name}).join(", "):""}}]),n}(g.y);$c.\u0275fac=function(e){return new(e||$c)(s.fc(g.Mb),s.fc(g.L),s.fc(g.xb),s.fc(h.e),s.fc(h.a))},$c.\u0275cmp=s.Zb({type:$c,selectors:[["vdr-order-list"]],features:[s.Qb],decls:62,vars:67,consts:[[1,"search-form"],["class","btn-group btn-outline-primary",4,"ngIf"],["type","text","name","searchTerm",1,"search-input",3,"formControl","placeholder"],[1,"custom-filters"],[3,"formGroup"],[1,"flex","align-center"],["appendTo","body","formControlName","states",3,"items","addTag","multiple","placeholder","clearable","searchable"],["ng-option-tmp",""],["ng-label-tmp",""],[1,"btn","btn-secondary",3,"disabled","click"],["shape","filter"],[1,"flex"],["formControlName","placedAtStart"],["formControlName","placedAtEnd"],["locationId","order-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[1,"btn-group","btn-outline-primary"],["class","btn",3,"btn-primary","click",4,"ngFor","ngForOf"],[1,"btn",3,"click"],["shape","angle down"],[1,"ng-value-label"],["aria-hidden","true",1,"ng-value-icon","right",3,"click"],[1,"left","align-middle"],[3,"customer"],[3,"state"],[1,"right","align-middle"],["iconShape","shopping-cart",3,"label","linkTo"]],template:function(e,t){1&e&&(s.lc(0,"vdr-action-bar"),s.lc(1,"vdr-ab-left"),s.lc(2,"div",0),s.Zc(3,Rn,6,6,"div",1),s.yc(4,"async"),s.gc(5,"input",2),s.yc(6,"translate"),s.gc(7,"input",2),s.yc(8,"translate"),s.kc(),s.lc(9,"div",3),s.yc(10,"async"),s.lc(11,"form",4),s.lc(12,"div",5),s.lc(13,"ng-select",6),s.yc(14,"translate"),s.Zc(15,Nn,3,5,"ng-template",7),s.Zc(16,$n,6,5,"ng-template",8),s.kc(),s.lc(17,"button",9),s.vc("click",function(){return t.applyCustomFilters()}),s.bd(18),s.yc(19,"translate"),s.gc(20,"clr-icon",10),s.kc(),s.kc(),s.lc(21,"div",11),s.lc(22,"div"),s.lc(23,"label"),s.bd(24),s.yc(25,"translate"),s.kc(),s.gc(26,"vdr-datetime-picker",12),s.kc(),s.lc(27,"div"),s.lc(28,"label"),s.bd(29),s.yc(30,"translate"),s.kc(),s.gc(31,"vdr-datetime-picker",13),s.kc(),s.kc(),s.kc(),s.kc(),s.kc(),s.lc(32,"vdr-ab-right"),s.gc(33,"vdr-action-bar-items",14),s.kc(),s.kc(),s.lc(34,"vdr-data-table",15),s.vc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),s.yc(35,"async"),s.yc(36,"async"),s.yc(37,"async"),s.yc(38,"async"),s.lc(39,"vdr-dt-column"),s.bd(40),s.yc(41,"translate"),s.kc(),s.lc(42,"vdr-dt-column"),s.bd(43),s.yc(44,"translate"),s.kc(),s.lc(45,"vdr-dt-column"),s.bd(46),s.yc(47,"translate"),s.kc(),s.lc(48,"vdr-dt-column"),s.bd(49),s.yc(50,"translate"),s.kc(),s.lc(51,"vdr-dt-column"),s.bd(52),s.yc(53,"translate"),s.kc(),s.lc(54,"vdr-dt-column"),s.bd(55),s.yc(56,"translate"),s.kc(),s.lc(57,"vdr-dt-column"),s.bd(58),s.yc(59,"translate"),s.kc(),s.gc(60,"vdr-dt-column"),s.Zc(61,Wn,20,23,"ng-template"),s.kc()),2&e&&(s.Tb(3),s.Ec("ngIf",s.zc(4,29,t.activePreset$)),s.Tb(2),s.Ec("formControl",t.searchOrderCodeControl)("placeholder",s.zc(6,31,"order.search-by-order-code")),s.Tb(2),s.Ec("formControl",t.searchLastNameControl)("placeholder",s.zc(8,33,"order.search-by-customer-last-name")),s.Tb(2),s.Xb("expanded","custom"===s.zc(10,35,t.activePreset$)),s.Tb(2),s.Ec("formGroup",t.customFilterForm),s.Tb(2),s.Ec("items",t.orderStates)("addTag",!1)("multiple",!0)("placeholder",s.zc(14,37,"state.all-orders"))("clearable",!0)("searchable",!1),s.Tb(4),s.Ec("disabled",t.customFilterForm.pristine),s.Tb(1),s.dd(" ",s.zc(19,39,"order.apply-filters")," "),s.Tb(6),s.cd(s.zc(25,41,"order.placed-at-start")),s.Tb(5),s.cd(s.zc(30,43,"order.placed-at-end")),s.Tb(5),s.Ec("items",s.zc(35,45,t.items$))("itemsPerPage",s.zc(36,47,t.itemsPerPage$))("totalItems",s.zc(37,49,t.totalItems$))("currentPage",s.zc(38,51,t.currentPage$)),s.Tb(6),s.cd(s.zc(41,53,"common.code")),s.Tb(3),s.cd(s.zc(44,55,"order.customer")),s.Tb(3),s.cd(s.zc(47,57,"order.state")),s.Tb(3),s.cd(s.zc(50,59,"order.total")),s.Tb(3),s.cd(s.zc(53,61,"common.updated-at")),s.Tb(3),s.cd(s.zc(56,63,"order.placed-at")),s.Tb(3),s.cd(s.zc(59,65,"order.shipping")))},directives:[g.c,g.e,V.o,g.eb,b.b,b.p,b.g,b.E,b.q,b.j,$.a,b.h,$.d,$.e,W.o,W.u,g.O,g.f,g.d,g.N,g.M,V.n,g.J,g.Gb,g.Tb],pipes:[V.b,q.d,g.Rb,g.zb,g.Ub,g.Ab],styles:[".search-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:baseline;width:100%;margin-bottom:6px}@media screen and (min-width:768px){.search-form[_ngcontent-%COMP%]{flex-direction:row}}.search-input[_ngcontent-%COMP%]{margin-left:6px;margin-top:6px;min-width:300px}.custom-filters[_ngcontent-%COMP%]{overflow:hidden;max-height:0;padding-bottom:6px}.custom-filters.expanded[_ngcontent-%COMP%]{max-height:none}.custom-filters[_ngcontent-%COMP%] > form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.custom-filters[_ngcontent-%COMP%] > form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%}ng-select[_ngcontent-%COMP%]{flex:1;min-width:200px}ng-select[_ngcontent-%COMP%], ng-select[_ngcontent-%COMP%]     .ng-select-container{height:36px}"],changeDetection:0}),$c.ctorParameters=function(){return[{type:g.Mb},{type:g.L},{type:g.xb},{type:h.e},{type:h.a}]};var qc=function(){function e(){m(this,e),this.settlePayment=new s.u,this.transitionPaymentState=new s.u,this.settleRefund=new s.u}return p(e,[{key:"refundHasMetadata",value:function(e){return!!e&&Object.keys(e.metadata).length>0}},{key:"nextOtherStates",value:function(){return this.payment?this.payment.nextStates.filter(function(e){return"Settled"!==e}):[]}}]),e}();qc.\u0275fac=function(e){return new(e||qc)},qc.\u0275cmp=s.Zb({type:qc,selectors:[["vdr-order-payment-card"]],inputs:{payment:"payment",currencyCode:"currencyCode"},outputs:{settlePayment:"settlePayment",transitionPaymentState:"transitionPaymentState",settleRefund:"settleRefund"},decls:12,vars:9,consts:[[1,"card"],[1,"card-header","payment-header"],[4,"ngIf"],[1,"payment-state"],[3,"state"],[1,"card-block"],[3,"payment","currencyCode"],[4,"ngFor","ngForOf"],["class","card-footer",4,"ngIf"],["shape","redo","dir","down",1,"refund-icon"],[1,"clr-flex-fill"],[3,"label"],[3,"label",4,"ngIf"],[3,"value"],[1,"card-footer"],[1,"btn","btn-sm","btn-primary",3,"click"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"btn",3,"click"],[4,"ngIf","ngIfElse"],["cancel",""],["shape","step-forward-2"],["shape","error-standard",1,"is-error"]],template:function(e,t){1&e&&(s.lc(0,"div",0),s.lc(1,"div",1),s.lc(2,"div"),s.bd(3),s.yc(4,"translate"),s.Zc(5,Qn,2,1,"ng-container",2),s.kc(),s.lc(6,"div",3),s.gc(7,"vdr-payment-state-label",4),s.kc(),s.kc(),s.lc(8,"div",5),s.gc(9,"vdr-payment-detail",6),s.kc(),s.Zc(10,Jn,20,23,"ng-container",7),s.Zc(11,tc,7,2,"div",8),s.kc()),2&e&&(s.Tb(3),s.dd(" ",s.zc(4,7,"order.payment")," "),s.Tb(2),s.Ec("ngIf",t.payment.transactionId),s.Tb(2),s.Ec("state",t.payment.state),s.Tb(2),s.Ec("payment",t.payment)("currencyCode",t.currencyCode),s.Tb(1),s.Ec("ngForOf",t.payment.refunds),s.Tb(1),s.Ec("ngIf",t.payment.nextStates.length))},directives:function(){return[V.o,Bc,Gc,V.n,W.o,Q.b,Jc,g.ub,g.Fb,g.T,g.W,g.V,g.U]},pipes:function(){return[q.d,g.Ab,g.zb,g.Rb]},styles:[".payment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.refund-icon[_ngcontent-%COMP%]{margin-right:6px;color:var(--color-grey-400)}.card-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end}"],changeDetection:0}),qc.propDecorators={payment:[{type:s.E}],currencyCode:[{type:s.E}],settlePayment:[{type:s.P}],transitionPaymentState:[{type:s.P}],settleRefund:[{type:s.P}]};var Vc=72,Wc=function(){function e(t){m(this,e),this.elementRef=t,this.active$=new x.a(!1),this.activeTarget$=new x.a(!1),this.isCancellable=!1,this.cancelledState="Cancelled"}return p(e,[{key:"ngOnChanges",value:function(e){this.isCancellable=!!this.node.to.find(function(e){return"Cancelled"===e.name}),e.active&&this.active$.next(this.active)}},{key:"getPos",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"top";this.elementRef.nativeElement.getBoundingClientRect();var c=null!==(t=null===(e=this.elementRef.nativeElement.querySelector(".node"))||void 0===e?void 0:e.getBoundingClientRect().height)&&void 0!==t?t:0;return{x:10,y:this.index*Vc+("bottom"===n?c:0)}}},{key:"getStyle",value:function(){var e=this.getPos();return{"top.px":e.y,"left.px":e.x}}}]),e}();Wc.\u0275fac=function(e){return new(e||Wc)(s.fc(s.s))},Wc.\u0275cmp=s.Zb({type:Wc,selectors:[["vdr-order-process-node"]],inputs:{node:"node",index:"index",active:"active"},features:[s.Rb],decls:8,vars:15,consts:[[1,"node-wrapper",3,"ngStyle"],[1,"node"],["class","cancelled-wrapper",4,"ngIf"],[1,"cancelled-wrapper"],[1,"cancelled-edge"],["shape","dot-circle"],[1,"cancelled-node"]],template:function(e,t){1&e&&(s.lc(0,"div",0),s.yc(1,"async"),s.lc(2,"div",1),s.yc(3,"async"),s.bd(4),s.yc(5,"translate"),s.yc(6,"stateI18nToken"),s.kc(),s.Zc(7,nc,7,5,"div",2),s.kc()),2&e&&(s.Xb("active",s.zc(1,7,t.active$)),s.Ec("ngStyle",t.getStyle()),s.Tb(2),s.Xb("active-target",s.zc(3,9,t.activeTarget$)),s.Tb(2),s.dd(" ",s.zc(5,11,s.zc(6,13,t.node.name))," "),s.Tb(3),s.Ec("ngIf",t.isCancellable))},directives:[V.p,V.o,W.o],pipes:[V.b,q.d,g.Rb],styles:["[_nghost-%COMP%]{display:block}.node-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:1;display:flex;align-items:center}.node[_ngcontent-%COMP%]{display:inline-block;border:2px solid var(--color-component-border-200);border-radius:3px;padding:3px 6px;z-index:1;background-color:var(--color-component-bg-100);opacity:.7;transition:opacity .2s,background-color .2s,color .2s;cursor:default}.node.active-target[_ngcontent-%COMP%]{border-color:var(--color-primary-500);opacity:.9}.cancelled-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--color-grey-300);transition:color .2s,opacity .2s;opacity:.7}.cancelled-edge[_ngcontent-%COMP%]{width:48px;height:2px;background-color:var(--color-component-bg-300);transition:background-color .2s}clr-icon[_ngcontent-%COMP%]{margin-left:-1px}.cancelled-node[_ngcontent-%COMP%]{margin-left:6px}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{opacity:1}.active[_ngcontent-%COMP%]   .node[_ngcontent-%COMP%]{opacity:1;background-color:var(--color-primary-600);border-color:var(--color-primary-600);color:var(--color-primary-100)}.active[_ngcontent-%COMP%]   .cancelled-wrapper[_ngcontent-%COMP%]{color:var(--color-error-500)}.active[_ngcontent-%COMP%]   .cancelled-edge[_ngcontent-%COMP%]{background-color:var(--color-error-500)}"],changeDetection:0}),Wc.ctorParameters=function(){return[{type:s.s}]},Wc.propDecorators={node:[{type:s.E}],index:[{type:s.E}],active:[{type:s.E}]};var Qc=function(){function e(){m(this,e)}return p(e,[{key:"ngOnInit",value:function(){var e=this;this.active$=this.from.active$.asObservable().pipe(Object(N.a)(function(t){return e.to.activeTarget$.next(t)}))}},{key:"getStyle",value:function(){var e=this.from.index<this.to.index?"down":"up",t=this.from.getPos("down"===e?"bottom":"top"),n=this.to.getPos("down"===e?"top":"bottom"),c=Math.abs(t.x-n.x),r=Math.abs(t.y-n.y),i=Math.sqrt(Math.pow(c,2)+Math.pow(r,2));return Object.assign({"top.px":t.y,"left.px":t.x+("down"===e?10:40)+12*this.index,"height.px":i,"width.px":1},"up"===e?{transform:"rotateZ(180deg)","transform-origin":"top"}:{})}}]),e}();Qc.\u0275fac=function(e){return new(e||Qc)},Qc.\u0275cmp=s.Zb({type:Qc,selectors:[["vdr-order-process-edge"]],inputs:{from:"from",to:"to",index:"index"},decls:3,vars:7,consts:[[1,"edge",3,"ngStyle"],["shape","arrow","flip","vertical",1,"arrow"]],template:function(e,t){1&e&&(s.lc(0,"div",0),s.yc(1,"async"),s.gc(2,"clr-icon",1),s.kc()),2&e&&(s.Xb("active",s.zc(1,5,t.active$)),s.Ec("ngStyle",t.getStyle()),s.Ub("data-from",t.from.node.name)("data-to",t.to.node.name))},directives:[V.p,W.o],pipes:[V.b],styles:[".edge[_ngcontent-%COMP%]{position:absolute;border:1px solid var(--color-component-border-200);background-color:var(--color-component-bg-300);opacity:.3;transition:border .2s,opacity .2s,background-color .2s}.edge.active[_ngcontent-%COMP%]{border-color:var(--color-primary-500);background-color:var(--color-primary-500);opacity:1}.edge.active[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{color:var(--color-primary-500)}.edge[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{position:absolute;bottom:-4px;left:-8px;color:var(--color-grey-300)}"],changeDetection:0}),Qc.propDecorators={from:[{type:s.E}],to:[{type:s.E}],index:[{type:s.E}]};var Hc=function(){function c(e){m(this,c),this.changeDetector=e,this.setActiveState$=new x.a(void 0),this.nodes=[],this.edges=[]}return p(c,[{key:"outerHeight",get:function(){return this.nodes.length*Vc}},{key:"ngOnInit",value:function(){this.setActiveState$.next(this.initialState),this.activeState$=this.setActiveState$.pipe(Object(R.a)(150))}},{key:"ngOnChanges",value:function(e){this.populateNodes()}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(function(){return e.populateEdges()})}},{key:"onMouseOver",value:function(e){this.setActiveState$.next(e)}},{key:"onMouseOut",value:function(){this.setActiveState$.next(this.initialState)}},{key:"getNodeFor",value:function(e){if(this.nodeComponents)return this.nodeComponents.find(function(t){return t.node.name===e})}},{key:"populateNodes",value:function(){var c,r,i,o=this,a=new Map,l=t(this.states);try{for(l.s();!(i=l.n()).done;){var d=i.value;a.set(d.name,{name:d.name,to:[]})}}catch(m){l.e(m)}finally{l.f()}var s,u=t(a.entries());try{var f=function(){var e,i=n(s.value,2),l=i[0],d=i[1],u=t(null!==(r=null===(c=o.states.find(function(e){return e.name===l}))||void 0===c?void 0:c.to)&&void 0!==r?r:[]);try{for(u.s();!(e=u.n()).done;){var f=e.value,b=a.get(f);b&&d.to.push(b)}}catch(m){u.e(m)}finally{u.f()}};for(u.s();!(s=u.n()).done;)f()}catch(m){u.e(m)}finally{u.f()}this.nodes=e(a.values()).filter(function(e){return"Cancelled"!==e.name})}},{key:"populateEdges",value:function(){var n,c=t(this.nodes);try{for(c.s();!(n=c.n()).done;){var r,i=n.value,o=this.getNodeFor(i.name),a=0,l=t(i.to);try{for(l.s();!(r=l.n()).done;){var d=r.value,s=this.getNodeFor(d.name);o&&s&&o!==s&&(this.edges.push({to:s,from:o,index:a}),a++)}}catch(u){l.e(u)}finally{l.f()}}}catch(u){c.e(u)}finally{c.f()}this.edges=e(this.edges),this.changeDetector.markForCheck()}}]),c}();Hc.\u0275fac=function(e){return new(e||Hc)(s.fc(s.k))},Hc.\u0275cmp=s.Zb({type:Hc,selectors:[["vdr-order-process-graph"]],viewQuery:function(e,t){var n;(1&e&&s.gd(Wc,1),2&e)&&(s.Nc(n=s.wc())&&(t.nodeComponents=n))},hostVars:2,hostBindings:function(e,t){2&e&&s.Wc("height",t.outerHeight,"px")},inputs:{states:"states",initialState:"initialState"},features:[s.Rb],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"node","index","active","mouseenter","mouseleave"],[3,"from","to","index"]],template:function(e,t){1&e&&(s.Zc(0,cc,3,5,"ng-container",0),s.Zc(1,rc,2,3,"ng-container",0)),2&e&&(s.Ec("ngForOf",t.nodes),s.Tb(1),s.Ec("ngForOf",t.edges))},directives:[V.n,Wc,Qc],pipes:[V.b],styles:["[_nghost-%COMP%]{display:block;border:1px #ff69b4;margin:20px;padding:12px;position:relative}.state-row[_ngcontent-%COMP%]{display:flex}"],changeDetection:0}),Hc.ctorParameters=function(){return[{type:s.k}]},Hc.propDecorators={states:[{type:s.E}],initialState:[{type:s.E}],nodeComponents:[{type:s.gb,args:[Wc]}],outerHeight:[{type:s.w,args:["style.height.px"]}]};var Uc=function(){function e(){m(this,e),this.orderLineCustomFieldsVisible=!1,this.customFieldsForLine={}}return p(e,[{key:"visibleOrderLineCustomFields",get:function(){return this.orderLineCustomFieldsVisible?this.orderLineCustomFields:[]}},{key:"showElided",get:function(){return!this.orderLineCustomFieldsVisible&&0<this.orderLineCustomFields.length}},{key:"ngOnInit",value:function(){this.orderLineCustomFieldsVisible=this.orderLineCustomFields.length<2,this.getLineCustomFields()}},{key:"toggleOrderLineCustomFields",value:function(){this.orderLineCustomFieldsVisible=!this.orderLineCustomFieldsVisible}},{key:"getLineDiscounts",value:function(e){return e.discounts.filter(function(e){return e.type===g.h.PROMOTION})}},{key:"getLineCustomFields",value:function(){var e,n=this,c=t(this.order.lines);try{var r=function(){var t=e.value,c=new b.i({}),r=n.orderLineCustomFields.map(function(e){var n=t.customFields[e.name];return c.addControl(e.name,new b.f(n)),{config:e,formGroup:c,value:n}}).filter(function(e){return!!n.orderLineCustomFieldsVisible||null!=e.value});n.customFieldsForLine[t.id]=r};for(c.s();!(e=c.n()).done;)r()}catch(i){c.e(i)}finally{c.f()}}},{key:"getPromotionLink",value:function(e){return["/marketing","promotions",e.adjustmentSource.split(":")[1]]}},{key:"getCouponCodeForAdjustment",value:function(e,t){var n=t.adjustmentSource.split(":")[1],c=e.promotions.find(function(e){return e.id===n});if(c)return c.couponCode||void 0}}]),e}();Uc.\u0275fac=function(e){return new(e||Uc)},Uc.\u0275cmp=s.Zb({type:Uc,selectors:[["vdr-order-table"]],inputs:{order:"order",orderLineCustomFields:"orderLineCustomFields"},decls:61,vars:61,consts:[[1,"order-table","table"],[4,"ngFor","ngForOf"],["class","surcharge",4,"ngFor","ngForOf"],["class","order-adjustment",4,"ngFor","ngForOf"],[1,"sub-total"],[1,"left","clr-align-middle"],["colspan","4"],[1,"clr-align-middle"],[1,"net-price",3,"title"],[1,"shipping"],["colspan","3"],[1,"total"],[1,"order-line"],[1,"align-middle","thumb"],[3,"src",4,"ngIf"],[1,"align-middle","name"],[1,"align-middle","sku"],[1,"align-middle","unit-price"],[1,"align-middle","quantity"],[3,"line","payments"],[3,"line","orderState"],[1,"align-middle","total"],[4,"ngIf"],[3,"src"],["vdrDropdownTrigger","",1,"promotions-label"],["class","line-promotion",4,"ngFor","ngForOf"],[1,"line-promotion"],[1,"promotion-name",3,"routerLink"],[1,"promotion-amount"],["colspan","6",1,"custom-fields-row"],[1,"order-line-custom-fields"],["class","custom-field",4,"ngFor","ngForOf"],[1,"custom-field"],[3,"compact","readonly","customField","customFieldsFormGroup"],[1,"surcharge"],["colspan","2",1,"align-middle","name","left"],["colspan","2",1,"align-middle"],[1,"order-adjustment"],["colspan","5",1,"left","clr-align-middle"],[3,"routerLink"]],template:function(e,t){1&e&&(s.lc(0,"table",0),s.lc(1,"thead"),s.lc(2,"tr"),s.gc(3,"th"),s.lc(4,"th"),s.bd(5),s.yc(6,"translate"),s.kc(),s.lc(7,"th"),s.bd(8),s.yc(9,"translate"),s.kc(),s.lc(10,"th"),s.bd(11),s.yc(12,"translate"),s.kc(),s.lc(13,"th"),s.bd(14),s.yc(15,"translate"),s.kc(),s.lc(16,"th"),s.bd(17),s.yc(18,"translate"),s.kc(),s.kc(),s.kc(),s.lc(19,"tbody"),s.Zc(20,fc,28,34,"ng-container",1),s.Zc(21,mc,13,13,"tr",2),s.Zc(22,pc,12,14,"tr",3),s.lc(23,"tr",4),s.lc(24,"td",5),s.bd(25),s.yc(26,"translate"),s.kc(),s.gc(27,"td",6),s.lc(28,"td",7),s.bd(29),s.yc(30,"localeCurrency"),s.lc(31,"div",8),s.yc(32,"translate"),s.bd(33),s.yc(34,"localeCurrency"),s.kc(),s.kc(),s.kc(),s.lc(35,"tr",9),s.lc(36,"td",5),s.bd(37),s.yc(38,"translate"),s.kc(),s.lc(39,"td",7),s.bd(40),s.kc(),s.gc(41,"td",10),s.lc(42,"td",7),s.bd(43),s.yc(44,"localeCurrency"),s.lc(45,"div",8),s.yc(46,"translate"),s.bd(47),s.yc(48,"localeCurrency"),s.kc(),s.kc(),s.kc(),s.lc(49,"tr",11),s.lc(50,"td",5),s.bd(51),s.yc(52,"translate"),s.kc(),s.gc(53,"td",6),s.lc(54,"td",7),s.bd(55),s.yc(56,"localeCurrency"),s.lc(57,"div",8),s.yc(58,"translate"),s.bd(59),s.yc(60,"localeCurrency"),s.kc(),s.kc(),s.kc(),s.kc(),s.kc()),2&e&&(s.Tb(5),s.cd(s.zc(6,21,"order.product-name")),s.Tb(3),s.cd(s.zc(9,23,"order.product-sku")),s.Tb(3),s.cd(s.zc(12,25,"order.unit-price")),s.Tb(3),s.cd(s.zc(15,27,"order.quantity")),s.Tb(3),s.cd(s.zc(18,29,"order.total")),s.Tb(3),s.Ec("ngForOf",t.order.lines),s.Tb(1),s.Ec("ngForOf",t.order.surcharges),s.Tb(1),s.Ec("ngForOf",t.order.discounts),s.Tb(3),s.cd(s.zc(26,31,"order.sub-total")),s.Tb(4),s.dd(" ",s.Ac(30,33,t.order.subTotalWithTax,t.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(32,36,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(34,38,t.order.subTotal,t.order.currencyCode)," "),s.Tb(4),s.cd(s.zc(38,41,"order.shipping")),s.Tb(3),s.cd(null==t.order.shippingLines[0]||null==t.order.shippingLines[0].shippingMethod?null:t.order.shippingLines[0].shippingMethod.name),s.Tb(3),s.dd(" ",s.Ac(44,43,t.order.shippingWithTax,t.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(46,46,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(48,48,t.order.shipping,t.order.currencyCode)," "),s.Tb(4),s.cd(s.zc(52,51,"order.total")),s.Tb(4),s.dd(" ",s.Ac(56,53,t.order.totalWithTax,t.order.currencyCode)," "),s.Tb(2),s.Ec("title",s.zc(58,56,"order.net-price")),s.Tb(2),s.dd(" ",s.Ac(60,58,t.order.total,t.order.currencyCode)," "))},directives:[V.n,V.o,Pc,Ec,g.T,g.W,g.V,h.h,g.I,g.D],pipes:[q.d,g.zb,g.r],styles:[".order-table[_ngcontent-%COMP%]   .is-cancelled[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-decoration:line-through;background-color:var(--color-component-bg-200)}.order-table[_ngcontent-%COMP%]   .sub-total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .order-table[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:1px dashed var(--color-component-border-200)}.order-table[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-weight:700}.order-table[_ngcontent-%COMP%]   td.custom-fields-row[_ngcontent-%COMP%]{border-top-style:dashed;border-top-color:var(--color-grey-200)}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.order-table[_ngcontent-%COMP%]   .order-line-custom-fields[_ngcontent-%COMP%]   .custom-field[_ngcontent-%COMP%]{text-align:start;max-width:200px;overflow:hidden;text-overflow:ellipsis;margin-bottom:6px;margin-right:18px}.order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]{background-color:var(--color-component-bg-100)}.order-table[_ngcontent-%COMP%]   .net-price[_ngcontent-%COMP%], .order-table[_ngcontent-%COMP%]   .order-line-custom-field[_ngcontent-%COMP%]   .custom-field-ellipsis[_ngcontent-%COMP%]{color:var(--color-text-300)}.order-table[_ngcontent-%COMP%]   .net-price[_ngcontent-%COMP%]{font-size:11px}.order-table[_ngcontent-%COMP%]   .promotions-label[_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted var(--color-text-200);text-decoration:underline dotted var(--color-text-200);font-size:11px;margin-top:6px;cursor:pointer;text-transform:lowercase}  .line-promotion{display:flex;justify-content:space-between;padding:6px 12px}  .line-promotion .promotion-amount{margin-left:12px}  .line-promotion .net-price{font-size:11px;color:var(--color-text-300)}"],changeDetection:0}),Uc.propDecorators={order:[{type:s.E}],orderLineCustomFields:[{type:s.E}]};var Gc=function e(){m(this,e)};Gc.\u0275fac=function(e){return new(e||Gc)},Gc.\u0275cmp=s.Zb({type:Gc,selectors:[["vdr-payment-detail"]],inputs:{payment:"payment",currencyCode:"currencyCode"},decls:12,vars:17,consts:[[3,"label"],[3,"label",4,"ngIf"],[3,"value"]],template:function(e,t){1&e&&(s.lc(0,"vdr-labeled-data",0),s.yc(1,"translate"),s.bd(2),s.kc(),s.lc(3,"vdr-labeled-data",0),s.yc(4,"translate"),s.bd(5),s.yc(6,"localeCurrency"),s.kc(),s.Zc(7,gc,3,4,"vdr-labeled-data",1),s.Zc(8,yc,3,4,"vdr-labeled-data",1),s.lc(9,"vdr-labeled-data",0),s.yc(10,"translate"),s.gc(11,"vdr-object-tree",2),s.kc()),2&e&&(s.Ec("label",s.zc(1,8,"order.payment-method")),s.Tb(2),s.dd(" ",t.payment.method,"\n"),s.Tb(1),s.Ec("label",s.zc(4,10,"order.amount")),s.Tb(2),s.dd(" ",s.Ac(6,12,t.payment.amount,t.currencyCode),"\n"),s.Tb(2),s.Ec("ngIf",t.payment.errorMessage),s.Tb(1),s.Ec("ngIf",t.payment.transactionId),s.Tb(1),s.Ec("label",s.zc(10,15,"order.payment-metadata")),s.Tb(2),s.Ec("value",t.payment.metadata))},directives:[g.ub,V.o,g.Fb],pipes:[q.d,g.zb],styles:[""],changeDetection:0}),Gc.propDecorators={payment:[{type:s.E}],currencyCode:[{type:s.E}]};var Bc=function(){function e(){m(this,e)}return p(e,[{key:"chipColorType",get:function(){switch(this.state){case"Authorized":return"warning";case"Settled":return"success";case"Declined":case"Cancelled":return"error"}}}]),e}();Bc.\u0275fac=function(e){return new(e||Bc)},Bc.\u0275cmp=s.Zb({type:Bc,selectors:[["vdr-payment-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(e,t){1&e&&(s.lc(0,"vdr-chip",0),s.yc(1,"translate"),s.Zc(2,vc,1,0,"clr-icon",1),s.bd(3),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.kc()),2&e&&(s.Ec("title",s.zc(1,4,"order.payment-state"))("colorType",t.chipColorType),s.Tb(2),s.Ec("ngIf","Settled"===t.state),s.Tb(1),s.dd(" ",s.zc(4,6,s.zc(5,8,t.state)),"\n"))},directives:[g.D,V.o,W.o],pipes:[q.d,g.Rb],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0}),Bc.propDecorators={state:[{type:s.E}]};var Jc=function(){function e(){m(this,e)}return p(e,[{key:"chipColorType",get:function(){switch(this.state){case"Pending":return"warning";case"Settled":return"success";case"Failed":return"error"}}}]),e}();Jc.\u0275fac=function(e){return new(e||Jc)},Jc.\u0275cmp=s.Zb({type:Jc,selectors:[["vdr-refund-state-label"]],inputs:{state:"state"},decls:6,vars:10,consts:[[3,"title","colorType"],["shape","check-circle",4,"ngIf"],["shape","check-circle"]],template:function(e,t){1&e&&(s.lc(0,"vdr-chip",0),s.yc(1,"translate"),s.Zc(2,hc,1,0,"clr-icon",1),s.bd(3),s.yc(4,"translate"),s.yc(5,"stateI18nToken"),s.kc()),2&e&&(s.Ec("title",s.zc(1,4,"order.payment-state"))("colorType",t.chipColorType),s.Tb(2),s.Ec("ngIf","Settled"===t.state),s.Tb(1),s.dd(" ",s.zc(4,6,s.zc(5,8,t.state)),"\n"))},directives:[g.D,V.o,W.o],pipes:[q.d,g.Rb],styles:["[_nghost-%COMP%]{font-size:14px}"],changeDetection:0}),Jc.propDecorators={state:[{type:s.E}]};var Xc=function e(){m(this,e)};Xc.\u0275fac=function(e){return new(e||Xc)},Xc.\u0275cmp=s.Zb({type:Xc,selectors:[["vdr-simple-item-list"]],inputs:{items:"items"},decls:3,vars:1,consts:[[1,"items-list"],[3,"title",4,"ngFor","ngForOf"],[3,"title"],[1,"quantity"],["shape","times","size","12"]],template:function(e,t){1&e&&(s.lc(0,"div",0),s.lc(1,"ul"),s.Zc(2,kc,5,3,"li",1),s.kc(),s.kc()),2&e&&(s.Tb(2),s.Ec("ngForOf",t.items))},directives:[V.n,W.o],styles:[".items-list[_ngcontent-%COMP%]{font-size:12px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:6px;list-style-type:none;margin-left:2px}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{line-height:14px;text-overflow:ellipsis;overflow:hidden}.items-list[_ngcontent-%COMP%]   .quantity[_ngcontent-%COMP%]{min-width:16px;display:inline-block}"],changeDetection:0}),Xc.propDecorators={items:[{type:s.E}]};var Yc=function(e){a(n,e);var t=d(n);function n(e,c){return m(this,n),t.call(this,e,{__typename:"Order",id:"",code:"",createdAt:"",updatedAt:"",total:0},function(e){return c.order.getOrder(e).mapStream(function(e){return e.order})})}return n}(g.x);Yc.\u0275fac=function(e){return new(e||Yc)(s.sc(h.e),s.sc(g.L))},Yc.\u0275prov=Object(s.bc)({factory:function(){return new Yc(Object(s.sc)(h.e),Object(s.sc)(g.L))},token:Yc,providedIn:"root"}),Yc.ctorParameters=function(){return[{type:h.e},{type:g.L}]};var Kc={breadcrumb:Object(y.a)("breadcrumb.orders")},er={breadcrumb:cr},tr={breadcrumb:rr},nr=[{path:"",component:$c,data:Kc},{path:":id",component:Dc,resolve:Object(g.ac)(Yc),canDeactivate:[g.z],data:er},{path:":id/modify",component:Rc,resolve:Object(g.ac)(Yc),data:tr}];function cr(e,t){return Object(g.cc)({entity:e.entity,id:t.id,breadcrumbKey:"breadcrumb.orders",getName:function(e){return e.code},route:""})}function rr(e,t){return cr(e,t).pipe(Object(A.a)(function(e){var t=e.slice();return t[0].link[0]="../",t[1].link[0]="../orders",t.concat({label:Object(y.a)("breadcrumb.modifying"),link:[""]})}))}var ir=function e(){m(this,e)};ir.\u0275fac=function(e){return new(e||ir)},ir.\u0275mod=s.dc({type:ir}),ir.\u0275inj=s.cc({imports:[[g.Nb,h.i.forChild(nr)]]})}}])}();
//# sourceMappingURL=11-es5.923ef676433fb11e8c6c.js.map