!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,c){if(!e)return;if("string"==typeof e)return t(e,c);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,c)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var c=0,n=new Array(t);c<t;c++)n[c]=e[c];return n}function c(e,t){for(var c=0;c<t.length;c++){var n=t[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var c,n=i(e);if(t){var r=i(this).constructor;c=Reflect.construct(n,arguments,r)}else c=n.apply(this,arguments);return a(this,c)}}function a(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t,c){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,c){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(c):r.value}})(e,t,c||e)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{tB2i:function(t,c,a){"use strict";a.r(c),a.d(c,"HealthCheckComponent",function(){return L}),a.d(c,"JobListComponent",function(){return $}),a.d(c,"JobStateLabelComponent",function(){return U}),a.d(c,"SystemModule",function(){return Q}),a.d(c,"systemRoutes",function(){return Y}),a.d(c,"\u02750",function(){return J}),a.d(c,"\u02751",function(){return G});var d=a("EM62"),b=a("ixhn"),f=a("nIj0"),p=a("sEIs"),m=a("8lHc"),y=a("kuMc"),h=a("xVbo"),g=a("YtkY"),v=a("OxKu"),k=a("2kYt"),T=a("Kej3"),j=a("s2Ay"),E=a("jY47");function w(e,t){1&e&&(d.jc(0),d.bd(1),d.yc(2,"translate"),d.ic()),2&e&&(d.Tb(1),d.dd(" ",d.zc(2,1,"system.health-all-systems-up")," "))}function I(e,t){1&e&&(d.bd(0),d.yc(1,"translate")),2&e&&d.dd(" ",d.zc(1,1,"system.health-error")," ")}var O=function(e,t){return{"is-success":e,"is-danger":t}};function C(e,t){if(1&e&&(d.lc(0,"div",7),d.lc(1,"div",8),d.gc(2,"clr-icon",9),d.kc(),d.lc(3,"div",10),d.Zc(4,w,3,3,"ng-container",11),d.Zc(5,I,2,3,"ng-template",null,12,d.ad),d.lc(7,"div",13),d.bd(8),d.yc(9,"translate"),d.yc(10,"localeDate"),d.yc(11,"async"),d.kc(),d.kc(),d.kc()),2&e){var c=t.ngIf,n=d.Oc(6),r=d.xc();d.Tb(2),d.Ec("ngClass",d.Jc(13,O,"ok"===c,"ok"!==c)),d.Ub("shape","ok"===c?"check-circle":"exclamation-circle"),d.Tb(2),d.Ec("ngIf","ok"===c)("ngIfElse",n),d.Tb(4),d.ed(" ",d.zc(9,6,"system.health-last-checked"),": ",d.Ac(10,8,d.zc(11,11,r.healthCheckService.lastCheck$),"mediumTime")," ")}}function P(e,t){1&e&&(d.jc(0),d.gc(1,"clr-icon",17),d.bd(2),d.yc(3,"translate"),d.ic()),2&e&&(d.Tb(2),d.dd(" ",d.zc(3,1,"system.health-status-up")," "))}function z(e,t){1&e&&(d.gc(0,"clr-icon",18),d.bd(1),d.yc(2,"translate")),2&e&&(d.Tb(1),d.dd(" ",d.zc(2,1,"system.health-status-down")," "))}function S(e,t){if(1&e&&(d.lc(0,"tr"),d.lc(1,"td",14),d.bd(2),d.kc(),d.lc(3,"td",14),d.lc(4,"vdr-chip",15),d.Zc(5,P,4,3,"ng-container",11),d.Zc(6,z,3,3,"ng-template",null,16,d.ad),d.kc(),d.kc(),d.lc(8,"td",14),d.bd(9),d.kc(),d.kc()),2&e){var c=t.$implicit,n=d.Oc(7);d.Tb(2),d.cd(c.key),d.Tb(2),d.Ec("colorType","up"===c.result.status?"success":"error"),d.Tb(1),d.Ec("ngIf","up"===c.result.status)("ngIfElse",n),d.Tb(4),d.cd(c.result.message)}}function x(e,t){1&e&&(d.jc(0),d.bd(1),d.yc(2,"translate"),d.ic()),2&e&&(d.Tb(1),d.dd(" ",d.zc(2,1,"system.all-job-queues")," "))}function D(e,t){if(1&e&&(d.lc(0,"vdr-chip",8),d.bd(1),d.kc()),2&e){var c=d.xc().item;d.Ec("colorFrom",c.name),d.Tb(1),d.cd(c.name)}}function N(e,t){if(1&e&&(d.Zc(0,x,3,3,"ng-container",6),d.Zc(1,D,2,2,"ng-template",null,7,d.ad)),2&e){var c=t.item,n=d.Oc(2);d.Ec("ngIf","all"===c.name)("ngIfElse",n)}}function A(e,t){if(1&e&&(d.lc(0,"vdr-dropdown"),d.lc(1,"button",14),d.yc(2,"translate"),d.gc(3,"clr-icon",15),d.kc(),d.lc(4,"vdr-dropdown-menu"),d.lc(5,"div",16),d.gc(6,"vdr-object-tree",17),d.kc(),d.kc(),d.kc()),2&e){var c=d.xc().item;d.Tb(1),d.Ec("title",d.zc(2,2,"system.job-data")),d.Tb(5),d.Ec("value",c.data)}}function R(e,t){if(1&e&&(d.lc(0,"vdr-dropdown"),d.lc(1,"button",18),d.gc(2,"clr-icon",15),d.bd(3),d.yc(4,"translate"),d.kc(),d.lc(5,"vdr-dropdown-menu"),d.lc(6,"div",16),d.gc(7,"vdr-object-tree",17),d.kc(),d.kc(),d.kc()),2&e){var c=d.xc().item;d.Tb(3),d.dd(" ",d.zc(4,2,"system.job-result")," "),d.Tb(4),d.Ec("value",c.result)}}function Z(e,t){if(1&e&&(d.lc(0,"vdr-dropdown"),d.lc(1,"button",18),d.gc(2,"clr-icon",19),d.bd(3),d.yc(4,"translate"),d.kc(),d.lc(5,"vdr-dropdown-menu"),d.lc(6,"div",16),d.bd(7),d.kc(),d.kc(),d.kc()),2&e){var c=d.xc().item;d.Tb(3),d.dd(" ",d.zc(4,2,"system.job-error")," "),d.Tb(4),d.dd(" ",c.error," ")}}var F=function(){return["DeleteSettings","DeleteSystem"]};function _(e,t){if(1&e){var c=d.mc();d.lc(0,"vdr-dropdown"),d.lc(1,"button",20),d.gc(2,"clr-icon",21),d.kc(),d.lc(3,"vdr-dropdown-menu",22),d.lc(4,"button",23),d.vc("click",function(){d.Sc(c);var e=d.xc().item;return d.xc().cancelJob(e.id)}),d.yc(5,"hasPermission"),d.gc(6,"clr-icon",24),d.bd(7),d.yc(8,"translate"),d.kc(),d.kc(),d.kc()}2&e&&(d.Tb(4),d.Ec("disabled",!d.zc(5,2,d.Hc(6,F))),d.Tb(3),d.dd(" ",d.zc(8,4,"common.cancel")," "))}function M(e,t){if(1&e&&(d.lc(0,"td",9),d.gc(1,"vdr-entity-info",10),d.kc(),d.lc(2,"td",9),d.Zc(3,A,7,4,"vdr-dropdown",11),d.lc(4,"vdr-chip",8),d.bd(5),d.kc(),d.kc(),d.lc(6,"td",9),d.bd(7),d.yc(8,"timeAgo"),d.kc(),d.lc(9,"td",9),d.gc(10,"vdr-job-state-label",12),d.kc(),d.lc(11,"td",9),d.bd(12),d.yc(13,"duration"),d.kc(),d.lc(14,"td",9),d.Zc(15,R,8,4,"vdr-dropdown",11),d.Zc(16,Z,8,4,"vdr-dropdown",11),d.kc(),d.lc(17,"td",13),d.Zc(18,_,9,7,"vdr-dropdown",11),d.kc()),2&e){var c=t.item,n=d.xc();d.Tb(1),d.Ec("entity",c),d.Tb(2),d.Ec("ngIf",c.data),d.Tb(1),d.Ec("colorFrom",c.queueName),d.Tb(1),d.cd(c.queueName),d.Tb(2),d.cd(d.zc(8,10,c.createdAt)),d.Tb(3),d.Ec("job",c),d.Tb(2),d.cd(d.zc(13,12,c.duration)),d.Tb(3),d.Ec("ngIf",n.hasResult(c)),d.Tb(1),d.Ec("ngIf",c.error),d.Tb(2),d.Ec("ngIf",!c.isSettled&&"FAILED"!==c.state)}}function q(e,t){if(1&e&&(d.lc(0,"span",2),d.bd(1),d.yc(2,"percent"),d.kc()),2&e){var c=d.xc();d.Tb(1),d.dd(" ",d.zc(2,1,c.job.progress/100)," ")}}var L=function e(t){u(this,e),this.healthCheckService=t};L.\u0275fac=function(e){return new(e||L)(d.fc(b.jb))},L.\u0275cmp=d.Zb({type:L,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(e,t){1&e&&(d.lc(0,"vdr-action-bar"),d.lc(1,"vdr-ab-left"),d.Zc(2,C,12,16,"div",0),d.yc(3,"async"),d.kc(),d.lc(4,"vdr-ab-right"),d.gc(5,"vdr-action-bar-items",1),d.lc(6,"button",2),d.vc("click",function(){return t.healthCheckService.refresh()}),d.gc(7,"clr-icon",3),d.bd(8),d.yc(9,"translate"),d.kc(),d.kc(),d.kc(),d.lc(10,"table",4),d.lc(11,"thead"),d.lc(12,"tr"),d.lc(13,"th",5),d.bd(14),d.yc(15,"translate"),d.kc(),d.lc(16,"th",5),d.bd(17),d.yc(18,"translate"),d.kc(),d.lc(19,"th",5),d.bd(20),d.yc(21,"translate"),d.kc(),d.kc(),d.kc(),d.lc(22,"tbody"),d.Zc(23,S,10,5,"tr",6),d.yc(24,"async"),d.kc(),d.kc()),2&e&&(d.Tb(2),d.Ec("ngIf",d.zc(3,6,t.healthCheckService.status$)),d.Tb(6),d.dd(" ",d.zc(9,8,"system.health-refresh")," "),d.Tb(6),d.dd(" ",d.zc(15,10,"common.name")," "),d.Tb(3),d.dd(" ",d.zc(18,12,"system.health-status")," "),d.Tb(3),d.dd(" ",d.zc(21,14,"system.health-message")," "),d.Tb(3),d.Ec("ngForOf",d.zc(24,16,t.healthCheckService.details$)))},directives:[b.c,b.e,k.o,b.f,b.d,T.o,k.n,k.m,b.D],pipes:[k.b,j.d,b.Ab],styles:[".system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:var(--color-grey-500)}"],changeDetection:0}),L.ctorParameters=function(){return[{type:b.jb}]};var $=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(a,t);var c=o(a);function a(e,t,n,r,o){var d,p;return u(this,a),(p=c.call(this,r,o)).dataService=e,p.modalService=t,p.notificationService=n,p.liveUpdate=new f.f(!0),p.hideSettled=new f.f(!0),p.queueFilter=new f.f("all"),l((d=s(p),i(a.prototype)),"setQueryFn",d).call(d,function(){var e;return(e=p.dataService.settings).getAllJobs.apply(e,arguments)},function(e){return e.jobs},function(e,t){var c="all"===p.queueFilter.value?null:{queueName:{eq:p.queueFilter.value}},n=p.hideSettled.value;return{options:{skip:e,take:t,filter:Object.assign(Object.assign({},c),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:b.Pb.DESC}}}}),p}return n(a,[{key:"ngOnInit",value:function(){var t=this;l(i(a.prototype),"ngOnInit",this).call(this),Object(m.a)(5e3,2e3).pipe(Object(y.a)(this.destroy$),Object(h.a)(function(){return t.liveUpdate.value})).subscribe(function(){t.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(function(e){return e.jobQueues}).pipe(Object(g.a)(function(t){return[{name:"all",running:!0}].concat(e(t))}))}},{key:"hasResult",value:function(e){var t=e.result;return null!=t&&("object"!=typeof t||Object.keys(t).length>0)}},{key:"cancelJob",value:function(e){var t=this;this.dataService.settings.cancelJob(e).subscribe(function(){return t.refresh()})}}]),a}(b.y);$.\u0275fac=function(e){return new(e||$)(d.fc(b.L),d.fc(b.Db),d.fc(b.Eb),d.fc(p.e),d.fc(p.a))},$.\u0275cmp=d.Zb({type:$,selectors:[["vdr-job-list"]],features:[d.Qb],decls:41,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],[1,"right","align-middle"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","ban",1,"is-danger"]],template:function(e,t){1&e&&(d.lc(0,"vdr-action-bar"),d.lc(1,"vdr-ab-left"),d.lc(2,"clr-checkbox-container"),d.lc(3,"clr-checkbox-wrapper"),d.gc(4,"input",0),d.lc(5,"label"),d.bd(6),d.yc(7,"translate"),d.kc(),d.kc(),d.lc(8,"clr-checkbox-wrapper"),d.lc(9,"input",1),d.vc("change",function(){return t.refresh()}),d.kc(),d.lc(10,"label"),d.bd(11),d.yc(12,"translate"),d.kc(),d.kc(),d.kc(),d.kc(),d.lc(13,"vdr-ab-right"),d.lc(14,"ng-select",2),d.vc("change",function(){return t.refresh()}),d.yc(15,"async"),d.Zc(16,N,3,2,"ng-template",3),d.kc(),d.gc(17,"vdr-action-bar-items",4),d.kc(),d.kc(),d.lc(18,"vdr-data-table",5),d.vc("pageChange",function(e){return t.setPageNumber(e)})("itemsPerPageChange",function(e){return t.setItemsPerPage(e)}),d.yc(19,"async"),d.yc(20,"async"),d.yc(21,"async"),d.yc(22,"async"),d.gc(23,"vdr-dt-column"),d.lc(24,"vdr-dt-column"),d.bd(25),d.yc(26,"translate"),d.kc(),d.lc(27,"vdr-dt-column"),d.bd(28),d.yc(29,"translate"),d.kc(),d.lc(30,"vdr-dt-column"),d.bd(31),d.yc(32,"translate"),d.kc(),d.lc(33,"vdr-dt-column"),d.bd(34),d.yc(35,"translate"),d.kc(),d.lc(36,"vdr-dt-column"),d.bd(37),d.yc(38,"translate"),d.kc(),d.gc(39,"vdr-dt-column"),d.Zc(40,M,19,14,"ng-template"),d.kc()),2&e&&(d.Tb(4),d.Ec("formControl",t.liveUpdate),d.Tb(2),d.cd(d.zc(7,21,"common.live-update")),d.Tb(3),d.Ec("formControl",t.hideSettled),d.Tb(2),d.cd(d.zc(12,23,"system.hide-settled-jobs")),d.Tb(3),d.Ec("addTag",!1)("items",d.zc(15,25,t.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",t.queueFilter),d.Tb(4),d.Ec("items",d.zc(19,27,t.items$))("itemsPerPage",d.zc(20,29,t.itemsPerPage$))("totalItems",d.zc(21,31,t.totalItems$))("currentPage",d.zc(22,33,t.currentPage$)),d.Tb(7),d.cd(d.zc(26,35,"system.job-queue-name")),d.Tb(3),d.cd(d.zc(29,37,"common.created-at")),d.Tb(3),d.cd(d.zc(32,39,"system.job-state")),d.Tb(3),d.cd(d.zc(35,41,"system.job-duration")),d.Tb(3),d.cd(d.zc(38,43,"system.job-result")))},directives:function(){return[b.c,b.e,T.j,T.k,b.eb,f.a,T.i,f.p,f.g,T.u,b.f,E.a,E.e,E.d,b.d,b.N,b.M,k.o,b.D,b.ab,U,b.T,b.W,T.o,b.V,b.Fb,b.U]},pipes:function(){return[j.d,k.b,b.Ub,b.X,b.ib]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),$.ctorParameters=function(){return[{type:b.L},{type:b.Db},{type:b.Eb},{type:p.e},{type:p.a}]};var U=function(){function e(){u(this,e)}return n(e,[{key:"iconShape",get:function(){switch(this.job.state){case b.tb.COMPLETED:return"check-circle";case b.tb.FAILED:return"exclamation-circle";case b.tb.CANCELLED:return"ban";case b.tb.PENDING:case b.tb.RETRYING:return"hourglass";case b.tb.RUNNING:return"sync"}}},{key:"colorType",get:function(){switch(this.job.state){case b.tb.COMPLETED:return"success";case b.tb.FAILED:case b.tb.CANCELLED:return"error";case b.tb.PENDING:case b.tb.RETRYING:return"";case b.tb.RUNNING:return"warning"}}}]),e}();U.\u0275fac=function(e){return new(e||U)},U.\u0275cmp=d.Zb({type:U,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(e,t){1&e&&(d.lc(0,"vdr-chip",0),d.gc(1,"clr-icon"),d.bd(2),d.yc(3,"titlecase"),d.Zc(4,q,3,3,"span",1),d.kc()),2&e&&(d.Ec("colorType",t.colorType),d.Tb(1),d.Ub("shape",t.iconShape),d.Tb(1),d.dd(" ",d.zc(3,4,t.job.state)," "),d.Tb(2),d.Ec("ngIf","RUNNING"===t.job.state))},directives:[b.D,T.o,k.o],pipes:[k.y,k.v],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),U.propDecorators={job:[{type:d.E}]};var J={breadcrumb:Object(v.a)("breadcrumb.job-queue")},G={breadcrumb:Object(v.a)("breadcrumb.system-status")},Y=[{path:"jobs",component:$,data:J},{path:"system-status",component:L,data:G}],Q=function e(){u(this,e)};Q.\u0275fac=function(e){return new(e||Q)},Q.\u0275mod=d.dc({type:Q}),Q.\u0275inj=d.cc({imports:[[b.Nb,p.i.forChild(Y)]]})}}])}();
//# sourceMappingURL=13-es5.68f2bd6e6a011e1cc351.js.map