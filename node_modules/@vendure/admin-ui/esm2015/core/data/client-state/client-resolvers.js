import { GET_NEWTORK_STATUS, GET_UI_STATE, GET_USER_STATUS } from '../definitions/client-definitions';
const ɵ0 = (_, args, { cache }) => {
    return updateRequestsInFlight(cache, 1);
}, ɵ1 = (_, args, { cache }) => {
    return updateRequestsInFlight(cache, -1);
}, ɵ2 = (_, args, { cache }) => {
    const { input: { username, loginTime, channels, activeChannelId }, } = args;
    // tslint:disable-next-line:no-non-null-assertion
    const permissions = channels.find(c => c.id === activeChannelId).permissions;
    const data = {
        userStatus: {
            __typename: 'UserStatus',
            username,
            loginTime,
            isLoggedIn: true,
            permissions,
            channels,
            activeChannelId,
        },
    };
    cache.writeQuery({ query: GET_USER_STATUS, data });
    return data.userStatus;
}, ɵ3 = (_, args, { cache }) => {
    const data = {
        userStatus: {
            __typename: 'UserStatus',
            username: '',
            loginTime: '',
            isLoggedIn: false,
            permissions: [],
            channels: [],
            activeChannelId: null,
        },
    };
    cache.writeQuery({ query: GET_USER_STATUS, data });
    return data.userStatus;
}, ɵ4 = (_, args, { cache }) => {
    // tslint:disable-next-line:no-non-null-assertion
    const previous = cache.readQuery({ query: GET_UI_STATE });
    const data = {
        uiState: {
            __typename: 'UiState',
            language: args.languageCode,
            contentLanguage: previous.uiState.contentLanguage,
            theme: previous.uiState.theme,
        },
    };
    cache.writeQuery({ query: GET_UI_STATE, data });
    return args.languageCode;
}, ɵ5 = (_, args, { cache }) => {
    // tslint:disable-next-line:no-non-null-assertion
    const previous = cache.readQuery({ query: GET_UI_STATE });
    const data = {
        uiState: {
            __typename: 'UiState',
            language: previous.uiState.language,
            contentLanguage: args.languageCode,
            theme: previous.uiState.theme,
        },
    };
    cache.writeQuery({ query: GET_UI_STATE, data });
    return args.languageCode;
}, ɵ6 = (_, args, { cache }) => {
    // tslint:disable-next-line:no-non-null-assertion
    const previous = cache.readQuery({ query: GET_UI_STATE });
    const data = {
        uiState: {
            __typename: 'UiState',
            language: previous.uiState.language,
            contentLanguage: previous.uiState.contentLanguage,
            theme: args.theme,
        },
    };
    cache.writeQuery({ query: GET_UI_STATE, data });
    return args.theme;
}, ɵ7 = (_, args, { cache }) => {
    // tslint:disable-next-line:no-non-null-assertion
    const previous = cache.readQuery({ query: GET_USER_STATUS });
    const activeChannel = previous.userStatus.channels.find(c => c.id === args.channelId);
    if (!activeChannel) {
        throw new Error('setActiveChannel: Could not find Channel with ID ' + args.channelId);
    }
    const permissions = activeChannel.permissions;
    const data = {
        userStatus: Object.assign(Object.assign({}, previous.userStatus), { permissions, activeChannelId: activeChannel.id }),
    };
    cache.writeQuery({ query: GET_USER_STATUS, data });
    return data.userStatus;
}, ɵ8 = (_, args, { cache }) => {
    // tslint:disable-next-line:no-non-null-assertion
    const previous = cache.readQuery({ query: GET_USER_STATUS });
    const data = {
        userStatus: Object.assign(Object.assign({}, previous.userStatus), { channels: Array.isArray(args.channels) ? args.channels : [args.channels] }),
    };
    cache.writeQuery({ query: GET_USER_STATUS, data });
    return data.userStatus;
};
export const clientResolvers = {
    Mutation: {
        requestStarted: ɵ0,
        requestCompleted: ɵ1,
        setAsLoggedIn: ɵ2,
        setAsLoggedOut: ɵ3,
        setUiLanguage: ɵ4,
        setContentLanguage: ɵ5,
        setUiTheme: ɵ6,
        setActiveChannel: ɵ7,
        updateUserChannels: ɵ8,
    },
};
function updateRequestsInFlight(cache, increment) {
    const previous = cache.readQuery({ query: GET_NEWTORK_STATUS });
    const inFlightRequests = previous ? previous.networkStatus.inFlightRequests + increment : increment;
    const data = {
        networkStatus: {
            __typename: 'NetworkStatus',
            inFlightRequests,
        },
    };
    cache.writeQuery({ query: GET_NEWTORK_STATUS, data });
    return inFlightRequests;
}
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7, ɵ8 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2xpZW50LXJlc29sdmVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29yZS9zcmMvZGF0YS9jbGllbnQtc3RhdGUvY2xpZW50LXJlc29sdmVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFlQSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsWUFBWSxFQUFFLGVBQWUsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO1dBZ0I5RSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBVSxFQUFFO0lBQzNDLE9BQU8sc0JBQXNCLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzVDLENBQUMsT0FDaUIsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQVUsRUFBRTtJQUM3QyxPQUFPLHNCQUFzQixDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzdDLENBQUMsT0FDYyxDQUFDLENBQUMsRUFBRSxJQUE2QixFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQTRCLEVBQUU7SUFDckYsTUFBTSxFQUNGLEtBQUssRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLGVBQWUsRUFBRSxHQUM1RCxHQUFHLElBQUksQ0FBQztJQUNULGlEQUFpRDtJQUNqRCxNQUFNLFdBQVcsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxlQUFlLENBQUUsQ0FBQyxXQUFXLENBQUM7SUFDOUUsTUFBTSxJQUFJLEdBQStCO1FBQ3JDLFVBQVUsRUFBRTtZQUNSLFVBQVUsRUFBRSxZQUFZO1lBQ3hCLFFBQVE7WUFDUixTQUFTO1lBQ1QsVUFBVSxFQUFFLElBQUk7WUFDaEIsV0FBVztZQUNYLFFBQVE7WUFDUixlQUFlO1NBQ2xCO0tBQ0osQ0FBQztJQUNGLEtBQUssQ0FBQyxVQUFVLENB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QUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FDM0U7S0FDSixDQUFDO0lBQ0YsS0FBSyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUNuRCxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7QUFDM0IsQ0FBQztBQWxIVCxNQUFNLENBQUMsTUFBTSxlQUFlLEdBQXVCO0lBQy9DLFFBQVEsRUFBRTtRQUNOLGNBQWMsSUFFYjtRQUNELGdCQUFnQixJQUVmO1FBQ0QsYUFBYSxJQW1CWjtRQUNELGNBQWMsSUFjYjtRQUNELGFBQWEsSUFhWjtRQUNELGtCQUFrQixJQWFqQjtRQUNELFVBQVUsSUFhVDtRQUNELGdCQUFnQixJQWlCZjtRQUNELGtCQUFrQixJQVdqQjtLQUNKO0NBQ0osQ0FBQztBQUVGLFNBQVMsc0JBQXNCLENBQUMsS0FBb0IsRUFBRSxTQUFpQjtJQUNuRSxNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUF5QixFQUFFLEtBQUssRUFBRSxrQkFBa0IsRUFBRSxDQUFDLENBQUM7SUFDeEYsTUFBTSxnQkFBZ0IsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFDcEcsTUFBTSxJQUFJLEdBQTJCO1FBQ2pDLGFBQWEsRUFBRTtZQUNYLFVBQVUsRUFBRSxlQUFlO1lBQzNCLGdCQUFnQjtTQUNuQjtLQUNKLENBQUM7SUFDRixLQUFLLENBQUMsVUFBVSxDQUFDLEVBQUUsS0FBSyxFQUFFLGtCQUFrQixFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDdEQsT0FBTyxnQkFBZ0IsQ0FBQztBQUM1QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5NZW1vcnlDYWNoZSB9IGZyb20gJ0BhcG9sbG8vY2xpZW50L2NvcmUnO1xyXG5cclxuaW1wb3J0IHtcclxuICAgIEdldE5ldHdvcmtTdGF0dXMsXHJcbiAgICBHZXRVaVN0YXRlLFxyXG4gICAgR2V0VXNlclN0YXR1cyxcclxuICAgIExhbmd1YWdlQ29kZSxcclxuICAgIFNldEFjdGl2ZUNoYW5uZWwsXHJcbiAgICBTZXRBc0xvZ2dlZEluLFxyXG4gICAgU2V0Q29udGVudExhbmd1YWdlLFxyXG4gICAgU2V0VWlMYW5ndWFnZSxcclxuICAgIFNldFVpVGhlbWUsXHJcbiAgICBVcGRhdGVVc2VyQ2hhbm5lbHMsXHJcbiAgICBVc2VyU3RhdHVzLFxyXG59IGZyb20gJy4uLy4uL2NvbW1vbi9nZW5lcmF0ZWQtdHlwZXMnO1xyXG5pbXBvcnQgeyBHRVRfTkVXVE9SS19TVEFUVVMsIEdFVF9VSV9TVEFURSwgR0VUX1VTRVJfU1RBVFVTIH0gZnJvbSAnLi4vZGVmaW5pdGlvbnMvY2xpZW50LWRlZmluaXRpb25zJztcclxuXHJcbmV4cG9ydCB0eXBlIFJlc29sdmVyQ29udGV4dCA9IHtcclxuICAgIGNhY2hlOiBJbk1lbW9yeUNhY2hlO1xyXG4gICAgb3B0aW1pc3RpY1Jlc3BvbnNlOiBhbnk7XHJcbiAgICBnZXRDYWNoZUtleTogKHN0b3JlT2JqOiBhbnkpID0+IHN0cmluZztcclxufTtcclxuXHJcbmV4cG9ydCB0eXBlIFJlc29sdmVyRGVmaW5pdGlvbiA9IHtcclxuICAgIE11dGF0aW9uOiB7XHJcbiAgICAgICAgW25hbWU6IHN0cmluZ106IChyb290VmFsdWU6IGFueSwgYXJnczogYW55LCBjb250ZXh0OiBSZXNvbHZlckNvbnRleHQsIGluZm8/OiBhbnkpID0+IGFueTtcclxuICAgIH07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgY2xpZW50UmVzb2x2ZXJzOiBSZXNvbHZlckRlZmluaXRpb24gPSB7XHJcbiAgICBNdXRhdGlvbjoge1xyXG4gICAgICAgIHJlcXVlc3RTdGFydGVkOiAoXywgYXJncywgeyBjYWNoZSB9KTogbnVtYmVyID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZVJlcXVlc3RzSW5GbGlnaHQoY2FjaGUsIDEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcmVxdWVzdENvbXBsZXRlZDogKF8sIGFyZ3MsIHsgY2FjaGUgfSk6IG51bWJlciA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVSZXF1ZXN0c0luRmxpZ2h0KGNhY2hlLCAtMSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXRBc0xvZ2dlZEluOiAoXywgYXJnczogU2V0QXNMb2dnZWRJbi5WYXJpYWJsZXMsIHsgY2FjaGUgfSk6IEdldFVzZXJTdGF0dXMuVXNlclN0YXR1cyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHtcclxuICAgICAgICAgICAgICAgIGlucHV0OiB7IHVzZXJuYW1lLCBsb2dpblRpbWUsIGNoYW5uZWxzLCBhY3RpdmVDaGFubmVsSWQgfSxcclxuICAgICAgICAgICAgfSA9IGFyZ3M7XHJcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1ub24tbnVsbC1hc3NlcnRpb25cclxuICAgICAgICAgICAgY29uc3QgcGVybWlzc2lvbnMgPSBjaGFubmVscy5maW5kKGMgPT4gYy5pZCA9PT0gYWN0aXZlQ2hhbm5lbElkKSEucGVybWlzc2lvbnM7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGE6IHsgdXNlclN0YXR1czogVXNlclN0YXR1cyB9ID0ge1xyXG4gICAgICAgICAgICAgICAgdXNlclN0YXR1czoge1xyXG4gICAgICAgICAgICAgICAgICAgIF9fdHlwZW5hbWU6ICdVc2VyU3RhdHVzJyxcclxuICAgICAgICAgICAgICAgICAgICB1c2VybmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBsb2dpblRpbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNMb2dnZWRJbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9ucyxcclxuICAgICAgICAgICAgICAgICAgICBjaGFubmVscyxcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVDaGFubmVsSWQsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYWNoZS53cml0ZVF1ZXJ5KHsgcXVlcnk6IEdFVF9VU0VSX1NUQVRVUywgZGF0YSB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEudXNlclN0YXR1cztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldEFzTG9nZ2VkT3V0OiAoXywgYXJncywgeyBjYWNoZSB9KTogR2V0VXNlclN0YXR1cy5Vc2VyU3RhdHVzID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YTogR2V0VXNlclN0YXR1cy5RdWVyeSA9IHtcclxuICAgICAgICAgICAgICAgIHVzZXJTdGF0dXM6IHtcclxuICAgICAgICAgICAgICAgICAgICBfX3R5cGVuYW1lOiAnVXNlclN0YXR1cycsXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6ICcnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxvZ2luVGltZTogJycsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNMb2dnZWRJbjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbnM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWxzOiBbXSxcclxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVDaGFubmVsSWQ6IG51bGwsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYWNoZS53cml0ZVF1ZXJ5KHsgcXVlcnk6IEdFVF9VU0VSX1NUQVRVUywgZGF0YSB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGEudXNlclN0YXR1cztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldFVpTGFuZ3VhZ2U6IChfLCBhcmdzOiBTZXRVaUxhbmd1YWdlLlZhcmlhYmxlcywgeyBjYWNoZSB9KTogTGFuZ3VhZ2VDb2RlID0+IHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW5vbi1udWxsLWFzc2VydGlvblxyXG4gICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IGNhY2hlLnJlYWRRdWVyeTxHZXRVaVN0YXRlLlF1ZXJ5Pih7IHF1ZXJ5OiBHRVRfVUlfU1RBVEUgfSkhO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhOiBHZXRVaVN0YXRlLlF1ZXJ5ID0ge1xyXG4gICAgICAgICAgICAgICAgdWlTdGF0ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIF9fdHlwZW5hbWU6ICdVaVN0YXRlJyxcclxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZTogYXJncy5sYW5ndWFnZUNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudExhbmd1YWdlOiBwcmV2aW91cy51aVN0YXRlLmNvbnRlbnRMYW5ndWFnZSxcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZTogcHJldmlvdXMudWlTdGF0ZS50aGVtZSxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNhY2hlLndyaXRlUXVlcnkoeyBxdWVyeTogR0VUX1VJX1NUQVRFLCBkYXRhIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gYXJncy5sYW5ndWFnZUNvZGU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXRDb250ZW50TGFuZ3VhZ2U6IChfLCBhcmdzOiBTZXRDb250ZW50TGFuZ3VhZ2UuVmFyaWFibGVzLCB7IGNhY2hlIH0pOiBMYW5ndWFnZUNvZGUgPT4ge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tbm9uLW51bGwtYXNzZXJ0aW9uXHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzID0gY2FjaGUucmVhZFF1ZXJ5PEdldFVpU3RhdGUuUXVlcnk+KHsgcXVlcnk6IEdFVF9VSV9TVEFURSB9KSE7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGE6IEdldFVpU3RhdGUuUXVlcnkgPSB7XHJcbiAgICAgICAgICAgICAgICB1aVN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgX190eXBlbmFtZTogJ1VpU3RhdGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiBwcmV2aW91cy51aVN0YXRlLmxhbmd1YWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRMYW5ndWFnZTogYXJncy5sYW5ndWFnZUNvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6IHByZXZpb3VzLnVpU3RhdGUudGhlbWUsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYWNoZS53cml0ZVF1ZXJ5KHsgcXVlcnk6IEdFVF9VSV9TVEFURSwgZGF0YSB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGFyZ3MubGFuZ3VhZ2VDb2RlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0VWlUaGVtZTogKF8sIGFyZ3M6IFNldFVpVGhlbWUuVmFyaWFibGVzLCB7IGNhY2hlIH0pOiBzdHJpbmcgPT4ge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tbm9uLW51bGwtYXNzZXJ0aW9uXHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzID0gY2FjaGUucmVhZFF1ZXJ5PEdldFVpU3RhdGUuUXVlcnk+KHsgcXVlcnk6IEdFVF9VSV9TVEFURSB9KSE7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGE6IEdldFVpU3RhdGUuUXVlcnkgPSB7XHJcbiAgICAgICAgICAgICAgICB1aVN0YXRlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgX190eXBlbmFtZTogJ1VpU3RhdGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGxhbmd1YWdlOiBwcmV2aW91cy51aVN0YXRlLmxhbmd1YWdlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRMYW5ndWFnZTogcHJldmlvdXMudWlTdGF0ZS5jb250ZW50TGFuZ3VhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgdGhlbWU6IGFyZ3MudGhlbWUsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBjYWNoZS53cml0ZVF1ZXJ5KHsgcXVlcnk6IEdFVF9VSV9TVEFURSwgZGF0YSB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGFyZ3MudGhlbWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXRBY3RpdmVDaGFubmVsOiAoXywgYXJnczogU2V0QWN0aXZlQ2hhbm5lbC5WYXJpYWJsZXMsIHsgY2FjaGUgfSk6IFVzZXJTdGF0dXMgPT4ge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tbm9uLW51bGwtYXNzZXJ0aW9uXHJcbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzID0gY2FjaGUucmVhZFF1ZXJ5PEdldFVzZXJTdGF0dXMuUXVlcnk+KHsgcXVlcnk6IEdFVF9VU0VSX1NUQVRVUyB9KSE7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUNoYW5uZWwgPSBwcmV2aW91cy51c2VyU3RhdHVzLmNoYW5uZWxzLmZpbmQoYyA9PiBjLmlkID09PSBhcmdzLmNoYW5uZWxJZCk7XHJcbiAgICAgICAgICAgIGlmICghYWN0aXZlQ2hhbm5lbCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzZXRBY3RpdmVDaGFubmVsOiBDb3VsZCBub3QgZmluZCBDaGFubmVsIHdpdGggSUQgJyArIGFyZ3MuY2hhbm5lbElkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBwZXJtaXNzaW9ucyA9IGFjdGl2ZUNoYW5uZWwucGVybWlzc2lvbnM7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGE6IHsgdXNlclN0YXR1czogVXNlclN0YXR1cyB9ID0ge1xyXG4gICAgICAgICAgICAgICAgdXNlclN0YXR1czoge1xyXG4gICAgICAgICAgICAgICAgICAgIC4uLnByZXZpb3VzLnVzZXJTdGF0dXMsXHJcbiAgICAgICAgICAgICAgICAgICAgcGVybWlzc2lvbnMsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlQ2hhbm5lbElkOiBhY3RpdmVDaGFubmVsLmlkLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FjaGUud3JpdGVRdWVyeSh7IHF1ZXJ5OiBHRVRfVVNFUl9TVEFUVVMsIGRhdGEgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnVzZXJTdGF0dXM7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB1cGRhdGVVc2VyQ2hhbm5lbHM6IChfLCBhcmdzOiBVcGRhdGVVc2VyQ2hhbm5lbHMuVmFyaWFibGVzLCB7IGNhY2hlIH0pOiBVc2VyU3RhdHVzID0+IHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW5vbi1udWxsLWFzc2VydGlvblxyXG4gICAgICAgICAgICBjb25zdCBwcmV2aW91cyA9IGNhY2hlLnJlYWRRdWVyeTxHZXRVc2VyU3RhdHVzLlF1ZXJ5Pih7IHF1ZXJ5OiBHRVRfVVNFUl9TVEFUVVMgfSkhO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgdXNlclN0YXR1czoge1xyXG4gICAgICAgICAgICAgICAgICAgIC4uLnByZXZpb3VzLnVzZXJTdGF0dXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbHM6IEFycmF5LmlzQXJyYXkoYXJncy5jaGFubmVscykgPyBhcmdzLmNoYW5uZWxzIDogW2FyZ3MuY2hhbm5lbHNdLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgY2FjaGUud3JpdGVRdWVyeSh7IHF1ZXJ5OiBHRVRfVVNFUl9TVEFUVVMsIGRhdGEgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnVzZXJTdGF0dXM7XHJcbiAgICAgICAgfSxcclxuICAgIH0sXHJcbn07XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVSZXF1ZXN0c0luRmxpZ2h0KGNhY2hlOiBJbk1lbW9yeUNhY2hlLCBpbmNyZW1lbnQ6IDEgfCAtMSk6IG51bWJlciB7XHJcbiAgICBjb25zdCBwcmV2aW91cyA9IGNhY2hlLnJlYWRRdWVyeTxHZXROZXR3b3JrU3RhdHVzLlF1ZXJ5Pih7IHF1ZXJ5OiBHRVRfTkVXVE9SS19TVEFUVVMgfSk7XHJcbiAgICBjb25zdCBpbkZsaWdodFJlcXVlc3RzID0gcHJldmlvdXMgPyBwcmV2aW91cy5uZXR3b3JrU3RhdHVzLmluRmxpZ2h0UmVxdWVzdHMgKyBpbmNyZW1lbnQgOiBpbmNyZW1lbnQ7XHJcbiAgICBjb25zdCBkYXRhOiBHZXROZXR3b3JrU3RhdHVzLlF1ZXJ5ID0ge1xyXG4gICAgICAgIG5ldHdvcmtTdGF0dXM6IHtcclxuICAgICAgICAgICAgX190eXBlbmFtZTogJ05ldHdvcmtTdGF0dXMnLFxyXG4gICAgICAgICAgICBpbkZsaWdodFJlcXVlc3RzLFxyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG4gICAgY2FjaGUud3JpdGVRdWVyeSh7IHF1ZXJ5OiBHRVRfTkVXVE9SS19TVEFUVVMsIGRhdGEgfSk7XHJcbiAgICByZXR1cm4gaW5GbGlnaHRSZXF1ZXN0cztcclxufVxyXG4iXX0=