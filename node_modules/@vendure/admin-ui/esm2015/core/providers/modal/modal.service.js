import { ComponentFactoryResolver, Injectable } from '@angular/core';
import { from, Observable } from 'rxjs';
import { mergeMap } from 'rxjs/operators';
import { ModalDialogComponent } from '../../shared/components/modal-dialog/modal-dialog.component';
import { SimpleDialogComponent } from '../../shared/components/simple-dialog/simple-dialog.component';
import { OverlayHostService } from '../overlay-host/overlay-host.service';
import * as i0 from "@angular/core";
import * as i1 from "../overlay-host/overlay-host.service";
/**
 * This service is responsible for instantiating a ModalDialog component and
 * embedding the specified component within.
 */
export class ModalService {
    constructor(componentFactoryResolver, overlayHostService) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.overlayHostService = overlayHostService;
    }
    /**
     * Create a modal from a component. The component must implement the {@link Dialog} interface.
     * Additionally, the component should include templates for the title and the buttons to be
     * displayed in the modal dialog. See example:
     *
     * @example
     * ```
     * class MyDialog implements Dialog {
     *  resolveWith: (result?: any) => void;
     *
     *  okay() {
     *    doSomeWork().subscribe(result => {
     *      this.resolveWith(result);
     *    })
     *  }
     *
     *  cancel() {
     *    this.resolveWith(false);
     *  }
     * }
     * ```
     *
     * ```
     * <ng-template vdrDialogTitle>Title of the modal</ng-template>
     *
     * <p>
     *     My Content
     * </p>
     *
     * <ng-template vdrDialogButtons>
     *     <button type="button"
     *             class="btn"
     *             (click)="cancel()">Cancel</button>
     *     <button type="button"
     *             class="btn btn-primary"
     *             (click)="okay()">Okay</button>
     * </ng-template>
     * ```
     */
    fromComponent(component, options) {
        const modalFactory = this.componentFactoryResolver.resolveComponentFactory(ModalDialogComponent);
        return from(this.overlayHostService.getHostView()).pipe(mergeMap((hostView) => {
            const modalComponentRef = hostView.createComponent(modalFactory);
            const modalInstance = modalComponentRef.instance;
            modalInstance.childComponentType = component;
            modalInstance.options = options;
            return new Observable((subscriber) => {
                modalInstance.closeModal = (result) => {
                    modalComponentRef.destroy();
                    subscriber.next(result);
                    subscriber.complete();
                };
            });
        }));
    }
    /**
     * Displays a modal dialog with the provided title, body and buttons.
     */
    dialog(config) {
        return this.fromComponent(SimpleDialogComponent, {
            locals: config,
        });
    }
}
ModalService.ɵprov = i0.ɵɵdefineInjectable({ factory: function ModalService_Factory() { return new ModalService(i0.ɵɵinject(i0.ComponentFactoryResolver), i0.ɵɵinject(i1.OverlayHostService)); }, token: ModalService, providedIn: "root" });
ModalService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root',
            },] }
];
ModalService.ctorParameters = () => [
    { type: ComponentFactoryResolver },
    { type: OverlayHostService }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29yZS9zcmMvcHJvdmlkZXJzL21vZGFsL21vZGFsLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLHdCQUF3QixFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUVyRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUN4QyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFMUMsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sNkRBQTZELENBQUM7QUFDbkcsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sK0RBQStELENBQUM7QUFDdEcsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7OztBQWtEMUU7OztHQUdHO0FBSUgsTUFBTSxPQUFPLFlBQVk7SUFDckIsWUFDWSx3QkFBa0QsRUFDbEQsa0JBQXNDO1FBRHRDLDZCQUF3QixHQUF4Qix3QkFBd0IsQ0FBMEI7UUFDbEQsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtJQUMvQyxDQUFDO0lBRUo7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O09Bc0NHO0lBQ0gsYUFBYSxDQUNULFNBQW9DLEVBQ3BDLE9BQXlCO1FBRXpCLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyx1QkFBdUIsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBRWpHLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FDbkQsUUFBUSxDQUFDLENBQUMsUUFBUSxFQUFFLEVBQUU7WUFDbEIsTUFBTSxpQkFBaUIsR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQ2pFLE1BQU0sYUFBYSxHQUE4QixpQkFBaUIsQ0FBQyxRQUFRLENBQUM7WUFDNUUsYUFBYSxDQUFDLGtCQUFrQixHQUFHLFNBQVMsQ0FBQztZQUM3QyxhQUFhLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztZQUVoQyxPQUFPLElBQUksVUFBVSxDQUFJLENBQUMsVUFBVSxFQUFFLEVBQUU7Z0JBQ3BDLGFBQWEsQ0FBQyxVQUFVLEdBQUcsQ0FBQyxNQUFTLEVBQUUsRUFBRTtvQkFDckMsaUJBQWlCLENBQUMsT0FBTyxFQUFFLENBQUM7b0JBQzVCLFVBQVUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQ3hCLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztnQkFDMUIsQ0FBQyxDQUFDO1lBQ04sQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FDTCxDQUFDO0lBQ04sQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFJLE1BQXVCO1FBQzdCLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxxQkFBcUIsRUFBRTtZQUM3QyxNQUFNLEVBQUUsTUFBTTtTQUNqQixDQUFDLENBQUM7SUFDUCxDQUFDOzs7O1lBL0VKLFVBQVUsU0FBQztnQkFDUixVQUFVLEVBQUUsTUFBTTthQUNyQjs7O1lBL0RRLHdCQUF3QjtZQU94QixrQkFBa0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsIEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ0B2ZW5kdXJlL2NvbW1vbi9saWIvc2hhcmVkLXR5cGVzJztcclxuaW1wb3J0IHsgZnJvbSwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtZXJnZU1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbmltcG9ydCB7IE1vZGFsRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vc2hhcmVkL2NvbXBvbmVudHMvbW9kYWwtZGlhbG9nL21vZGFsLWRpYWxvZy5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTaW1wbGVEaWFsb2dDb21wb25lbnQgfSBmcm9tICcuLi8uLi9zaGFyZWQvY29tcG9uZW50cy9zaW1wbGUtZGlhbG9nL3NpbXBsZS1kaWFsb2cuY29tcG9uZW50JztcclxuaW1wb3J0IHsgT3ZlcmxheUhvc3RTZXJ2aWNlIH0gZnJvbSAnLi4vb3ZlcmxheS1ob3N0L292ZXJsYXktaG9zdC5zZXJ2aWNlJztcclxuXHJcbi8qKlxyXG4gKiBBbnkgY29tcG9uZW50IGludGVuZGVkIHRvIGJlIHVzZWQgd2l0aCB0aGUgTW9kYWxTZXJ2aWNlLmZyb21Db21wb25lbnQoKSBtZXRob2QgbXVzdCBpbXBsZW1lbnRcclxuICogdGhpcyBpbnRlcmZhY2UuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERpYWxvZzxSID0gYW55PiB7XHJcbiAgICAvKipcclxuICAgICAqIEZ1bmN0aW9uIHRvIGJlIGludm9rZWQgaW4gb3JkZXIgdG8gY2xvc2UgdGhlIGRpYWxvZyB3aGVuIHRoZSBhY3Rpb24gaXMgY29tcGxldGUuXHJcbiAgICAgKiBUaGUgT2JzZXJ2YWJsZSByZXR1cm5lZCBmcm9tIHRoZSAuZnJvbUNvbXBvbmVudCgpIG1ldGhvZCB3aWxsIGVtaXQgdGhlIHZhbHVlIHBhc3NlZFxyXG4gICAgICogdG8gdGhpcyBtZXRob2QgYW5kIHRoZW4gY29tcGxldGUuXHJcbiAgICAgKi9cclxuICAgIHJlc29sdmVXaXRoOiAocmVzdWx0PzogUikgPT4gdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEaWFsb2dCdXR0b25Db25maWc8VD4ge1xyXG4gICAgbGFiZWw6IHN0cmluZztcclxuICAgIHR5cGU6ICdzZWNvbmRhcnknIHwgJ3ByaW1hcnknIHwgJ2Rhbmdlcic7XHJcbiAgICByZXR1cm5WYWx1ZT86IFQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDb25maWd1cmVzIGEgZ2VuZXJpYyBtb2RhbCBkaWFsb2cuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIERpYWxvZ0NvbmZpZzxUPiB7XHJcbiAgICB0aXRsZTogc3RyaW5nO1xyXG4gICAgYm9keT86IHN0cmluZztcclxuICAgIHRyYW5zbGF0aW9uVmFycz86IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyIH07XHJcbiAgICBidXR0b25zOiBBcnJheTxEaWFsb2dCdXR0b25Db25maWc8VD4+O1xyXG59XHJcblxyXG4vKipcclxuICogT3B0aW9ucyB0byBjb25maWd1cmUgdGhlIGJlaGF2aW91ciBvZiB0aGUgbW9kYWwuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE1vZGFsT3B0aW9uczxUPiB7XHJcbiAgICAvKiogU2V0cyB0aGUgd2lkdGggb2YgdGhlIGRpYWxvZyAqL1xyXG4gICAgc2l6ZT86ICdzbScgfCAnbWQnIHwgJ2xnJyB8ICd4bCc7XHJcbiAgICAvKiogU2V0cyB0aGUgdmVydGljYWwgYWxpZ25tZW50IG9mIHRoZSBkaWFsb2cgKi9cclxuICAgIHZlcnRpY2FsQWxpZ24/OiAndG9wJyB8ICdjZW50ZXInIHwgJ2JvdHRvbSc7XHJcbiAgICAvKipcclxuICAgICAqIFdoZW4gdHJ1ZSwgdGhlIFwieFwiIGljb24gaXMgc2hvd25cclxuICAgICAqIGFuZCBjbGlja2luZyBpdCBvciB0aGUgbWFzayB3aWxsIGNsb3NlIHRoZSBkaWFsb2dcclxuICAgICAqL1xyXG4gICAgY2xvc2FibGU/OiBib29sZWFuO1xyXG4gICAgLyoqXHJcbiAgICAgKiBWYWx1ZXMgdG8gYmUgcGFzc2VkIGRpcmVjdGx5IHRvIHRoZSBjb21wb25lbnQuXHJcbiAgICAgKi9cclxuICAgIGxvY2Fscz86IFBhcnRpYWw8VD47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGlzIHNlcnZpY2UgaXMgcmVzcG9uc2libGUgZm9yIGluc3RhbnRpYXRpbmcgYSBNb2RhbERpYWxvZyBjb21wb25lbnQgYW5kXHJcbiAqIGVtYmVkZGluZyB0aGUgc3BlY2lmaWVkIGNvbXBvbmVudCB3aXRoaW4uXHJcbiAqL1xyXG5ASW5qZWN0YWJsZSh7XHJcbiAgICBwcm92aWRlZEluOiAncm9vdCcsXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBNb2RhbFNlcnZpY2Uge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBjb21wb25lbnRGYWN0b3J5UmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcclxuICAgICAgICBwcml2YXRlIG92ZXJsYXlIb3N0U2VydmljZTogT3ZlcmxheUhvc3RTZXJ2aWNlLFxyXG4gICAgKSB7fVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGEgbW9kYWwgZnJvbSBhIGNvbXBvbmVudC4gVGhlIGNvbXBvbmVudCBtdXN0IGltcGxlbWVudCB0aGUge0BsaW5rIERpYWxvZ30gaW50ZXJmYWNlLlxyXG4gICAgICogQWRkaXRpb25hbGx5LCB0aGUgY29tcG9uZW50IHNob3VsZCBpbmNsdWRlIHRlbXBsYXRlcyBmb3IgdGhlIHRpdGxlIGFuZCB0aGUgYnV0dG9ucyB0byBiZVxyXG4gICAgICogZGlzcGxheWVkIGluIHRoZSBtb2RhbCBkaWFsb2cuIFNlZSBleGFtcGxlOlxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBcclxuICAgICAqIGNsYXNzIE15RGlhbG9nIGltcGxlbWVudHMgRGlhbG9nIHtcclxuICAgICAqICByZXNvbHZlV2l0aDogKHJlc3VsdD86IGFueSkgPT4gdm9pZDtcclxuICAgICAqXHJcbiAgICAgKiAgb2theSgpIHtcclxuICAgICAqICAgIGRvU29tZVdvcmsoKS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcclxuICAgICAqICAgICAgdGhpcy5yZXNvbHZlV2l0aChyZXN1bHQpO1xyXG4gICAgICogICAgfSlcclxuICAgICAqICB9XHJcbiAgICAgKlxyXG4gICAgICogIGNhbmNlbCgpIHtcclxuICAgICAqICAgIHRoaXMucmVzb2x2ZVdpdGgoZmFsc2UpO1xyXG4gICAgICogIH1cclxuICAgICAqIH1cclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIGBgYFxyXG4gICAgICogPG5nLXRlbXBsYXRlIHZkckRpYWxvZ1RpdGxlPlRpdGxlIG9mIHRoZSBtb2RhbDwvbmctdGVtcGxhdGU+XHJcbiAgICAgKlxyXG4gICAgICogPHA+XHJcbiAgICAgKiAgICAgTXkgQ29udGVudFxyXG4gICAgICogPC9wPlxyXG4gICAgICpcclxuICAgICAqIDxuZy10ZW1wbGF0ZSB2ZHJEaWFsb2dCdXR0b25zPlxyXG4gICAgICogICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiXHJcbiAgICAgKiAgICAgICAgICAgICBjbGFzcz1cImJ0blwiXHJcbiAgICAgKiAgICAgICAgICAgICAoY2xpY2spPVwiY2FuY2VsKClcIj5DYW5jZWw8L2J1dHRvbj5cclxuICAgICAqICAgICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIlxyXG4gICAgICogICAgICAgICAgICAgY2xhc3M9XCJidG4gYnRuLXByaW1hcnlcIlxyXG4gICAgICogICAgICAgICAgICAgKGNsaWNrKT1cIm9rYXkoKVwiPk9rYXk8L2J1dHRvbj5cclxuICAgICAqIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgZnJvbUNvbXBvbmVudDxUIGV4dGVuZHMgRGlhbG9nPGFueT4sIFI+KFxyXG4gICAgICAgIGNvbXBvbmVudDogVHlwZTxUPiAmIFR5cGU8RGlhbG9nPFI+PixcclxuICAgICAgICBvcHRpb25zPzogTW9kYWxPcHRpb25zPFQ+LFxyXG4gICAgKTogT2JzZXJ2YWJsZTxSIHwgdW5kZWZpbmVkPiB7XHJcbiAgICAgICAgY29uc3QgbW9kYWxGYWN0b3J5ID0gdGhpcy5jb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoTW9kYWxEaWFsb2dDb21wb25lbnQpO1xyXG5cclxuICAgICAgICByZXR1cm4gZnJvbSh0aGlzLm92ZXJsYXlIb3N0U2VydmljZS5nZXRIb3N0VmlldygpKS5waXBlKFxyXG4gICAgICAgICAgICBtZXJnZU1hcCgoaG9zdFZpZXcpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsQ29tcG9uZW50UmVmID0gaG9zdFZpZXcuY3JlYXRlQ29tcG9uZW50KG1vZGFsRmFjdG9yeSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RhbEluc3RhbmNlOiBNb2RhbERpYWxvZ0NvbXBvbmVudDxhbnk+ID0gbW9kYWxDb21wb25lbnRSZWYuaW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlLmNoaWxkQ29tcG9uZW50VHlwZSA9IGNvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2Uub3B0aW9ucyA9IG9wdGlvbnM7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPFI+KChzdWJzY3JpYmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5jbG9zZU1vZGFsID0gKHJlc3VsdDogUikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbENvbXBvbmVudFJlZi5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIubmV4dChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpYmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGlzcGxheXMgYSBtb2RhbCBkaWFsb2cgd2l0aCB0aGUgcHJvdmlkZWQgdGl0bGUsIGJvZHkgYW5kIGJ1dHRvbnMuXHJcbiAgICAgKi9cclxuICAgIGRpYWxvZzxUPihjb25maWc6IERpYWxvZ0NvbmZpZzxUPik6IE9ic2VydmFibGU8VCB8IHVuZGVmaW5lZD4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZyb21Db21wb25lbnQoU2ltcGxlRGlhbG9nQ29tcG9uZW50LCB7XHJcbiAgICAgICAgICAgIGxvY2FsczogY29uZmlnLFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==