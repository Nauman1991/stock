{"version":3,"sources":["../../src/lib/customer/src/components/add-customer-to-group-dialog/add-customer-to-group-dialog.component.ts","../../src/lib/customer/src/components/address-detail-dialog/address-detail-dialog.component.ts","../../src/lib/customer/src/components/address-card/address-card.component.ts","../../node_modules/tslib/tslib.es6.js","../../src/lib/customer/src/components/select-customer-group-dialog/select-customer-group-dialog.component.ts","../../src/lib/customer/src/components/customer-detail/customer-detail.component.ts","../../src/lib/customer/src/components/customer-group-detail-dialog/customer-group-detail-dialog.component.ts","../../src/lib/customer/src/components/customer-group-list/customer-group-list.component.ts","../../src/lib/customer/src/components/customer-group-member-list/customer-group-member-list.component.ts","../../src/lib/customer/src/components/customer-history/customer-history.component.ts","../../src/lib/customer/src/components/customer-list/customer-list.component.ts","../../src/lib/customer/src/components/customer-status-label/customer-status-label.component.ts","../../src/lib/customer/src/providers/routing/customer-resolver.ts","../../src/lib/customer/src/customer.routes.ts","../../src/lib/customer/src/customer.module.ts"],"names":["AddCustomerToGroupDialogComponent","dataService","this","selectedCustomerIds","fetchGroupMembers$","BehaviorSubject","skip","take","filterTerm","prototype","ngOnInit","_this","customerResult$","pipe","switchMap","_a","customer","getCustomerList","mapStream","res","customers","customers$","map","items","customersTotal$","totalItems","cancel","resolveWith","add","Component","args","selector","template","changeDetection","ChangeDetectionStrategy","OnPush","DataService","AddressDetailDialogComponent","changeDetector","availableCountries","addressForm","valueChanges","subscribe","markForCheck","save","ChangeDetectorRef","AddressCardComponent","modalService","editable","setAsDefaultShipping","EventEmitter","setAsDefaultBilling","dataDependenciesPopulated","get","value","filter","editAddress","ngOnChanges","changes","customFields","next","getCountryName","countryCode","match","find","c","code","name","setAsDefaultBillingAddress","emit","id","markAsDirty","setAsDefaultShippingAddress","fromComponent","locals","size","closable","ModalService","Input","Output","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__rest","s","e","t","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","__values","o","Symbol","iterator","m","done","__read","n","r","ar","push","error","__spread","arguments","concat","SelectCustomerGroupDialogComponent","selectedGroupIds","groups$","getCustomerGroupList","customerGroups","CustomerDetailComponent","route","router","serverConfigService","formBuilder","notificationService","_super","fetchHistory","Subject","addressDefaultsUpdated","ordersPerPage","currentOrdersPage","orderListUpdates$","getCustomFieldConfig","addressCustomFields","detailForm","group","title","firstName","Validators","required","lastName","phoneNumber","emailAddress","email","password","reduce","hash","field","assign","_d","addresses","FormArray","init","availableCountries$","settings","getAvailableCountries","mapSingle","result","countries","shareReplay","customerWithUpdates$","entity$","merge","orders$","orders","ordersCount$","history$","startWith","getCustomerHistory","sort","createdAt","SortOrder","DESC","data","history","ngOnDestroy","destroy","complete","customFieldIsSet","getAddressFormControls","controls","setDefaultBillingAddressId","defaultBillingAddressId","setDefaultShippingAddressId","defaultShippingAddressId","addAddress","addressFormArray","newAddress","fullName","company","streetLine1","streetLine2","city","province","postalCode","defaultShippingAddress","defaultBillingAddress","customFieldsGroup","_e","_f","fieldDef","addControl","FormControl","setOrderItemsPerPage","itemsPerPage","fetchOrdersList","setOrderCurrentPage","page","customerForm","formValue","createCustomer","__typename","success","_","entity","notify","message","translationVars","type","duration","markAsPristine","navigate","relativeTo","mergeMap","saveOperations","dirty","updateCustomer","_g","addressControl","address","input","updateCustomerAddress","createCustomerAddress","forkJoin","data_1","data_1_1","err","addToGroup","groupIds","from","EMPTY","concatMap","groupId","addCustomersToGroup","customerCount","groupName","getCustomer","single$","removeFromGroup","dialog","buttons","label","returnValue","response","removeCustomersFromGroup","addNoteToCustomer","note","updateNote","entry","EditNoteDialogComponent","displayPrivacyControls","updateCustomerNote","noteId","deleteNote","body","deleteCustomerNote","setFormValues","customerGroup","patchValue","addressesArray","_h","_c","rest","addressGroup","country","_j","e_5","_k","key","control","setControl","_l","_m","_b","notNullOrUndefined","BaseDetailComponent","ActivatedRoute","Router","ServerConfigService","FormBuilder","NotificationService","CustomerGroupDetailDialogComponent","CustomerGroupListComponent","refreshActiveGroupMembers$","undefined","activeGroupId$","paramMap","pm","distinctUntilChanged","tap","listIsEmpty$","groups","activeGroup$","combineLatest","activeGroupId","g","membersResult$","activeGroup","getCustomerGroupWithCustomers","contains","of","members$","membersTotal$","createCustomerGroup","customerIds","delete","deleteCustomerGroup","DeletionResult","DELETED","errorMessage","update","updateCustomerGroup","closeMembers","params","snapshot","contents","queryParamsHandling","verticalAlign","mapTo","CustomerGroupMemberListComponent","selectedMemberIds","selectionChange","fetchParamsChange","filterTermControl","refresh$","destroy$","isMemberSelected","member","membersCurrentPage$","qpm","membersItemsPerPage$","perPage","filterTerm$","debounceTime","setContentsPageNumber","takeUntil","currentPage","setParam","setContentsItemsPerPage","refresh","areAllSelected","members","toggleSelectAll","v","toggleSelectMember","includes","CustomerHistoryComponent","addNote","HistoryEntryType","getDisplayType","CUSTOMER_VERIFIED","CUSTOMER_EMAIL_UPDATE_VERIFIED","CUSTOMER_PASSWORD_RESET_VERIFIED","CUSTOMER_REGISTERED","CUSTOMER_REMOVED_FROM_GROUP","getTimelineIcon","CUSTOMER_NOTE","CUSTOMER_ADDED_TO_GROUP","isFeatured","getName","administrator","CustomerListComponent","emailSearchTerm","lastNameSearchTerm","setQueryFn","_i","apply","refetchOnChannelChange","options","deleteCustomer","BaseListComponent","CustomerResolver","updatedAt","user","BaseEntityResolver","Injectable","providedIn","breadcrumb","ɵ1","customerBreadcrumb","ɵ2","customerRoutes","path","component","pathMatch","ɵ0","resolve","createResolveData","canDeactivate","CanDeactivateDetailGuard","detailBreadcrumb","breadcrumbKey","NgModule","imports","SharedModule","RouterModule","forChild","declarations","CustomerStatusLabelComponent","exports"],"mappings":"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","sourcesContent":["import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { DataService, Dialog, GetCustomerGroups, GetCustomerList } from '@vendure/admin-ui/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { map, switchMap } from 'rxjs/operators';\r\n\r\nimport { CustomerGroupMemberFetchParams } from '../customer-group-member-list/customer-group-member-list.component';\r\n\r\n@Component({\r\n    selector: 'vdr-add-customer-to-group-dialog',\r\n    templateUrl: './add-customer-to-group-dialog.component.html',\r\n    styleUrls: ['./add-customer-to-group-dialog.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class AddCustomerToGroupDialogComponent implements Dialog<string[]>, OnInit {\r\n    resolveWith: (result?: string[]) => void;\r\n    group: GetCustomerGroups.Items;\r\n    route: ActivatedRoute;\r\n    selectedCustomerIds: string[] = [];\r\n    customers$: Observable<GetCustomerList.Items[]>;\r\n    customersTotal$: Observable<number>;\r\n    fetchGroupMembers$ = new BehaviorSubject<CustomerGroupMemberFetchParams>({\r\n        skip: 0,\r\n        take: 10,\r\n        filterTerm: '',\r\n    });\r\n\r\n    constructor(private dataService: DataService) {}\r\n\r\n    ngOnInit() {\r\n        const customerResult$ = this.fetchGroupMembers$.pipe(\r\n            switchMap(({ skip, take, filterTerm }) => {\r\n                return this.dataService.customer\r\n                    .getCustomerList(take, skip, filterTerm)\r\n                    .mapStream((res) => res.customers);\r\n            }),\r\n        );\r\n\r\n        this.customers$ = customerResult$.pipe(map((res) => res.items));\r\n        this.customersTotal$ = customerResult$.pipe(map((res) => res.totalItems));\r\n    }\r\n\r\n    cancel() {\r\n        this.resolveWith();\r\n    }\r\n\r\n    add() {\r\n        this.resolveWith(this.selectedCustomerIds);\r\n    }\r\n}\r\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { FormGroup } from '@angular/forms';\r\nimport { CustomFieldConfig, Dialog, GetAvailableCountries } from '@vendure/admin-ui/core';\r\n\r\n@Component({\r\n    selector: 'vdr-address-detail-dialog',\r\n    templateUrl: './address-detail-dialog.component.html',\r\n    styleUrls: ['./address-detail-dialog.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class AddressDetailDialogComponent implements Dialog<FormGroup>, OnInit {\r\n    addressForm: FormGroup;\r\n    customFields: CustomFieldConfig;\r\n    availableCountries: GetAvailableCountries.Items[] = [];\r\n    resolveWith: (result?: FormGroup) => void;\r\n\r\n    constructor(private changeDetector: ChangeDetectorRef) {}\r\n\r\n    ngOnInit() {\r\n        this.addressForm.valueChanges.subscribe(() => this.changeDetector.markForCheck());\r\n    }\r\n\r\n    cancel() {\r\n        this.resolveWith();\r\n    }\r\n\r\n    save() {\r\n        this.resolveWith(this.addressForm);\r\n    }\r\n}\r\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnInit,\n    Output,\n    SimpleChanges,\n} from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { CustomFieldConfig, GetAvailableCountries, ModalService } from '@vendure/admin-ui/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { filter, take } from 'rxjs/operators';\n\nimport { AddressDetailDialogComponent } from '../address-detail-dialog/address-detail-dialog.component';\n\n@Component({\n    selector: 'vdr-address-card',\n    templateUrl: './address-card.component.html',\n    styleUrls: ['./address-card.component.scss'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AddressCardComponent implements OnInit, OnChanges {\n    @Input() addressForm: FormGroup;\n    @Input() customFields: CustomFieldConfig;\n    @Input() availableCountries: GetAvailableCountries.Items[] = [];\n    @Input() isDefaultBilling: string;\n    @Input() isDefaultShipping: string;\n    @Input() editable = true;\n    @Output() setAsDefaultShipping = new EventEmitter<string>();\n    @Output() setAsDefaultBilling = new EventEmitter<string>();\n    private dataDependenciesPopulated = new BehaviorSubject<boolean>(false);\n\n    constructor(private modalService: ModalService, private changeDetector: ChangeDetectorRef) {}\n\n    ngOnInit(): void {\n        const streetLine1 = this.addressForm.get('streetLine1') as FormControl;\n        // Make the address dialog display automatically if there is no address line\n        // as is the case when adding a new address.\n        if (!streetLine1.value) {\n            this.dataDependenciesPopulated\n                .pipe(\n                    filter(value => value),\n                    take(1),\n                )\n                .subscribe(() => {\n                    this.editAddress();\n                });\n        }\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (this.customFields != null && this.availableCountries != null) {\n            this.dataDependenciesPopulated.next(true);\n        }\n    }\n\n    getCountryName(countryCode: string) {\n        if (!this.availableCountries) {\n            return '';\n        }\n        const match = this.availableCountries.find(c => c.code === countryCode);\n        return match ? match.name : '';\n    }\n\n    setAsDefaultBillingAddress() {\n        this.setAsDefaultBilling.emit(this.addressForm.value.id);\n        this.addressForm.markAsDirty();\n    }\n\n    setAsDefaultShippingAddress() {\n        this.setAsDefaultShipping.emit(this.addressForm.value.id);\n        this.addressForm.markAsDirty();\n    }\n\n    editAddress() {\n        this.modalService\n            .fromComponent(AddressDetailDialogComponent, {\n                locals: {\n                    addressForm: this.addressForm,\n                    customFields: this.customFields,\n                    availableCountries: this.availableCountries,\n                },\n                size: 'md',\n                closable: true,\n            })\n            .subscribe(() => {\n                this.changeDetector.markForCheck();\n            });\n    }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { DataService, Dialog, GetCustomerGroups, GetCustomerList } from '@vendure/admin-ui/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { map, switchMap } from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'vdr-select-customer-group-dialog',\r\n    templateUrl: './select-customer-group-dialog.component.html',\r\n    styleUrls: ['./select-customer-group-dialog.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SelectCustomerGroupDialogComponent implements Dialog<string[]>, OnInit {\r\n    resolveWith: (result?: string[]) => void;\r\n    groups$: Observable<GetCustomerGroups.Items[]>;\r\n    selectedGroupIds: string[] = [];\r\n\r\n    constructor(private dataService: DataService) {}\r\n\r\n    ngOnInit() {\r\n        this.groups$ = this.dataService.customer\r\n            .getCustomerGroupList()\r\n            .mapStream((res) => res.customerGroups.items);\r\n    }\r\n\r\n    cancel() {\r\n        this.resolveWith();\r\n    }\r\n\r\n    add() {\r\n        this.resolveWith(this.selectedGroupIds);\r\n    }\r\n}\r\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { FormArray, FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\r\nimport {\r\n    BaseDetailComponent,\r\n    CreateAddressInput,\r\n    CreateCustomerAddress,\r\n    CreateCustomerAddressMutation,\r\n    CreateCustomerInput,\r\n    Customer,\r\n    CustomFieldConfig,\r\n    DataService,\r\n    EditNoteDialogComponent,\r\n    GetAvailableCountries,\r\n    GetCustomer,\r\n    GetCustomerHistory,\r\n    GetCustomerQuery,\r\n    HistoryEntry,\r\n    ModalService,\r\n    NotificationService,\r\n    ServerConfigService,\r\n    SortOrder,\r\n    UpdateCustomer,\r\n    UpdateCustomerAddress,\r\n    UpdateCustomerAddressMutation,\r\n    UpdateCustomerInput,\r\n    UpdateCustomerMutation,\r\n} from '@vendure/admin-ui/core';\r\nimport { notNullOrUndefined } from '@vendure/common/lib/shared-utils';\r\nimport { EMPTY, forkJoin, from, Observable, Subject } from 'rxjs';\r\nimport {\r\n    concatMap,\r\n    filter,\r\n    map,\r\n    merge,\r\n    mergeMap,\r\n    shareReplay,\r\n    startWith,\r\n    switchMap,\r\n    take,\r\n} from 'rxjs/operators';\r\n\r\nimport { SelectCustomerGroupDialogComponent } from '../select-customer-group-dialog/select-customer-group-dialog.component';\r\n\r\ntype CustomerWithOrders = NonNullable<GetCustomerQuery['customer']>;\r\n\r\n@Component({\r\n    selector: 'vdr-customer-detail',\r\n    templateUrl: './customer-detail.component.html',\r\n    styleUrls: ['./customer-detail.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CustomerDetailComponent extends BaseDetailComponent<CustomerWithOrders>\r\n    implements OnInit, OnDestroy {\r\n    detailForm: FormGroup;\r\n    customFields: CustomFieldConfig[];\r\n    addressCustomFields: CustomFieldConfig[];\r\n    availableCountries$: Observable<GetAvailableCountries.Items[]>;\r\n    orders$: Observable<GetCustomer.Items[]>;\r\n    ordersCount$: Observable<number>;\r\n    history$: Observable<GetCustomerHistory.Items[] | undefined>;\r\n    fetchHistory = new Subject<void>();\r\n    defaultShippingAddressId: string;\r\n    defaultBillingAddressId: string;\r\n    addressDefaultsUpdated = false;\r\n    ordersPerPage = 10;\r\n    currentOrdersPage = 1;\r\n    private orderListUpdates$ = new Subject<CustomerWithOrders>();\r\n\r\n    constructor(\r\n        route: ActivatedRoute,\r\n        router: Router,\r\n        serverConfigService: ServerConfigService,\r\n        private changeDetector: ChangeDetectorRef,\r\n        private formBuilder: FormBuilder,\r\n        protected dataService: DataService,\r\n        private modalService: ModalService,\r\n        private notificationService: NotificationService,\r\n    ) {\r\n        super(route, router, serverConfigService, dataService);\r\n\r\n        this.customFields = this.getCustomFieldConfig('Customer');\r\n        this.addressCustomFields = this.getCustomFieldConfig('Address');\r\n        this.detailForm = this.formBuilder.group({\r\n            customer: this.formBuilder.group({\r\n                title: '',\r\n                firstName: ['', Validators.required],\r\n                lastName: ['', Validators.required],\r\n                phoneNumber: '',\r\n                emailAddress: ['', [Validators.required, Validators.email]],\r\n                password: '',\r\n                customFields: this.formBuilder.group(\r\n                    this.customFields.reduce((hash, field) => ({ ...hash, [field.name]: '' }), {}),\r\n                ),\r\n            }),\r\n            addresses: new FormArray([]),\r\n        });\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.init();\r\n        this.availableCountries$ = this.dataService.settings\r\n            .getAvailableCountries()\r\n            .mapSingle(result => result.countries.items)\r\n            .pipe(shareReplay(1));\r\n\r\n        const customerWithUpdates$ = this.entity$.pipe(merge(this.orderListUpdates$));\r\n        this.orders$ = customerWithUpdates$.pipe(map(customer => customer.orders.items));\r\n        this.ordersCount$ = this.entity$.pipe(map(customer => customer.orders.totalItems));\r\n        this.history$ = this.fetchHistory.pipe(\r\n            startWith(null),\r\n            switchMap(() => {\r\n                return this.dataService.customer\r\n                    .getCustomerHistory(this.id, {\r\n                        sort: {\r\n                            createdAt: SortOrder.DESC,\r\n                        },\r\n                    })\r\n                    .mapStream(data => data.customer?.history.items);\r\n            }),\r\n        );\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.destroy();\r\n        this.orderListUpdates$.complete();\r\n    }\r\n\r\n    customFieldIsSet(name: string): boolean {\r\n        return !!this.detailForm.get(['customer', 'customFields', name]);\r\n    }\r\n\r\n    getAddressFormControls(): FormControl[] {\r\n        const formArray = this.detailForm.get(['addresses']) as FormArray;\r\n        return formArray.controls as FormControl[];\r\n    }\r\n\r\n    setDefaultBillingAddressId(id: string) {\r\n        this.defaultBillingAddressId = id;\r\n        this.addressDefaultsUpdated = true;\r\n    }\r\n\r\n    setDefaultShippingAddressId(id: string) {\r\n        this.defaultShippingAddressId = id;\r\n        this.addressDefaultsUpdated = true;\r\n    }\r\n\r\n    addAddress() {\r\n        const addressFormArray = this.detailForm.get('addresses') as FormArray;\r\n        const newAddress = this.formBuilder.group({\r\n            fullName: '',\r\n            company: '',\r\n            streetLine1: ['', Validators.required],\r\n            streetLine2: '',\r\n            city: '',\r\n            province: '',\r\n            postalCode: '',\r\n            countryCode: ['', Validators.required],\r\n            phoneNumber: '',\r\n            defaultShippingAddress: false,\r\n            defaultBillingAddress: false,\r\n        });\r\n        if (this.addressCustomFields.length) {\r\n            const customFieldsGroup = this.formBuilder.group({});\r\n            for (const fieldDef of this.addressCustomFields) {\r\n                customFieldsGroup.addControl(fieldDef.name, new FormControl(''));\r\n            }\r\n            newAddress.addControl('customFields', customFieldsGroup);\r\n        }\r\n        addressFormArray.push(newAddress);\r\n    }\r\n\r\n    setOrderItemsPerPage(itemsPerPage: number) {\r\n        this.ordersPerPage = +itemsPerPage;\r\n        this.fetchOrdersList();\r\n    }\r\n\r\n    setOrderCurrentPage(page: number) {\r\n        this.currentOrdersPage = +page;\r\n        this.fetchOrdersList();\r\n    }\r\n\r\n    create() {\r\n        const customerForm = this.detailForm.get('customer');\r\n        if (!customerForm) {\r\n            return;\r\n        }\r\n        const formValue = customerForm.value;\r\n        const customFields = customerForm.get('customFields')?.value;\r\n        const customer: CreateCustomerInput = {\r\n            title: formValue.title,\r\n            emailAddress: formValue.emailAddress,\r\n            firstName: formValue.firstName,\r\n            lastName: formValue.lastName,\r\n            phoneNumber: formValue.phoneNumber,\r\n            customFields,\r\n        };\r\n        this.dataService.customer\r\n            .createCustomer(customer, formValue.password)\r\n            .subscribe(({ createCustomer }) => {\r\n                switch (createCustomer.__typename) {\r\n                    case 'Customer':\r\n                        this.notificationService.success(_('common.notify-create-success'), {\r\n                            entity: 'Customer',\r\n                        });\r\n                        if (createCustomer.emailAddress && !formValue.password) {\r\n                            this.notificationService.notify({\r\n                                message: _('customer.email-verification-sent'),\r\n                                translationVars: { emailAddress: formValue.emailAddress },\r\n                                type: 'info',\r\n                                duration: 10000,\r\n                            });\r\n                        }\r\n                        this.detailForm.markAsPristine();\r\n                        this.addressDefaultsUpdated = false;\r\n                        this.changeDetector.markForCheck();\r\n                        this.router.navigate(['../', createCustomer.id], { relativeTo: this.route });\r\n                        break;\r\n                    case 'EmailAddressConflictError':\r\n                        this.notificationService.error(createCustomer.message);\r\n                }\r\n            });\r\n    }\r\n\r\n    save() {\r\n        this.entity$\r\n            .pipe(\r\n                take(1),\r\n                mergeMap(({ id }) => {\r\n                    const saveOperations: Array<Observable<\r\n                        | UpdateCustomer.UpdateCustomer\r\n                        | CreateCustomerAddress.CreateCustomerAddress\r\n                        | UpdateCustomerAddress.UpdateCustomerAddress\r\n                    >> = [];\r\n                    const customerForm = this.detailForm.get('customer');\r\n                    if (customerForm && customerForm.dirty) {\r\n                        const formValue = customerForm.value;\r\n                        const customFields = customerForm.get('customFields')?.value;\r\n                        const customer: UpdateCustomerInput = {\r\n                            id,\r\n                            title: formValue.title,\r\n                            emailAddress: formValue.emailAddress,\r\n                            firstName: formValue.firstName,\r\n                            lastName: formValue.lastName,\r\n                            phoneNumber: formValue.phoneNumber,\r\n                            customFields,\r\n                        };\r\n                        saveOperations.push(\r\n                            this.dataService.customer\r\n                                .updateCustomer(customer)\r\n                                .pipe(map(res => res.updateCustomer)),\r\n                        );\r\n                    }\r\n                    const addressFormArray = this.detailForm.get('addresses') as FormArray;\r\n                    if ((addressFormArray && addressFormArray.dirty) || this.addressDefaultsUpdated) {\r\n                        for (const addressControl of addressFormArray.controls) {\r\n                            if (addressControl.dirty || this.addressDefaultsUpdated) {\r\n                                const address = addressControl.value;\r\n                                const input: CreateAddressInput = {\r\n                                    fullName: address.fullName,\r\n                                    company: address.company,\r\n                                    streetLine1: address.streetLine1,\r\n                                    streetLine2: address.streetLine2,\r\n                                    city: address.city,\r\n                                    province: address.province,\r\n                                    postalCode: address.postalCode,\r\n                                    countryCode: address.countryCode,\r\n                                    phoneNumber: address.phoneNumber,\r\n                                    defaultShippingAddress: this.defaultShippingAddressId === address.id,\r\n                                    defaultBillingAddress: this.defaultBillingAddressId === address.id,\r\n                                    customFields: address.customFields,\r\n                                };\r\n                                if (!address.id) {\r\n                                    saveOperations.push(\r\n                                        this.dataService.customer\r\n                                            .createCustomerAddress(id, input)\r\n                                            .pipe(map(res => res.createCustomerAddress)),\r\n                                    );\r\n                                } else {\r\n                                    saveOperations.push(\r\n                                        this.dataService.customer\r\n                                            .updateCustomerAddress({\r\n                                                ...input,\r\n                                                id: address.id,\r\n                                            })\r\n                                            .pipe(map(res => res.updateCustomerAddress)),\r\n                                    );\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return forkJoin(saveOperations);\r\n                }),\r\n            )\r\n            .subscribe(\r\n                data => {\r\n                    for (const result of data) {\r\n                        switch (result.__typename) {\r\n                            case 'Customer':\r\n                            case 'Address':\r\n                                this.notificationService.success(_('common.notify-update-success'), {\r\n                                    entity: 'Customer',\r\n                                });\r\n                                this.detailForm.markAsPristine();\r\n                                this.addressDefaultsUpdated = false;\r\n                                this.changeDetector.markForCheck();\r\n                                this.fetchHistory.next();\r\n                                break;\r\n                            case 'EmailAddressConflictError':\r\n                                this.notificationService.error(result.message);\r\n                                break;\r\n                        }\r\n                    }\r\n                },\r\n                err => {\r\n                    this.notificationService.error(_('common.notify-update-error'), {\r\n                        entity: 'Customer',\r\n                    });\r\n                },\r\n            );\r\n    }\r\n\r\n    addToGroup() {\r\n        this.modalService\r\n            .fromComponent(SelectCustomerGroupDialogComponent, {\r\n                size: 'md',\r\n            })\r\n            .pipe(\r\n                switchMap(groupIds => (groupIds ? from(groupIds) : EMPTY)),\r\n                concatMap(groupId => this.dataService.customer.addCustomersToGroup(groupId, [this.id])),\r\n            )\r\n            .subscribe({\r\n                next: res => {\r\n                    this.notificationService.success(_(`customer.add-customers-to-group-success`), {\r\n                        customerCount: 1,\r\n                        groupName: res.addCustomersToGroup.name,\r\n                    });\r\n                },\r\n                complete: () => {\r\n                    this.dataService.customer.getCustomer(this.id, { take: 0 }).single$.subscribe();\r\n                    this.fetchHistory.next();\r\n                },\r\n            });\r\n    }\r\n\r\n    removeFromGroup(group: GetCustomer.Groups) {\r\n        this.modalService\r\n            .dialog({\r\n                title: _('customer.confirm-remove-customer-from-group'),\r\n                buttons: [\r\n                    { type: 'secondary', label: _('common.cancel') },\r\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\r\n                ],\r\n            })\r\n            .pipe(\r\n                switchMap(response =>\r\n                    response\r\n                        ? this.dataService.customer.removeCustomersFromGroup(group.id, [this.id])\r\n                        : EMPTY,\r\n                ),\r\n                switchMap(() => this.dataService.customer.getCustomer(this.id, { take: 0 }).single$),\r\n            )\r\n            .subscribe(result => {\r\n                this.notificationService.success(_(`customer.remove-customers-from-group-success`), {\r\n                    customerCount: 1,\r\n                    groupName: group.name,\r\n                });\r\n                this.fetchHistory.next();\r\n            });\r\n    }\r\n\r\n    addNoteToCustomer({ note }: { note: string }) {\r\n        this.dataService.customer.addNoteToCustomer(this.id, note).subscribe(() => {\r\n            this.fetchHistory.next();\r\n            this.notificationService.success(_('common.notify-create-success'), {\r\n                entity: 'Note',\r\n            });\r\n        });\r\n    }\r\n\r\n    updateNote(entry: HistoryEntry) {\r\n        this.modalService\r\n            .fromComponent(EditNoteDialogComponent, {\r\n                closable: true,\r\n                locals: {\r\n                    displayPrivacyControls: false,\r\n                    note: entry.data.note,\r\n                },\r\n            })\r\n            .pipe(\r\n                switchMap(result => {\r\n                    if (result) {\r\n                        return this.dataService.customer.updateCustomerNote({\r\n                            noteId: entry.id,\r\n                            note: result.note,\r\n                        });\r\n                    } else {\r\n                        return EMPTY;\r\n                    }\r\n                }),\r\n            )\r\n            .subscribe(result => {\r\n                this.fetchHistory.next();\r\n                this.notificationService.success(_('common.notify-update-success'), {\r\n                    entity: 'Note',\r\n                });\r\n            });\r\n    }\r\n\r\n    deleteNote(entry: HistoryEntry) {\r\n        return this.modalService\r\n            .dialog({\r\n                title: _('common.confirm-delete-note'),\r\n                body: entry.data.note,\r\n                buttons: [\r\n                    { type: 'secondary', label: _('common.cancel') },\r\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\r\n                ],\r\n            })\r\n            .pipe(switchMap(res => (res ? this.dataService.customer.deleteCustomerNote(entry.id) : EMPTY)))\r\n            .subscribe(() => {\r\n                this.fetchHistory.next();\r\n                this.notificationService.success(_('common.notify-delete-success'), {\r\n                    entity: 'Note',\r\n                });\r\n            });\r\n    }\r\n\r\n    protected setFormValues(entity: Customer.Fragment): void {\r\n        const customerGroup = this.detailForm.get('customer');\r\n        if (customerGroup) {\r\n            customerGroup.patchValue({\r\n                title: entity.title,\r\n                firstName: entity.firstName,\r\n                lastName: entity.lastName,\r\n                phoneNumber: entity.phoneNumber,\r\n                emailAddress: entity.emailAddress,\r\n            });\r\n        }\r\n\r\n        if (entity.addresses) {\r\n            const addressesArray = new FormArray([]);\r\n            for (const address of entity.addresses) {\r\n                const { customFields, ...rest } = address as any;\r\n                const addressGroup = this.formBuilder.group({\r\n                    ...rest,\r\n                    countryCode: address.country.code,\r\n                });\r\n                addressesArray.push(addressGroup);\r\n                if (address.defaultShippingAddress) {\r\n                    this.defaultShippingAddressId = address.id;\r\n                }\r\n                if (address.defaultBillingAddress) {\r\n                    this.defaultBillingAddressId = address.id;\r\n                }\r\n\r\n                if (this.addressCustomFields.length) {\r\n                    const customFieldsGroup = this.formBuilder.group({});\r\n                    for (const fieldDef of this.addressCustomFields) {\r\n                        const key = fieldDef.name;\r\n                        const value = (address as any).customFields?.[key];\r\n                        const control = new FormControl(value);\r\n                        customFieldsGroup.addControl(key, control);\r\n                    }\r\n                    addressGroup.addControl('customFields', customFieldsGroup);\r\n                }\r\n            }\r\n            this.detailForm.setControl('addresses', addressesArray);\r\n        }\r\n\r\n        if (this.customFields.length) {\r\n            const customFieldsGroup = this.detailForm.get(['customer', 'customFields']) as FormGroup;\r\n\r\n            for (const fieldDef of this.customFields) {\r\n                const key = fieldDef.name;\r\n                const value = (entity as any).customFields?.[key];\r\n                const control = customFieldsGroup.get(key);\r\n                if (control) {\r\n                    control.patchValue(value);\r\n                }\r\n            }\r\n        }\r\n        this.changeDetector.markForCheck();\r\n    }\r\n\r\n    /**\r\n     * Refetch the customer with the current order list settings.\r\n     */\r\n    private fetchOrdersList() {\r\n        this.dataService.customer\r\n            .getCustomer(this.id, {\r\n                take: this.ordersPerPage,\r\n                skip: (this.currentOrdersPage - 1) * this.ordersPerPage,\r\n            })\r\n            .single$.pipe(\r\n                map(data => data.customer),\r\n                filter(notNullOrUndefined),\r\n            )\r\n            .subscribe(result => this.orderListUpdates$.next(result));\r\n    }\r\n}\r\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\r\nimport { Dialog } from '@vendure/admin-ui/core';\r\n\r\n@Component({\r\n    selector: 'vdr-customer-group-detail-dialog',\r\n    templateUrl: './customer-group-detail-dialog.component.html',\r\n    styleUrls: ['./customer-group-detail-dialog.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CustomerGroupDetailDialogComponent implements Dialog<string> {\r\n    group: { id?: string; name: string };\r\n    resolveWith: (result?: string) => void;\r\n\r\n    cancel() {\r\n        this.resolveWith();\r\n    }\r\n\r\n    save() {\r\n        this.resolveWith(this.group.name);\r\n    }\r\n}\r\n","import { ChangeDetectionStrategy, Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\r\nimport {\r\n    DataService,\r\n    DeletionResult,\r\n    GetCustomerGroups,\r\n    GetCustomerGroupWithCustomers,\r\n    GetZones,\r\n    ModalService,\r\n    NotificationService,\r\n} from '@vendure/admin-ui/core';\r\nimport { BehaviorSubject, combineLatest, EMPTY, Observable, of } from 'rxjs';\r\nimport { distinctUntilChanged, map, mapTo, switchMap, tap } from 'rxjs/operators';\r\n\r\nimport { AddCustomerToGroupDialogComponent } from '../add-customer-to-group-dialog/add-customer-to-group-dialog.component';\r\nimport { CustomerGroupDetailDialogComponent } from '../customer-group-detail-dialog/customer-group-detail-dialog.component';\r\nimport { CustomerGroupMemberFetchParams } from '../customer-group-member-list/customer-group-member-list.component';\r\n\r\n@Component({\r\n    selector: 'vdr-customer-group-list',\r\n    templateUrl: './customer-group-list.component.html',\r\n    styleUrls: ['./customer-group-list.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CustomerGroupListComponent implements OnInit {\r\n    activeGroup$: Observable<GetCustomerGroups.Items | undefined>;\r\n    groups$: Observable<GetCustomerGroups.Items[]>;\r\n    listIsEmpty$: Observable<boolean>;\r\n    members$: Observable<GetCustomerGroupWithCustomers.Items[]>;\r\n    membersTotal$: Observable<number>;\r\n    selectedCustomerIds: string[] = [];\r\n    fetchGroupMembers$ = new BehaviorSubject<CustomerGroupMemberFetchParams>({\r\n        skip: 0,\r\n        take: 0,\r\n        filterTerm: '',\r\n    });\r\n    private refreshActiveGroupMembers$ = new BehaviorSubject<void>(undefined);\r\n\r\n    constructor(\r\n        private dataService: DataService,\r\n        private notificationService: NotificationService,\r\n        private modalService: ModalService,\r\n        public route: ActivatedRoute,\r\n        private router: Router,\r\n    ) {}\r\n\r\n    ngOnInit(): void {\r\n        this.groups$ = this.dataService.customer\r\n            .getCustomerGroupList()\r\n            .mapStream((data) => data.customerGroups.items);\r\n        const activeGroupId$ = this.route.paramMap.pipe(\r\n            map((pm) => pm.get('contents')),\r\n            distinctUntilChanged(),\r\n            tap(() => (this.selectedCustomerIds = [])),\r\n        );\r\n        this.listIsEmpty$ = this.groups$.pipe(map((groups) => groups.length === 0));\r\n        this.activeGroup$ = combineLatest(this.groups$, activeGroupId$).pipe(\r\n            map(([groups, activeGroupId]) => {\r\n                if (activeGroupId) {\r\n                    return groups.find((g) => g.id === activeGroupId);\r\n                }\r\n            }),\r\n        );\r\n        const membersResult$ = combineLatest(\r\n            this.activeGroup$,\r\n            this.fetchGroupMembers$,\r\n            this.refreshActiveGroupMembers$,\r\n        ).pipe(\r\n            switchMap(([activeGroup, { skip, take, filterTerm }]) => {\r\n                if (activeGroup) {\r\n                    return this.dataService.customer\r\n                        .getCustomerGroupWithCustomers(activeGroup.id, {\r\n                            skip,\r\n                            take,\r\n                            filter: {\r\n                                emailAddress: {\r\n                                    contains: filterTerm,\r\n                                },\r\n                            },\r\n                        })\r\n                        .mapStream((res) => res.customerGroup?.customers);\r\n                } else {\r\n                    return of(undefined);\r\n                }\r\n            }),\r\n        );\r\n\r\n        this.members$ = membersResult$.pipe(map((res) => res?.items ?? []));\r\n        this.membersTotal$ = membersResult$.pipe(map((res) => res?.totalItems ?? 0));\r\n    }\r\n\r\n    create() {\r\n        this.modalService\r\n            .fromComponent(CustomerGroupDetailDialogComponent, { locals: { group: { name: '' } } })\r\n            .pipe(\r\n                switchMap((name) =>\r\n                    name ? this.dataService.customer.createCustomerGroup({ name, customerIds: [] }) : EMPTY,\r\n                ),\r\n                // refresh list\r\n                switchMap(() => this.dataService.customer.getCustomerGroupList().single$),\r\n            )\r\n            .subscribe(\r\n                () => {\r\n                    this.notificationService.success(_('common.notify-create-success'), {\r\n                        entity: 'CustomerGroup',\r\n                    });\r\n                },\r\n                (err) => {\r\n                    this.notificationService.error(_('common.notify-create-error'), {\r\n                        entity: 'CustomerGroup',\r\n                    });\r\n                },\r\n            );\r\n    }\r\n\r\n    delete(groupId: string) {\r\n        this.modalService\r\n            .dialog({\r\n                title: _('customer.confirm-delete-customer-group'),\r\n                buttons: [\r\n                    { type: 'secondary', label: _('common.cancel') },\r\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\r\n                ],\r\n            })\r\n            .pipe(\r\n                switchMap((response) =>\r\n                    response ? this.dataService.customer.deleteCustomerGroup(groupId) : EMPTY,\r\n                ),\r\n\r\n                switchMap((result) => {\r\n                    if (result.deleteCustomerGroup.result === DeletionResult.DELETED) {\r\n                        // refresh list\r\n                        return this.dataService.customer\r\n                            .getCustomerGroupList()\r\n                            .mapSingle(() => ({ errorMessage: false }));\r\n                    } else {\r\n                        return of({ errorMessage: result.deleteCustomerGroup.message });\r\n                    }\r\n                }),\r\n            )\r\n            .subscribe(\r\n                (result) => {\r\n                    if (typeof result.errorMessage === 'string') {\r\n                        this.notificationService.error(result.errorMessage);\r\n                    } else {\r\n                        this.notificationService.success(_('common.notify-delete-success'), {\r\n                            entity: 'CustomerGroup',\r\n                        });\r\n                    }\r\n                },\r\n                (err) => {\r\n                    this.notificationService.error(_('common.notify-delete-error'), {\r\n                        entity: 'CustomerGroup',\r\n                    });\r\n                },\r\n            );\r\n    }\r\n\r\n    update(group: GetCustomerGroups.Items) {\r\n        this.modalService\r\n            .fromComponent(CustomerGroupDetailDialogComponent, { locals: { group } })\r\n            .pipe(\r\n                switchMap((name) =>\r\n                    name ? this.dataService.customer.updateCustomerGroup({ id: group.id, name }) : EMPTY,\r\n                ),\r\n            )\r\n            .subscribe(\r\n                () => {\r\n                    this.notificationService.success(_('common.notify-update-success'), {\r\n                        entity: 'CustomerGroup',\r\n                    });\r\n                },\r\n                (err) => {\r\n                    this.notificationService.error(_('common.notify-update-error'), {\r\n                        entity: 'CustomerGroup',\r\n                    });\r\n                },\r\n            );\r\n    }\r\n\r\n    closeMembers() {\r\n        const params = { ...this.route.snapshot.params };\r\n        delete params.contents;\r\n        this.router.navigate(['./', params], { relativeTo: this.route, queryParamsHandling: 'preserve' });\r\n    }\r\n\r\n    addToGroup(group: GetCustomerGroupWithCustomers.CustomerGroup) {\r\n        this.modalService\r\n            .fromComponent(AddCustomerToGroupDialogComponent, {\r\n                locals: {\r\n                    group,\r\n                    route: this.route,\r\n                },\r\n                size: 'md',\r\n                verticalAlign: 'top',\r\n            })\r\n            .pipe(\r\n                switchMap((customerIds) =>\r\n                    customerIds\r\n                        ? this.dataService.customer\r\n                              .addCustomersToGroup(group.id, customerIds)\r\n                              .pipe(mapTo(customerIds))\r\n                        : EMPTY,\r\n                ),\r\n            )\r\n            .subscribe({\r\n                next: (result) => {\r\n                    this.notificationService.success(_(`customer.add-customers-to-group-success`), {\r\n                        customerCount: result.length,\r\n                        groupName: group.name,\r\n                    });\r\n                    this.refreshActiveGroupMembers$.next();\r\n                    this.selectedCustomerIds = [];\r\n                },\r\n            });\r\n    }\r\n\r\n    removeFromGroup(group: GetZones.Zones, customerIds: string[]) {\r\n        this.dataService.customer.removeCustomersFromGroup(group.id, customerIds).subscribe({\r\n            complete: () => {\r\n                this.notificationService.success(_(`customer.remove-customers-from-group-success`), {\r\n                    customerCount: customerIds.length,\r\n                    groupName: group.name,\r\n                });\r\n                this.refreshActiveGroupMembers$.next();\r\n                this.selectedCustomerIds = [];\r\n            },\r\n        });\r\n    }\r\n}\r\n","import {\r\n    ChangeDetectionStrategy,\r\n    Component,\r\n    EventEmitter,\r\n    Input,\r\n    OnDestroy,\r\n    OnInit,\r\n    Output,\r\n} from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Customer, DataService, GetCustomerGroupWithCustomers } from '@vendure/admin-ui/core';\r\nimport { ZoneMember } from '@vendure/admin-ui/settings';\r\nimport { BehaviorSubject, combineLatest, Observable, Subject } from 'rxjs';\r\nimport { debounceTime, distinctUntilChanged, map, startWith, takeUntil, tap } from 'rxjs/operators';\r\n\r\nexport interface CustomerGroupMemberFetchParams {\r\n    skip: number;\r\n    take: number;\r\n    filterTerm: string;\r\n}\r\n\r\n@Component({\r\n    selector: 'vdr-customer-group-member-list',\r\n    templateUrl: './customer-group-member-list.component.html',\r\n    styleUrls: ['./customer-group-member-list.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CustomerGroupMemberListComponent implements OnInit, OnDestroy {\r\n    @Input() members: Array<\r\n        Pick<Customer, 'id' | 'createdAt' | 'updatedAt' | 'title' | 'firstName' | 'lastName' | 'emailAddress'>\r\n    >;\r\n    @Input() totalItems: number;\r\n    @Input() route: ActivatedRoute;\r\n    @Input() selectedMemberIds: string[] = [];\r\n    @Output() selectionChange = new EventEmitter<string[]>();\r\n    @Output() fetchParamsChange = new EventEmitter<CustomerGroupMemberFetchParams>();\r\n\r\n    membersItemsPerPage$: Observable<number>;\r\n    membersCurrentPage$: Observable<number>;\r\n    filterTermControl = new FormControl('');\r\n    private refresh$ = new BehaviorSubject<boolean>(true);\r\n    private destroy$ = new Subject<void>();\r\n\r\n    constructor(private router: Router, private dataService: DataService) {}\r\n\r\n    ngOnInit() {\r\n        this.membersCurrentPage$ = this.route.paramMap.pipe(\r\n            map((qpm) => qpm.get('membersPage')),\r\n            map((page) => (!page ? 1 : +page)),\r\n            startWith(1),\r\n            distinctUntilChanged(),\r\n        );\r\n\r\n        this.membersItemsPerPage$ = this.route.paramMap.pipe(\r\n            map((qpm) => qpm.get('membersPerPage')),\r\n            map((perPage) => (!perPage ? 10 : +perPage)),\r\n            startWith(10),\r\n            distinctUntilChanged(),\r\n        );\r\n\r\n        const filterTerm$ = this.filterTermControl.valueChanges.pipe(\r\n            debounceTime(250),\r\n            tap(() => this.setContentsPageNumber(1)),\r\n            startWith(''),\r\n        );\r\n\r\n        combineLatest(this.membersCurrentPage$, this.membersItemsPerPage$, filterTerm$, this.refresh$)\r\n            .pipe(takeUntil(this.destroy$))\r\n            .subscribe(([currentPage, itemsPerPage, filterTerm]) => {\r\n                const take = itemsPerPage;\r\n                const skip = (currentPage - 1) * itemsPerPage;\r\n                this.fetchParamsChange.emit({\r\n                    filterTerm,\r\n                    skip,\r\n                    take,\r\n                });\r\n            });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.destroy$.next();\r\n        this.destroy$.complete();\r\n    }\r\n\r\n    setContentsPageNumber(page: number) {\r\n        this.setParam('membersPage', page);\r\n    }\r\n\r\n    setContentsItemsPerPage(perPage: number) {\r\n        this.setParam('membersPerPage', perPage);\r\n    }\r\n\r\n    refresh() {\r\n        this.refresh$.next(true);\r\n    }\r\n\r\n    private setParam(key: string, value: any) {\r\n        this.router.navigate(['./', { ...this.route.snapshot.params, [key]: value }], {\r\n            relativeTo: this.route,\r\n            queryParamsHandling: 'merge',\r\n        });\r\n    }\r\n\r\n    areAllSelected(): boolean {\r\n        if (this.members) {\r\n            return this.selectedMemberIds.length === this.members.length;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    toggleSelectAll() {\r\n        if (this.areAllSelected()) {\r\n            this.selectionChange.emit([]);\r\n        } else {\r\n            this.selectionChange.emit(this.members.map((v) => v.id));\r\n        }\r\n    }\r\n\r\n    toggleSelectMember(member: ZoneMember) {\r\n        if (this.selectedMemberIds.includes(member.id)) {\r\n            this.selectionChange.emit(this.selectedMemberIds.filter((id) => id !== member.id));\r\n        } else {\r\n            this.selectionChange.emit([...this.selectedMemberIds, member.id]);\r\n        }\r\n    }\r\n\r\n    isMemberSelected = (member: ZoneMember): boolean => {\r\n        return -1 < this.selectedMemberIds.indexOf(member.id);\r\n    };\r\n}\r\n","import { ChangeDetectionStrategy, Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport {\r\n    Customer,\r\n    GetCustomerHistory,\r\n    HistoryEntry,\r\n    HistoryEntryType,\r\n    TimelineDisplayType,\r\n} from '@vendure/admin-ui/core';\r\n\r\n@Component({\r\n    selector: 'vdr-customer-history',\r\n    templateUrl: './customer-history.component.html',\r\n    styleUrls: ['./customer-history.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CustomerHistoryComponent {\r\n    @Input() customer: Customer.Fragment;\r\n    @Input() history: GetCustomerHistory.Items[];\r\n    @Output() addNote = new EventEmitter<{ note: string }>();\r\n    @Output() updateNote = new EventEmitter<HistoryEntry>();\r\n    @Output() deleteNote = new EventEmitter<HistoryEntry>();\r\n    note = '';\r\n    readonly type = HistoryEntryType;\r\n\r\n    getDisplayType(entry: GetCustomerHistory.Items): TimelineDisplayType {\r\n        switch (entry.type) {\r\n            case HistoryEntryType.CUSTOMER_VERIFIED:\r\n            case HistoryEntryType.CUSTOMER_EMAIL_UPDATE_VERIFIED:\r\n            case HistoryEntryType.CUSTOMER_PASSWORD_RESET_VERIFIED:\r\n                return 'success';\r\n            case HistoryEntryType.CUSTOMER_REGISTERED:\r\n                return 'muted';\r\n            case HistoryEntryType.CUSTOMER_REMOVED_FROM_GROUP:\r\n                return 'error';\r\n            default:\r\n                return 'default';\r\n        }\r\n    }\r\n\r\n    getTimelineIcon(entry: GetCustomerHistory.Items): string | [string, string] | undefined {\r\n        switch (entry.type) {\r\n            case HistoryEntryType.CUSTOMER_REGISTERED:\r\n                return 'user';\r\n            case HistoryEntryType.CUSTOMER_VERIFIED:\r\n                return ['assign-user', 'is-solid'];\r\n            case HistoryEntryType.CUSTOMER_NOTE:\r\n                return 'note';\r\n            case HistoryEntryType.CUSTOMER_ADDED_TO_GROUP:\r\n            case HistoryEntryType.CUSTOMER_REMOVED_FROM_GROUP:\r\n                return 'users';\r\n        }\r\n    }\r\n\r\n    isFeatured(entry: GetCustomerHistory.Items): boolean {\r\n        switch (entry.type) {\r\n            case HistoryEntryType.CUSTOMER_REGISTERED:\r\n            case HistoryEntryType.CUSTOMER_VERIFIED:\r\n                return true;\r\n            default:\r\n                return false;\r\n        }\r\n    }\r\n\r\n    getName(entry: GetCustomerHistory.Items): string {\r\n        const { administrator } = entry;\r\n        if (administrator) {\r\n            return `${administrator.firstName} ${administrator.lastName}`;\r\n        } else {\r\n            return `${this.customer.firstName} ${this.customer.lastName}`;\r\n        }\r\n    }\r\n\r\n    addNoteToCustomer() {\r\n        this.addNote.emit({ note: this.note });\r\n        this.note = '';\r\n    }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { FormControl } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\r\nimport {\r\n    BaseListComponent,\r\n    DataService,\r\n    GetCustomerList,\r\n    ModalService,\r\n    NotificationService,\r\n} from '@vendure/admin-ui/core';\r\nimport { SortOrder } from '@vendure/common/lib/generated-shop-types';\r\nimport { EMPTY, merge } from 'rxjs';\r\nimport { debounceTime, filter, switchMap, takeUntil } from 'rxjs/operators';\r\n\r\n@Component({\r\n    selector: 'vdr-customer-list',\r\n    templateUrl: './customer-list.component.html',\r\n    styleUrls: ['./customer-list.component.scss'],\r\n})\r\nexport class CustomerListComponent\r\n    extends BaseListComponent<GetCustomerList.Query, GetCustomerList.Items>\r\n    implements OnInit {\r\n    emailSearchTerm = new FormControl('');\r\n    lastNameSearchTerm = new FormControl('');\r\n    constructor(\r\n        private dataService: DataService,\r\n        router: Router,\r\n        route: ActivatedRoute,\r\n        private modalService: ModalService,\r\n        private notificationService: NotificationService,\r\n    ) {\r\n        super(router, route);\r\n        super.setQueryFn(\r\n            (...args: any[]) => this.dataService.customer.getCustomerList(...args).refetchOnChannelChange(),\r\n            data => data.customers,\r\n            (skip, take) => ({\r\n                options: {\r\n                    skip,\r\n                    take,\r\n                    filter: {\r\n                        emailAddress: {\r\n                            contains: this.emailSearchTerm.value,\r\n                        },\r\n                        lastName: {\r\n                            contains: this.lastNameSearchTerm.value,\r\n                        },\r\n                    },\r\n                    sort: {\r\n                        createdAt: SortOrder.DESC,\r\n                    },\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    ngOnInit() {\r\n        super.ngOnInit();\r\n        merge(this.emailSearchTerm.valueChanges, this.lastNameSearchTerm.valueChanges)\r\n            .pipe(\r\n                filter(value => 2 < value.length || value.length === 0),\r\n                debounceTime(250),\r\n                takeUntil(this.destroy$),\r\n            )\r\n            .subscribe(() => this.refresh());\r\n    }\r\n\r\n    deleteCustomer(customer: GetCustomerList.Items) {\r\n        return this.modalService\r\n            .dialog({\r\n                title: _('catalog.confirm-delete-customer'),\r\n                body: `${customer.firstName} ${customer.lastName}`,\r\n                buttons: [\r\n                    { type: 'secondary', label: _('common.cancel') },\r\n                    { type: 'danger', label: _('common.delete'), returnValue: true },\r\n                ],\r\n            })\r\n            .pipe(switchMap(res => (res ? this.dataService.customer.deleteCustomer(customer.id) : EMPTY)))\r\n            .subscribe(\r\n                () => {\r\n                    this.notificationService.success(_('common.notify-delete-success'), {\r\n                        entity: 'Customer',\r\n                    });\r\n                    this.refresh();\r\n                },\r\n                err => {\r\n                    this.notificationService.error(_('common.notify-delete-error'), {\r\n                        entity: 'Customer',\r\n                    });\r\n                },\r\n            );\r\n    }\r\n}\r\n","import { ChangeDetectionStrategy, Component, Input, OnInit } from '@angular/core';\r\n\r\nimport { Customer } from '@vendure/admin-ui/core';\r\n\r\n@Component({\r\n    selector: 'vdr-customer-status-label',\r\n    templateUrl: './customer-status-label.component.html',\r\n    styleUrls: ['./customer-status-label.component.scss'],\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class CustomerStatusLabelComponent {\r\n    @Input() customer: Customer.Fragment;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { BaseEntityResolver } from '@vendure/admin-ui/core';\r\nimport { Customer } from '@vendure/admin-ui/core';\r\nimport { DataService } from '@vendure/admin-ui/core';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class CustomerResolver extends BaseEntityResolver<Customer.Fragment> {\r\n    constructor(router: Router, dataService: DataService) {\r\n        super(\r\n            router,\r\n            {\r\n                __typename: 'Customer',\r\n                id: '',\r\n                createdAt: '',\r\n                updatedAt: '',\r\n                title: '',\r\n                firstName: '',\r\n                lastName: '',\r\n                emailAddress: '',\r\n                phoneNumber: null,\r\n                addresses: null,\r\n                user: null,\r\n            },\r\n            id => dataService.customer.getCustomer(id).mapStream(data => data.customer),\r\n        );\r\n    }\r\n}\r\n","import { Route } from '@angular/router';\r\nimport { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';\r\nimport {\r\n    CanDeactivateDetailGuard,\r\n    createResolveData,\r\n    Customer,\r\n    detailBreadcrumb,\r\n} from '@vendure/admin-ui/core';\r\n\r\nimport { CustomerDetailComponent } from './components/customer-detail/customer-detail.component';\r\nimport { CustomerGroupListComponent } from './components/customer-group-list/customer-group-list.component';\r\nimport { CustomerListComponent } from './components/customer-list/customer-list.component';\r\nimport { CustomerResolver } from './providers/routing/customer-resolver';\r\n\r\nexport const customerRoutes: Route[] = [\r\n    {\r\n        path: 'customers',\r\n        component: CustomerListComponent,\r\n        pathMatch: '',\r\n        data: {\r\n            breadcrumb: _('breadcrumb.customers'),\r\n        },\r\n    },\r\n    {\r\n        path: 'customers/:id',\r\n        component: CustomerDetailComponent,\r\n        resolve: createResolveData(CustomerResolver),\r\n        canDeactivate: [CanDeactivateDetailGuard],\r\n        data: {\r\n            breadcrumb: customerBreadcrumb,\r\n        },\r\n    },\r\n    {\r\n        path: 'groups',\r\n        component: CustomerGroupListComponent,\r\n        data: {\r\n            breadcrumb: _('breadcrumb.customer-groups'),\r\n        },\r\n    },\r\n];\r\n\r\nexport function customerBreadcrumb(data: any, params: any) {\r\n    return detailBreadcrumb<Customer.Fragment>({\r\n        entity: data.entity,\r\n        id: params.id,\r\n        breadcrumbKey: 'breadcrumb.customers',\r\n        getName: (customer) => `${customer.firstName} ${customer.lastName}`,\r\n        route: 'customers',\r\n    });\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule } from '@angular/router';\r\nimport { SharedModule } from '@vendure/admin-ui/core';\r\n\r\nimport { AddCustomerToGroupDialogComponent } from './components/add-customer-to-group-dialog/add-customer-to-group-dialog.component';\r\nimport { AddressCardComponent } from './components/address-card/address-card.component';\r\nimport { AddressDetailDialogComponent } from './components/address-detail-dialog/address-detail-dialog.component';\r\nimport { CustomerDetailComponent } from './components/customer-detail/customer-detail.component';\r\nimport { CustomerGroupDetailDialogComponent } from './components/customer-group-detail-dialog/customer-group-detail-dialog.component';\r\nimport { CustomerGroupListComponent } from './components/customer-group-list/customer-group-list.component';\r\nimport { CustomerGroupMemberListComponent } from './components/customer-group-member-list/customer-group-member-list.component';\r\nimport { CustomerHistoryComponent } from './components/customer-history/customer-history.component';\r\nimport { CustomerListComponent } from './components/customer-list/customer-list.component';\r\nimport { CustomerStatusLabelComponent } from './components/customer-status-label/customer-status-label.component';\r\nimport { SelectCustomerGroupDialogComponent } from './components/select-customer-group-dialog/select-customer-group-dialog.component';\r\nimport { customerRoutes } from './customer.routes';\r\n\r\n@NgModule({\r\n    imports: [SharedModule, RouterModule.forChild(customerRoutes)],\r\n    declarations: [\r\n        CustomerListComponent,\r\n        CustomerDetailComponent,\r\n        CustomerStatusLabelComponent,\r\n        AddressCardComponent,\r\n        CustomerGroupListComponent,\r\n        CustomerGroupDetailDialogComponent,\r\n        AddCustomerToGroupDialogComponent,\r\n        CustomerGroupMemberListComponent,\r\n        SelectCustomerGroupDialogComponent,\r\n        CustomerHistoryComponent,\r\n        AddressDetailDialogComponent,\r\n    ],\r\n    exports: [AddressCardComponent],\r\n})\r\nexport class CustomerModule {}\r\n"]}